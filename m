Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 0E7CF7A64BF
	for <lists+qemu-devel@lfdr.de>; Tue, 19 Sep 2023 15:21:52 +0200 (CEST)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1qiaeM-0002Bo-Lh; Tue, 19 Sep 2023 09:20:22 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <lersek@redhat.com>) id 1qiae5-0002Aq-U4
 for qemu-devel@nongnu.org; Tue, 19 Sep 2023 09:20:07 -0400
Received: from us-smtp-delivery-124.mimecast.com ([170.10.129.124])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <lersek@redhat.com>) id 1qiae2-00037i-Hl
 for qemu-devel@nongnu.org; Tue, 19 Sep 2023 09:20:04 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1695129601;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:
 content-transfer-encoding:content-transfer-encoding;
 bh=qETdIitbhf/BthXK2sakRD0VMASLyjOh0xXZhbeiKns=;
 b=ZyEy0FboSpQYweQZz3ME6S7BXk1ypOj4Wh5z0kcz/NQuBXE0prG//29r1ws+88H8nkJTw1
 Y4hLg4g1BMTURARKcl2z2acoe9nVMZXsWBzH2RE8hb3MFv13vBB8DOrPNAVTkOqZUmT/x5
 jvE5UgJTpEJB0vNKX7atiYRu3bcgvi0=
Received: from mimecast-mx02.redhat.com (mimecast-mx02.redhat.com
 [66.187.233.88]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 us-mta-103-8hiz4OS1MZqck4r63jICIQ-1; Tue, 19 Sep 2023 09:19:58 -0400
X-MC-Unique: 8hiz4OS1MZqck4r63jICIQ-1
Received: from smtp.corp.redhat.com (int-mx06.intmail.prod.int.rdu2.redhat.com
 [10.11.54.6])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by mimecast-mx02.redhat.com (Postfix) with ESMTPS id 41AC196742C;
 Tue, 19 Sep 2023 13:19:58 +0000 (UTC)
Received: from lacos-laptop-9.usersys.redhat.com (unknown [10.39.192.5])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 5B1BA2156A27;
 Tue, 19 Sep 2023 13:19:57 +0000 (UTC)
From: Laszlo Ersek <lersek@redhat.com>
To: qemu-devel@nongnu.org,
	lersek@redhat.com
Cc: Gerd Hoffmann <kraxel@redhat.com>,
	qemu-stable@nongnu.org
Subject: [PATCH] hw/display/ramfb: plug slight guest-triggerable leak on mode
 setting
Date: Tue, 19 Sep 2023 15:19:55 +0200
Message-Id: <20230919131955.27223-1-lersek@redhat.com>
MIME-Version: 1.0
Content-Transfer-Encoding: base64
X-Scanned-By: MIMEDefang 3.1 on 10.11.54.6
Received-SPF: pass client-ip=170.10.129.124; envelope-from=lersek@redhat.com;
 helo=us-smtp-delivery-124.mimecast.com
X-Spam_score_int: -3
X-Spam_score: -0.4
X-Spam_bar: /
X-Spam_report: (-0.4 / 5.0 requ) BAYES_00=-1.9, DKIMWL_WL_HIGH=-0.001,
 DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, DKIM_VALID_EF=-0.1,
 MIME_BASE64_TEXT=1.741, RCVD_IN_DNSWL_NONE=-0.0001, RCVD_IN_MSPIKE_H4=0.001,
 RCVD_IN_MSPIKE_WL=0.001, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=unavailable autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

VGhlIGZ3X2NmZyBETUEgd3JpdGUgY2FsbGJhY2sgaW4gcmFtZmIgcHJlcGFyZXMgYSBuZXcgZGlz
cGxheSBzdXJmYWNlIGluClFFTVU7IHRoaXMgbmV3IHN1cmZhY2UgaXMgcHV0IHRvIHVzZSAoInN3
YXBwZWQgaW4iKSB1cG9uIHRoZSBuZXh0IGRpc3BsYXkKdXBkYXRlLiBBdCB0aGF0IHRpbWUsIHRo
ZSBvbGQgc3VyZmFjZSAoaWYgYW55KSBpcyByZWxlYXNlZC4KCklmIHRoZSBndWVzdCB0cmlnZ2Vy
cyB0aGUgZndfY2ZnIERNQSB3cml0ZSBjYWxsYmFjayBhdCBsZWFzdCB0d2ljZSBiZXR3ZWVuCnR3
byBhZGphY2VudCBkaXNwbGF5IHVwZGF0ZXMsIHRoZW4gdGhlIHNlY29uZCBjYWxsYmFjayAoYW5k
IGZ1cnRoZXIgc3VjaApjYWxsYmFja3MpIHdpbGwgbGVhayB0aGUgcHJldmlvdXNseSBwcmVwYXJl
ZCAoYnV0IG5vdCB5ZXQgc3dhcHBlZCBpbikKZGlzcGxheSBzdXJmYWNlLgoKVGhlIGlzc3VlIGNh
biBiZSBzaG93biBieToKCigxKSBzdGFydGluZyBRRU1VIHdpdGggIi10cmFjZSBkaXNwbGF5c3Vy
ZmFjZV9mcmVlIiwgYW5kCgooMikgcnVubmluZyB0aGUgZm9sbG93aW5nIHByb2dyYW0gaW4gdGhl
IGd1ZXN0IFVFRkkgc2hlbGw6Cgo+ICNpbmNsdWRlIDxMaWJyYXJ5L1NoZWxsQ0VudHJ5TGliLmg+
ICAgICAgICAgICAvLyBTaGVsbEFwcE1haW4oKQo+ICNpbmNsdWRlIDxMaWJyYXJ5L1VlZmlCb290
U2VydmljZXNUYWJsZUxpYi5oPiAvLyBnQlMKPiAjaW5jbHVkZSA8UHJvdG9jb2wvR3JhcGhpY3NP
dXRwdXQuaD4gICAgICAgICAgLy8gRUZJX0dSQVBISUNTX09VVFBVVF9QUk9UT0NPTAo+Cj4gSU5U
Tgo+IEVGSUFQSQo+IFNoZWxsQXBwTWFpbiAoCj4gICBJTiBVSU5UTiAgIEFyZ2MsCj4gICBJTiBD
SEFSMTYgICoqQXJndgo+ICAgKQo+IHsKPiAgIEVGSV9TVEFUVVMgICAgICAgICAgICAgICAgICAg
IFN0YXR1czsKPiAgIFZPSUQgICAgICAgICAgICAgICAgICAgICAgICAgICpJbnRlcmZhY2U7Cj4g
ICBFRklfR1JBUEhJQ1NfT1VUUFVUX1BST1RPQ09MICAqR29wOwo+ICAgVUlOVDMyICAgICAgICAg
ICAgICAgICAgICAgICAgTW9kZTsKPgo+ICAgU3RhdHVzID0gZ0JTLT5Mb2NhdGVQcm90b2NvbCAo
Cj4gICAgICAgICAgICAgICAgICAgJmdFZmlHcmFwaGljc091dHB1dFByb3RvY29sR3VpZCwKPiAg
ICAgICAgICAgICAgICAgICBOVUxMLAo+ICAgICAgICAgICAgICAgICAgICZJbnRlcmZhY2UKPiAg
ICAgICAgICAgICAgICAgICApOwo+ICAgaWYgKEVGSV9FUlJPUiAoU3RhdHVzKSkgewo+ICAgICBy
ZXR1cm4gMTsKPiAgIH0KPgo+ICAgR29wID0gSW50ZXJmYWNlOwo+Cj4gICBNb2RlID0gMTsKPiAg
IGZvciAoIDsgOykgewo+ICAgICBTdGF0dXMgPSBHb3AtPlNldE1vZGUgKEdvcCwgTW9kZSk7Cj4g
ICAgIGlmIChFRklfRVJST1IgKFN0YXR1cykpIHsKPiAgICAgICBicmVhazsKPiAgICAgfQo+Cj4g
ICAgIE1vZGUgPSAxIC0gTW9kZTsKPiAgIH0KPgo+ICAgcmV0dXJuIDE7Cj4gfQoKVGhlIHN5bXB0
b20gaXMgdGhlbiB0aGF0OgoKLSBvbmx5IG9uZSB0cmFjZSBtZXNzYWdlIGFwcGVhcnMgcGVyaW9k
aWNhbGx5LAoKLSB0aGUgdGltZSBiZXR3ZWVuIGFkamFjZW50IG1lc3NhZ2VzIGtlZXBzIGluY3Jl
YXNpbmcgLS0gaW1wbHlpbmcgdGhhdAogIHNvbWUgbGlzdCBzdHJ1Y3R1cmUgKGNvbnRhaW5pbmcg
dGhlIGxlYWtlZCByZXNvdXJjZXMpIGtlZXBzIGdyb3dpbmcsCgotIHRoZSAic3VyZmFjZSIgcG9p
bnRlciBpcyBldmVyIGRpZmZlcmVudC4KCj4gMTg1NjZAMTY5NTEyNzQ3MS40NDk1ODY6ZGlzcGxh
eXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjMDlhN2MwCj4gMTg1NjZAMTY5NTEyNzQ3MS41
Mjk1NTk6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjOWRhYzEwCj4gMTg1NjZA
MTY5NTEyNzQ3MS42NTk4MTI6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjNDQx
ZGQwCj4gMTg1NjZAMTY5NTEyNzQ3MS44Mzk2Njk6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNl
PTB4N2YyZmNjMDM2M2QwCj4gMTg1NjZAMTY5NTEyNzQ3Mi4wNjk2NzQ6ZGlzcGxheXN1cmZhY2Vf
ZnJlZSBzdXJmYWNlPTB4N2YyZmNjNDEzYTgwCj4gMTg1NjZAMTY5NTEyNzQ3Mi4zNDk1ODA6ZGlz
cGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjMDljZDAwCj4gMTg1NjZAMTY5NTEyNzQ3
Mi42Nzk3ODM6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjMTM5NWYwCj4gMTg1
NjZAMTY5NTEyNzQ3My4wNTk4NDg6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNj
MWNhZTUwCj4gMTg1NjZAMTY5NTEyNzQ3My40ODk3MjQ6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJm
YWNlPTB4N2YyZmNjNDJmYzUwCj4gMTg1NjZAMTY5NTEyNzQ3My45Njk3OTE6ZGlzcGxheXN1cmZh
Y2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjNDVkY2MwCj4gMTg1NjZAMTY5NTEyNzQ3NC40OTk3MDg6
ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjNzBiOWQwCj4gMTg1NjZAMTY5NTEy
NzQ3NS4wNzk3Njk6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjODJhY2MwCj4g
MTg1NjZAMTY5NTEyNzQ3NS43MDk5NDE6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2Yy
ZmNjMzY5YzAwCj4gMTg1NjZAMTY5NTEyNzQ3Ni4zODk2MTk6ZGlzcGxheXN1cmZhY2VfZnJlZSBz
dXJmYWNlPTB4N2YyZmNjMzJiOTEwCj4gMTg1NjZAMTY5NTEyNzQ3Ny4xMTk3NzI6ZGlzcGxheXN1
cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjMGQ1YTIwCj4gMTg1NjZAMTY5NTEyNzQ3Ny44OTk1
MTc6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjMDg2YzQwCj4gMTg1NjZAMTY5
NTEyNzQ3OC43Mjk5NjI6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjYzcyMDIw
Cj4gMTg1NjZAMTY5NTEyNzQ3OS42MDk4Mzk6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4
N2YyZmNjMTg1MTYwCj4gMTg1NjZAMTY5NTEyNzQ4MC41Mzk2ODg6ZGlzcGxheXN1cmZhY2VfZnJl
ZSBzdXJmYWNlPTB4N2YyZmNjMjNhN2UwCj4gMTg1NjZAMTY5NTEyNzQ4MS41MTk3NTk6ZGlzcGxh
eXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjM2VjODcwCj4gMTg1NjZAMTY5NTEyNzQ4Mi41
NDk5MzA6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjNjM0OTYwCj4gMTg1NjZA
MTY5NTEyNzQ4My42Mjk2NjE6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNlPTB4N2YyZmNjMjZi
MTQwCj4gMTg1NjZAMTY5NTEyNzQ4NC43NTk5ODc6ZGlzcGxheXN1cmZhY2VfZnJlZSBzdXJmYWNl
PTB4N2YyZmNjMzIxNzAwCj4gMTg1NjZAMTY5NTEyNzQ4NS45NDAyODk6ZGlzcGxheXN1cmZhY2Vf
ZnJlZSBzdXJmYWNlPTB4N2YyZmNjYWFkMTAwCgpXZSBmaWd1cmVkIHRoaXMgd2Fzbid0IGEgQ1ZF
LXdvcnRoeSBwcm9ibGVtLCBhcyBvbmx5IHNtYWxsIGFtb3VudHMgb2YKbWVtb3J5IHdlcmUgbGVh
a2VkICh0aGUgZnJhbWVidWZmZXIgaXRzZWxmIGlzIG1hcHBlZCBmcm9tIGd1ZXN0IFJBTSwgUUVN
VQpvbmx5IGFsbG9jYXRlcyBhZG1pbmlzdHJhdGl2ZSBzdHJ1Y3R1cmVzKSwgcGx1cyBsaWJ2aXJ0
IHJlc3RyaWN0cyBRRU1VCm1lbW9yeSBmb290cHJpbnQgYW55d2F5LCB0aHVzIHRoZSBndWVzdCBj
YW4gb25seSBEb1MgaXRzZWxmLgoKUGx1ZyB0aGUgbGVhaywgYnkgcmVsZWFzaW5nIHRoZSBsYXN0
IHByZXBhcmVkIChub3QgeWV0IHN3YXBwZWQgaW4pIGRpc3BsYXkKc3VyZmFjZSwgaWYgYW55LCBp
biB0aGUgZndfY2ZnIERNQSB3cml0ZSBjYWxsYmFjay4KClJlZ2FyZGluZyB0aGUgInJlcHJvZHVj
ZXIiLCB3aXRoIHRoZSBmaXggaW4gcGxhY2UsIHRoZSBsb2cgaXMgZmxvb2RlZCB3aXRoCnRyYWNl
IG1lc3NhZ2VzIChvbmUgcGVyIGZ3X2NmZyB3cml0ZSksICphbmQqIHRoZSB0cmFjZSBtZXNzYWdl
IGFsdGVybmF0ZXMKYmV0d2VlbiBqdXN0IHR3byAic3VyZmFjZSIgcG9pbnRlciB2YWx1ZXMgKGku
ZS4sIG5vdGhpbmcgaXMgbGVha2VkLCB0aGUKYWxsb2NhdG9yIGZsaXAtZmxvcHMgYmV0d2VlbiB0
d28gb2JqZWN0cyBpbiBlZmZlY3QpLgoKVGhpcyBpc3N1ZSBhcHBlYXJzIHRvIGRhdGUgYmFjayB0
byB0aGUgaW50cm9kdWNpb24gb2YgcmFtZmIgKDk5NWIzMDE3OWJkYywKImh3L2Rpc3BsYXk6IGFk
ZCByYW1mYiwgYSBzaW1wbGUgYm9vdCBmcmFtZWJ1ZmZlciBsaXZpbmcgaW4gZ3Vlc3QgcmFtIiwK
MjAxOC0wNi0xOCkuCgpDYzogR2VyZCBIb2ZmbWFubiA8a3JheGVsQHJlZGhhdC5jb20+IChtYWlu
dGFpbmVyOnJhbWZiKQpDYzogcWVtdS1zdGFibGVAbm9uZ251Lm9yZwpGaXhlczogOTk1YjMwMTc5
YmRjClNpZ25lZC1vZmYtYnk6IExhc3psbyBFcnNlayA8bGVyc2VrQHJlZGhhdC5jb20+Ci0tLQog
aHcvZGlzcGxheS9yYW1mYi5jIHwgMSArCiAxIGZpbGUgY2hhbmdlZCwgMSBpbnNlcnRpb24oKykK
CmRpZmYgLS1naXQgYS9ody9kaXNwbGF5L3JhbWZiLmMgYi9ody9kaXNwbGF5L3JhbWZiLmMKaW5k
ZXggNzliOTc1NGE1ODIwLi5jMmIwMDJkNTM0ODAgMTAwNjQ0Ci0tLSBhL2h3L2Rpc3BsYXkvcmFt
ZmIuYworKysgYi9ody9kaXNwbGF5L3JhbWZiLmMKQEAgLTk3LDYgKzk3LDcgQEAgc3RhdGljIHZv
aWQgcmFtZmJfZndfY2ZnX3dyaXRlKHZvaWQgKmRldiwgb2ZmX3Qgb2Zmc2V0LCBzaXplX3QgbGVu
KQogCiAgICAgcy0+d2lkdGggPSB3aWR0aDsKICAgICBzLT5oZWlnaHQgPSBoZWlnaHQ7CisgICAg
cWVtdV9mcmVlX2Rpc3BsYXlzdXJmYWNlKHMtPmRzKTsKICAgICBzLT5kcyA9IHN1cmZhY2U7CiB9
CiAK


