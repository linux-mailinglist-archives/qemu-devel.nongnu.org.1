Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 26BD78C8509
	for <lists+qemu-devel@lfdr.de>; Fri, 17 May 2024 12:45:15 +0200 (CEST)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1s7v4j-0001rp-U4; Fri, 17 May 2024 06:44:33 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <zhenzhong.duan@intel.com>)
 id 1s7v4f-0001qN-LT
 for qemu-devel@nongnu.org; Fri, 17 May 2024 06:44:29 -0400
Received: from mgamail.intel.com ([192.198.163.9])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <zhenzhong.duan@intel.com>)
 id 1s7v4b-0008AE-Ta
 for qemu-devel@nongnu.org; Fri, 17 May 2024 06:44:29 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=intel.com; i=@intel.com; q=dns/txt; s=Intel;
 t=1715942666; x=1747478666;
 h=from:to:cc:subject:date:message-id:references:
 in-reply-to:content-transfer-encoding:mime-version;
 bh=FPCSTx8LkptunwyKS9p9hY9wj9CgLG20ERoQAYUhVtw=;
 b=kwVPw8SAUSm+s4Kizt3Y5+/d3usxbz9GBJLxuvAh20FIxjhNGorUq+4m
 o6MWgTL9aF+GYCriKnQ+XojWY1w5VwzRHFBTJyswP2EQWjPFQkVgpForO
 3xJzTvo3cMS+SCABv94HNafRf+6fgthOlXNJoKDgQedPzMaPnnLWfbbah
 GLctFs8a6Sw+dJEneI/49ch2d6Upp1pA7vtihoD8J9jk+PoxUX7aWQSzC
 8BQV9eYOe3oRmhMSHH6C0SuLy5HrA8tsrbqsIN2sBNgWvJ68P2T6ssmy+
 LBdhrYWLV2/hJnqR+d3sFQtt2Vb4uyv4sc5sRvER9juuLNgOuDKOOTlOY w==;
X-CSE-ConnectionGUID: MUh4PCJCQoyCQaBIHE1Gxw==
X-CSE-MsgGUID: l6IF7jsrQ9ernF3cN6cY5w==
X-IronPort-AV: E=McAfee;i="6600,9927,11074"; a="22787454"
X-IronPort-AV: E=Sophos;i="6.08,167,1712646000"; d="scan'208";a="22787454"
Received: from fmviesa004.fm.intel.com ([10.60.135.144])
 by fmvoesa103.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 17 May 2024 03:44:18 -0700
X-CSE-ConnectionGUID: ugNAHfjFReGfsp1cJ5guYQ==
X-CSE-MsgGUID: uvlC0PE4Q5On4Ba9c/eTwg==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="6.08,167,1712646000"; d="scan'208";a="36327992"
Received: from orsmsx601.amr.corp.intel.com ([10.22.229.14])
 by fmviesa004.fm.intel.com with ESMTP/TLS/AES256-GCM-SHA384;
 17 May 2024 03:44:17 -0700
Received: from orsmsx610.amr.corp.intel.com (10.22.229.23) by
 ORSMSX601.amr.corp.intel.com (10.22.229.14) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.2507.39; Fri, 17 May 2024 03:44:17 -0700
Received: from ORSEDG601.ED.cps.intel.com (10.7.248.6) by
 orsmsx610.amr.corp.intel.com (10.22.229.23) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.2507.39 via Frontend Transport; Fri, 17 May 2024 03:44:17 -0700
Received: from NAM02-BN1-obe.outbound.protection.outlook.com (104.47.51.41) by
 edgegateway.intel.com (134.134.137.102) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.1.2507.35; Fri, 17 May 2024 03:44:16 -0700
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=bA5UGJhSM1fdaAe9VLd1WstiI2fzaBVL1zo3Xl34R/zz0OAZ8prOgezH2nZL/YCHBuLrQaaprCOflv5TlVhXe+YnxfCn5xmEG6VN8EoP7SwlFn5OITi2jVx0/+ft3mOU+o5tP8TK0wEqpe/jaGG8IIMfaJeyX7CFIkOLSaVQgtqvV3uGclvabkEy1wfXmez/8lle4QgLHko0wHD7mx8/ASL1es8pCARe3OaEgA9WQrmOpMMCEB4rUjCM/luiQoYaGAteGq+QkBOyWTKch6L72jB7a31pmrn46ObE2bbSj5/x6TfCN/4H240HL4Jub0TzGbE3P+a6ZQNNTMmjRsGCcA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=FPCSTx8LkptunwyKS9p9hY9wj9CgLG20ERoQAYUhVtw=;
 b=clUC/3zDi7/y+PF7i+8HACSabB5+aSnSYoxMvwDYqhgH1jl0RLbYbYnjSizh2lwji/Zm2wnKZ1YfKiXqoCEX/HN7XLQUMGOjBA79G3qnvG1BPNqbihXb/QOBZZqjxyP/hgMfre9NaUOvHvkaM3M5pED6xgCbgyr0c6K1TBNMB0oRdOgy2sDdYLUytJl7RnMl4tls9ijfqGqa8Cc5oA+c9SyD4ObRtTi4lu8r2UM2rY6ZCb6vFTfK3NKPWMmNmb72GZMWQ4PQiQ2ez5ccXztLDlYBk0GjGwc9gPEutmQmijlhZgsm4wUQ5WUSjzLJ0sP6/xdi1EZ7z9ADd6gS75J5HQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=intel.com; dmarc=pass action=none header.from=intel.com;
 dkim=pass header.d=intel.com; arc=none
Received: from SJ0PR11MB6744.namprd11.prod.outlook.com (2603:10b6:a03:47d::10)
 by MW4PR11MB6912.namprd11.prod.outlook.com (2603:10b6:303:22a::9)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.7587.26; Fri, 17 May
 2024 10:44:14 +0000
Received: from SJ0PR11MB6744.namprd11.prod.outlook.com
 ([fe80::21df:af3:be1d:722e]) by SJ0PR11MB6744.namprd11.prod.outlook.com
 ([fe80::21df:af3:be1d:722e%4]) with mapi id 15.20.7587.026; Fri, 17 May 2024
 10:44:14 +0000
From: "Duan, Zhenzhong" <zhenzhong.duan@intel.com>
To: CLEMENT MATHIEU--DRIF <clement.mathieu--drif@eviden.com>,
 "qemu-devel@nongnu.org" <qemu-devel@nongnu.org>
CC: "jasowang@redhat.com" <jasowang@redhat.com>, "Tian, Kevin"
 <kevin.tian@intel.com>, "Liu, Yi L" <yi.l.liu@intel.com>,
 "joao.m.martins@oracle.com" <joao.m.martins@oracle.com>, "peterx@redhat.com"
 <peterx@redhat.com>
Subject: RE: [PATCH ats_vtd v2 21/25] atc: generic ATC that can be used by
 PCIe devices that support SVM
Thread-Topic: [PATCH ats_vtd v2 21/25] atc: generic ATC that can be used by
 PCIe devices that support SVM
Thread-Index: AQHappeAjUdU2werkUaJiYxy8FgLhLGbQNEw
Date: Fri, 17 May 2024 10:44:13 +0000
Message-ID: <SJ0PR11MB6744B3A6FA7A0052709DA07392EE2@SJ0PR11MB6744.namprd11.prod.outlook.com>
References: <20240515071057.33990-1-clement.mathieu--drif@eviden.com>
 <20240515071057.33990-22-clement.mathieu--drif@eviden.com>
In-Reply-To: <20240515071057.33990-22-clement.mathieu--drif@eviden.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
authentication-results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=intel.com;
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: SJ0PR11MB6744:EE_|MW4PR11MB6912:EE_
x-ms-office365-filtering-correlation-id: 6f023026-0aba-43a2-7180-08dc765e4b31
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0; ARA:13230031|376005|366007|1800799015|38070700009;
x-microsoft-antispam-message-info: =?utf-8?B?cG0zNFpLR0FMT2RyZnpwekRCN1VBYVhYQmF5T0YzYjFSbVA5OUN0Mkkrdjcr?=
 =?utf-8?B?ZGNTMGg4djVWOE9XSGZCbks3dk5nU2RockdtdVRqN0ZYdEovVnJyZHhHK2pp?=
 =?utf-8?B?aFprOVg4S0NUd0IzRDByVnQ4RzZJcjI4ZW9SWlpZVDVQVU1LRFdQK2xjMEVZ?=
 =?utf-8?B?QWV2dXc4dmZ0SGNwMW1YRVlOR1NiZE5FWGtYQTNjUG01eStMZUcwV2lMQ2Q0?=
 =?utf-8?B?a2t0ZVcxTUVjbjE0dmhiVVRUcjRRazM5cWVMZjZSanV6VjlwVXg4Lzl3em9Z?=
 =?utf-8?B?dGowdmJuMDVmK3VaTEtFcFBPblh1ZmRVMjBQWWo2L2V3bW16WjR0OEU3M3Ux?=
 =?utf-8?B?bzl5Ri85ZEV5L0VaZDN3SG90d1N1UXMwZFN2eHRraEp5b2RKSHFUZnB5Tmsw?=
 =?utf-8?B?ZnFrNG9kajE4SWYyOUZWd2xBSzlXcXNENWUzM2t2alA0QzRoRythSWJKdy80?=
 =?utf-8?B?d21kL2Rkbi9TenIrd083N2MwV0wySkNjVVFQa0dLUW8wRzhtQWVBaDdBbHlo?=
 =?utf-8?B?N25zUVQ5a2h2b3ZuMWRma29hVTcwN2l3SXZuTHV4WjhyL1BhTUJ6eGp2TDkv?=
 =?utf-8?B?dC91REFTbkJZeDdsL3FwMlNDem5kOUlEYnViVGtrYTB5VUhjTjZSZzdlUXdj?=
 =?utf-8?B?OTlWQ1VydUVUeVJHdVY5WkxjNW1yLzJoanp3S1duNVpFS1VRWWVqam1CamRL?=
 =?utf-8?B?d1k5M1JwdWh5eEIzRUdUc2NZdnZTRG9PVHBzZFZzSmJWTUdXMWtwSEVwQ1l4?=
 =?utf-8?B?ZG9jaStPVVdFQ3pLZVBxL3dMNGt6NDY2dzlNMVlhNENTdU9BanUzWWE4VFJT?=
 =?utf-8?B?SDFmSlNCSy9VUUtrTHFyYllxMk9zcTE2ZG5YdlFzNDY0YjlmRGpxb0xwTHlY?=
 =?utf-8?B?SUxDZFQ1VUdHNWdBa2NGajdTeWNmS0R1U0pHbklweUdRU2c4OEJnV2pBbjVY?=
 =?utf-8?B?UktGemMvdVg1YldFY0FpcjY1b1NlYXo4bVdDQzZtU2RkalAzR2Vyai9NU2tn?=
 =?utf-8?B?TnJnQ3V3bmZjTkp4VDV0UENHWHNwZVl0dGovZVJwM1U5eEtWdHowU0lIRG1i?=
 =?utf-8?B?aXJ6VU9GTWJGcExLTWRWOEoxb1dFeGo3NlRtWG5RWk9rOC9ELzArTjNrV3g5?=
 =?utf-8?B?Z01uNzU1WEVYZ2dtMVBYUWJDTDQzSUI5N3dZU1Q1UEt5ei94djZBaEQvVlBM?=
 =?utf-8?B?RFVsclh4Nm9pVndVZmNMNytOcUw1QkNNc0NRQ0l4WkJnOWVPa3lsS3JnZXdT?=
 =?utf-8?B?ZGxROFJUWEVDN1dwMFhnUmdyZUh3aElHcnZWVUVXb045YVJjbXozZ1R3NGdB?=
 =?utf-8?B?ZklYWVJJNkxMZWtQU2cwbmp2ZWFBM3IyNHU1ZTdrQnM5djBkQ05Fa2hHckxm?=
 =?utf-8?B?MUxURndnUis3c09HVUpQSnF2T0xBdDhReFcrUW83K0RUeVZFQTY3blhXckVJ?=
 =?utf-8?B?U05QcjBITXlsQ3IxNytyTzFLNDhFb0sxUFRnd3k1SGFGQ25kWVFpNDlHanZz?=
 =?utf-8?B?UlAwdVFERVJzdXlrV1ZkVFVGdE45bjlEY2ZsOTZUNWJpWlFVR2RrYUdFakNS?=
 =?utf-8?B?ZDN3TzlCbEZGclZRQWFpUER2UE1YeVVWcXRpbTJINklZMDRyZHZHVUw4NWpo?=
 =?utf-8?B?U2lvcWp3MnJQM3k4VFhhOEpOZ2NlUkxvZ2N1a29rWlJ0NU1VZWNRVzg3VGNW?=
 =?utf-8?B?ajQ4dkJkTGJrZGlPVEt6OGJNTGZ6RFd1d1pMVnhUczgxWnBKQ3owZDVBPT0=?=
x-forefront-antispam-report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:SJ0PR11MB6744.namprd11.prod.outlook.com; PTR:; CAT:NONE;
 SFS:(13230031)(376005)(366007)(1800799015)(38070700009); DIR:OUT; SFP:1101; 
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?M1l6OGUyMlN3UkZ1TEdyMHFwUmxmRnQzQ21hanp1WG1YSUdINGY4WS9nRXA0?=
 =?utf-8?B?RE5lMTljcWdBbEFLZ0pGWDEwKzYzbGhPZU1pQ0R6cGdpSWtUaER2R1p5SmY3?=
 =?utf-8?B?UU5GTVRUUDVkakNkZWcxbWkyM3gzbWlySEI5VHcwaVMyTWtCQ3RrNFJoZVJu?=
 =?utf-8?B?aEhmNnpxWlgxbXpyUHlrc0wxZFhMU0k2Y3A3R2J3ZVE3MCtkcTcxSWpDdmdu?=
 =?utf-8?B?d3YyTFdocDBmdkxPK2VFcHNDOHZUSEpjNm1seUZ4SmpjN1ZzTEdDNnU0NlBw?=
 =?utf-8?B?N1NBN0NjdDdSWHYvOFhQbzNpY1o2b0JrZW9DOWN0dmFVNzhDMlhWNExuNkJW?=
 =?utf-8?B?ZW5iQnVJY1FZYW0xWWdXLy9aKzNzN0wxMEovaEdFZ2JocFFFalprZHRrQlBD?=
 =?utf-8?B?Q1ZOTmhMK0VGRVRHckp6RVhvKy9VdmlrRDF2SGduZkJnUTM5VGpVZDZsZ3pI?=
 =?utf-8?B?MURabmdIaTdXMmN0OGNySFFoVml6SEExWm50Q0RKaE80SVM5WU9Ldmk0WVgx?=
 =?utf-8?B?dm1wQ2Z3NmcyR24yd3F2UEtpbDh3S2hhNlA2eSsxNEpFdXdTK2VUb1VhSnQ0?=
 =?utf-8?B?c1dUeWJEU3B1SVE2WWNNRVNKZ3l4ays4ajhYYTNyKzM5YXRUSk9wdEFGUVpt?=
 =?utf-8?B?NzlwTjF5YjRMZmN3cFFGRDJnY3Rpa0FMNDRnb05tbldoV2ZqQVBkMVZGRXVO?=
 =?utf-8?B?dFFwZXdWamY2VUc0RGY0L2c5dlpKQTh5cDFiUHBpaEkyNnNCY1prT1F6dW5X?=
 =?utf-8?B?ZE1PSVRHb3V2RnQrQXBhdktNdTdON3E4NkhrTHl0dzRnTGxuTGlVU1dWTSsw?=
 =?utf-8?B?NDZQRTQwOXNuaUY4N3M0TnQ4SGZHdGVpSks4bW1uU3dqMmVvMmU2K1d2N3Zn?=
 =?utf-8?B?amNYQnBkVVFldStjT0NrTlNRMjdETGFyWjYvMW82bDZuS01VNUFzRXUzVzFT?=
 =?utf-8?B?SGZFQ2Y5L0VZc0U0aHBEcTlLdGl5bFN4NkdtRVd3TW1aNGk5SDVHdnZYVWhO?=
 =?utf-8?B?NEFCRDFrNm5MRjZ4L2pFK3FJYTM1ZXlvTUF0YkZCMVZrSi8ydDBER01TQnEv?=
 =?utf-8?B?cVphcWZwQTF3bVpmSi9BVDFwSlkwZy83WFZ4aFBORzkzWWRDMWtCMENDMmRl?=
 =?utf-8?B?aDMvNWJTNENBNmNWTTFSUklmekh2RFZrTWIxck0wN0xnbGdVekROYjhrMk0w?=
 =?utf-8?B?VVhHTDNrT0h3dUthR05NYXRMcU1QQ3g2cE4xRXFGUmhNc2FGM1l4akNEL2tV?=
 =?utf-8?B?QmJVRFRIbVBQV1dkcGxvV3U1a1gyNXBGcy94Mk9TdFlJNkM5MjlWT1VmWlFH?=
 =?utf-8?B?NjljdmdZREdtcnZ4VkU0VlliRmlueUpLLytnM2E2OWNUZm5HcmZISFZmcUwz?=
 =?utf-8?B?U0NpT3A3Q01DS2tEQXg0d2FlT3JtQ28xY0M3dktCTWZPMk9WdVpPOVlaNWd5?=
 =?utf-8?B?ZUVLYWdjdGdWVEV2YlpqTVNKMG9OR1c5SlA3cFpCd0dxQ0lHRWU5U2szdmVT?=
 =?utf-8?B?Q3d4UmN1RWpwc1dTSDdVazRYbFRhdHc3WW4zUUIveHNQY1R3SUZlWkpjeWJF?=
 =?utf-8?B?NHUxOU5wZEEwMVE0R2p5VTMyUDA1ZWNrd1NHcHBJZ1dubG5uay8vc1BuMHY4?=
 =?utf-8?B?UEQ5aWUzTUhySkwrUUN4UkpPZCt0enFwYmdXWmo3T3o4OElFbjlYK1NVOGZK?=
 =?utf-8?B?L3hqcGpxT3JYNFVpUkl2dEUwRWl3cmdHS1F3YVNPUDUrM1YvcmlwcnpqUW9G?=
 =?utf-8?B?SW15WWhnVE53Ry81cUg5TVljQ1NSam13eWtZbHc0ck5vRWtOcDZkeDE2S20z?=
 =?utf-8?B?akxKYmc4V3hDc1hENktOUmxBSEEvVFpPYUFEZUNaU0VwaFdGclJ2WXpFa3V3?=
 =?utf-8?B?MlBEckhwZ3VRd0Z2eEczVDRMMVNtZjg1NVZsamlKK0M0OXFXZXFNM3dVWFJ5?=
 =?utf-8?B?azcxYk9vbk9nT3l6bndUU2ZhZ2l2Ry9udE9GWklaTm13TUttSzZzenlseVo0?=
 =?utf-8?B?MElSWmJRL3o5cklIV0F1dkUzQU5YYktNaTlFUXZvcTBEaTlKZnRuMERyQk9Q?=
 =?utf-8?B?UlBYSi85a2hLMDB3NHBTS3BadUFTeVRCcDBQeGZFcnh6SXIydWdhdkIwMVN0?=
 =?utf-8?Q?2eoQJ9T8GP6JbbtcepReT6ToP?=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: SJ0PR11MB6744.namprd11.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 6f023026-0aba-43a2-7180-08dc765e4b31
X-MS-Exchange-CrossTenant-originalarrivaltime: 17 May 2024 10:44:13.9715 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 46c98d88-e344-4ed4-8496-4ed7712e255d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 4Y22hwsdN5duuNxB1irf3OqVmxvfUmOAM2JQWyjLcouLmhp/W+tjbLf9hoDw06HG7LR8S1yaelrIH7H5pivBf0WxPhg9l61lgncJ2i2Veek=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MW4PR11MB6912
X-OriginatorOrg: intel.com
Received-SPF: pass client-ip=192.198.163.9;
 envelope-from=zhenzhong.duan@intel.com; helo=mgamail.intel.com
X-Spam_score_int: -53
X-Spam_score: -5.4
X-Spam_bar: -----
X-Spam_report: (-5.4 / 5.0 requ) BAYES_00=-1.9, DKIMWL_WL_HIGH=-1.022,
 DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, DKIM_VALID_EF=-0.1,
 RCVD_IN_DNSWL_MED=-2.3, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

DQoNCj4tLS0tLU9yaWdpbmFsIE1lc3NhZ2UtLS0tLQ0KPkZyb206IENMRU1FTlQgTUFUSElFVS0t
RFJJRiA8Y2xlbWVudC5tYXRoaWV1LS1kcmlmQGV2aWRlbi5jb20+DQo+U3ViamVjdDogW1BBVENI
IGF0c192dGQgdjIgMjEvMjVdIGF0YzogZ2VuZXJpYyBBVEMgdGhhdCBjYW4gYmUgdXNlZCBieSBQ
Q0llDQo+ZGV2aWNlcyB0aGF0IHN1cHBvcnQgU1ZNDQo+DQo+QXMgdGhlIFNWTS1jYXBhYmxlIGRl
dmljZXMgd2lsbCBuZWVkIHRvIGNhY2hlIHRyYW5zbGF0aW9ucywgd2UgcHJvdmlkZQ0KPmFuIGZp
cnN0IGltcGxlbWVudGF0aW9uLg0KPg0KPlRoaXMgY2FjaGUgdXNlcyBhIHR3by1sZXZlbCBkZXNp
Z24gYmFzZWQgb24gaGFzaCB0YWJsZXMuDQo+VGhlIGZpcnN0IGxldmVsIGlzIGluZGV4ZWQgYnkg
YSBQQVNJRCBhbmQgdGhlIHNlY29uZCBieSBhIHZpcnR1YWwgYWRkcmVzc2UuDQo+DQo+U2lnbmVk
LW9mZi1ieTogQ2zDqW1lbnQgTWF0aGlldS0tRHJpZiA8Y2xlbWVudC5tYXRoaWV1LS1kcmlmQGV2
aWRlbi5jb20+DQo+LS0tDQo+IHRlc3RzL3VuaXQvbWVzb24uYnVpbGQgfCAgIDEgKw0KPiB0ZXN0
cy91bml0L3Rlc3QtYXRjLmMgIHwgNTAyDQo+KysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysNCj4gdXRpbC9hdGMuYyAgICAgICAgICAgICB8IDIxMSArKysrKysrKysrKysr
KysrKw0KPiB1dGlsL2F0Yy5oICAgICAgICAgICAgIHwgMTE3ICsrKysrKysrKysNCj4gdXRpbC9t
ZXNvbi5idWlsZCAgICAgICB8ICAgMSArDQo+IDUgZmlsZXMgY2hhbmdlZCwgODMyIGluc2VydGlv
bnMoKykNCj4gY3JlYXRlIG1vZGUgMTAwNjQ0IHRlc3RzL3VuaXQvdGVzdC1hdGMuYw0KPiBjcmVh
dGUgbW9kZSAxMDA2NDQgdXRpbC9hdGMuYw0KPiBjcmVhdGUgbW9kZSAxMDA2NDQgdXRpbC9hdGMu
aA0KDQpNYXliZSB0aGUgdW5pdCB0ZXN0IGNhbiBiZSBzcGxpdCBmcm9tIGZ1bmN0aW9uYWwgY2hh
bmdlPw0KDQo+DQo+ZGlmZiAtLWdpdCBhL3Rlc3RzL3VuaXQvbWVzb24uYnVpbGQgYi90ZXN0cy91
bml0L21lc29uLmJ1aWxkDQo+aW5kZXggMjI4YTIxZDAzYy4uNWM5YTZmZTlmNCAxMDA2NDQNCj4t
LS0gYS90ZXN0cy91bml0L21lc29uLmJ1aWxkDQo+KysrIGIvdGVzdHMvdW5pdC9tZXNvbi5idWls
ZA0KPkBAIC01Miw2ICs1Miw3IEBAIHRlc3RzID0gew0KPiAgICd0ZXN0LWludGVydmFsLXRyZWUn
OiBbXSwNCj4gICAndGVzdC14cy1ub2RlJzogW3FvbV0sDQo+ICAgJ3Rlc3QtdmlydGlvLWRtYWJ1
Zic6IFttZXNvbi5wcm9qZWN0X3NvdXJjZV9yb290KCkgLyAnaHcvZGlzcGxheS92aXJ0aW8tDQo+
ZG1hYnVmLmMnXSwNCj4rICAndGVzdC1hdGMnOiBbXQ0KPiB9DQo+DQo+IGlmIGhhdmVfc3lzdGVt
IG9yIGhhdmVfdG9vbHMNCj5kaWZmIC0tZ2l0IGEvdGVzdHMvdW5pdC90ZXN0LWF0Yy5jIGIvdGVz
dHMvdW5pdC90ZXN0LWF0Yy5jDQo+bmV3IGZpbGUgbW9kZSAxMDA2NDQNCj5pbmRleCAwMDAwMDAw
MDAwLi42MGZhNjA5MjRhDQo+LS0tIC9kZXYvbnVsbA0KPisrKyBiL3Rlc3RzL3VuaXQvdGVzdC1h
dGMuYw0KPkBAIC0wLDAgKzEsNTAyIEBADQo+Ky8qDQo+KyAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVl
IHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5DQo+KyAqIGl0
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVi
bGlzaGVkIGJ5DQo+KyAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJz
aW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yDQo+KyAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVy
IHZlcnNpb24uDQo+Kw0KPisgKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhv
cGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwNCj4rICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZ
OyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YNCj4rICogTUVSQ0hBTlRBQklM
SVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQ0KPisgKiBH
TlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLg0KPisNCj4rICogWW91
IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExp
Y2Vuc2UgYWxvbmcNCj4rICogd2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgc2VlIDxodHRwOi8v
d3d3LmdudS5vcmcvbGljZW5zZXMvPi4NCj4rICovDQo+Kw0KPisjaW5jbHVkZSAidXRpbC9hdGMu
aCINCj4rDQo+K3N0YXRpYyBpbmxpbmUgYm9vbCB0bGJfZW50cnlfZXF1YWwoSU9NTVVUTEJFbnRy
eSAqZTEsIElPTU1VVExCRW50cnkNCj4qZTIpDQo+K3sNCj4rICAgIGlmICghZTEgfHwgIWUyKSB7
DQo+KyAgICAgICAgcmV0dXJuICFlMSAmJiAhZTI7DQo+KyAgICB9DQo+KyAgICByZXR1cm4gZTEt
PmlvdmEgPT0gZTItPmlvdmEgJiYNCj4rICAgICAgICAgICAgZTEtPmFkZHJfbWFzayA9PSBlMi0+
YWRkcl9tYXNrICYmDQo+KyAgICAgICAgICAgIGUxLT5wYXNpZCA9PSBlMi0+cGFzaWQgJiYNCj4r
ICAgICAgICAgICAgZTEtPnBlcm0gPT0gZTItPnBlcm0gJiYNCj4rICAgICAgICAgICAgZTEtPnRh
cmdldF9hcyA9PSBlMi0+dGFyZ2V0X2FzICYmDQo+KyAgICAgICAgICAgIGUxLT50cmFuc2xhdGVk
X2FkZHIgPT0gZTItPnRyYW5zbGF0ZWRfYWRkcjsNCj4rfQ0KPisNCj4rc3RhdGljIHZvaWQgYXNz
ZXJ0X2xvb2t1cF9lcXVhbHMoQVRDICphdGMsIElPTU1VVExCRW50cnkgKnRhcmdldCwNCj4rICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgcGFzaWQsIGh3YWRkciBpb3Zh
KQ0KPit7DQo+KyAgICBJT01NVVRMQkVudHJ5ICpyZXN1bHQ7DQo+KyAgICByZXN1bHQgPSBhdGNf
bG9va3VwKGF0YywgcGFzaWQsIGlvdmEpOw0KPisgICAgZ19hc3NlcnQodGxiX2VudHJ5X2VxdWFs
KHJlc3VsdCwgdGFyZ2V0KSk7DQo+K30NCj4rDQo+K3N0YXRpYyB2b2lkIGNoZWNrX2NyZWF0aW9u
KHVpbnQ2NF90IHBhZ2Vfc2l6ZSwgdWludDhfdCBhZGRyZXNzX3dpZHRoLA0KPisgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1aW50OF90IGxldmVscywgdWludDhfdCBsZXZlbF9vZmZzZXQsDQo+
KyAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgc2hvdWxkX3dvcmspIHsNCj4rICAgIEFU
QyAqYXRjID0gYXRjX25ldyhwYWdlX3NpemUsIGFkZHJlc3Nfd2lkdGgpOw0KPisgICAgaWYgKGF0
Yykgew0KPisgICAgICAgIGlmIChhdGMtPmxldmVscyAhPSBsZXZlbHMgfHwgYXRjLT5sZXZlbF9v
ZmZzZXQgIT0gbGV2ZWxfb2Zmc2V0KSB7DQo+KyAgICAgICAgICAgIGdfYXNzZXJ0KGZhbHNlKTsg
LyogQVRDIGNyZWF0ZWQgYnV0IGludmFsaWQgY29uZmlndXJhdGlvbiA6IGZhaWwgKi8NCj4rICAg
ICAgICB9DQo+KyAgICAgICAgYXRjX2Rlc3Ryb3koYXRjKTsNCj4rICAgICAgICBnX2Fzc2VydChz
aG91bGRfd29yayk7DQo+KyAgICB9IGVsc2Ugew0KPisgICAgICAgIGdfYXNzZXJ0KCFzaG91bGRf
d29yayk7DQo+KyAgICB9DQo+K30NCj4rDQo+K3N0YXRpYyB2b2lkIHRlc3RfY3JlYXRpb25fcGFy
YW1ldGVycyh2b2lkKQ0KPit7DQo+KyAgICBjaGVja19jcmVhdGlvbig4LCAzOSwgMywgOSwgZmFs
c2UpOw0KPisgICAgY2hlY2tfY3JlYXRpb24oNDA5NSwgMzksIDMsIDksIGZhbHNlKTsNCj4rICAg
IGNoZWNrX2NyZWF0aW9uKDQwOTcsIDM5LCAzLCA5LCBmYWxzZSk7DQo+KyAgICBjaGVja19jcmVh
dGlvbig4MTkyLCA0OCwgMCwgMCwgZmFsc2UpOw0KPisNCj4rICAgIGNoZWNrX2NyZWF0aW9uKDQw
OTYsIDM4LCAwLCAwLCBmYWxzZSk7DQo+KyAgICBjaGVja19jcmVhdGlvbig0MDk2LCAzOSwgMywg
OSwgdHJ1ZSk7DQo+KyAgICBjaGVja19jcmVhdGlvbig0MDk2LCA0MCwgMCwgMCwgZmFsc2UpOw0K
PisgICAgY2hlY2tfY3JlYXRpb24oNDA5NiwgNDcsIDAsIDAsIGZhbHNlKTsNCj4rICAgIGNoZWNr
X2NyZWF0aW9uKDQwOTYsIDQ4LCA0LCA5LCB0cnVlKTsNCj4rICAgIGNoZWNrX2NyZWF0aW9uKDQw
OTYsIDQ5LCAwLCAwLCBmYWxzZSk7DQo+KyAgICBjaGVja19jcmVhdGlvbig0MDk2LCA1NiwgMCwg
MCwgZmFsc2UpOw0KPisgICAgY2hlY2tfY3JlYXRpb24oNDA5NiwgNTcsIDUsIDksIHRydWUpOw0K
PisgICAgY2hlY2tfY3JlYXRpb24oNDA5NiwgNTgsIDAsIDAsIGZhbHNlKTsNCj4rDQo+KyAgICBj
aGVja19jcmVhdGlvbigxNjM4NCwgMzUsIDAsIDAsIGZhbHNlKTsNCj4rICAgIGNoZWNrX2NyZWF0
aW9uKDE2Mzg0LCAzNiwgMiwgMTEsIHRydWUpOw0KPisgICAgY2hlY2tfY3JlYXRpb24oMTYzODQs
IDM3LCAwLCAwLCBmYWxzZSk7DQo+KyAgICBjaGVja19jcmVhdGlvbigxNjM4NCwgNDYsIDAsIDAs
IGZhbHNlKTsNCj4rICAgIGNoZWNrX2NyZWF0aW9uKDE2Mzg0LCA0NywgMywgMTEsIHRydWUpOw0K
PisgICAgY2hlY2tfY3JlYXRpb24oMTYzODQsIDQ4LCAwLCAwLCBmYWxzZSk7DQo+KyAgICBjaGVj
a19jcmVhdGlvbigxNjM4NCwgNTcsIDAsIDAsIGZhbHNlKTsNCj4rICAgIGNoZWNrX2NyZWF0aW9u
KDE2Mzg0LCA1OCwgNCwgMTEsIHRydWUpOw0KPisgICAgY2hlY2tfY3JlYXRpb24oMTYzODQsIDU5
LCAwLCAwLCBmYWxzZSk7DQo+K30NCj4rDQo+K3N0YXRpYyB2b2lkIHRlc3Rfc2luZ2xlX2VudHJ5
KHZvaWQpDQo+K3sNCj4rICAgIElPTU1VVExCRW50cnkgZW50cnkgPSB7DQo+KyAgICAgICAgLmlv
dmEgPSAweDEyMzQ1Njc4OTAwMFVMTCwNCj4rICAgICAgICAuYWRkcl9tYXNrID0gMHhmZmZVTEws
DQo+KyAgICAgICAgLnBhc2lkID0gNSwNCj4rICAgICAgICAucGVybSA9IElPTU1VX1JXLA0KPisg
ICAgICAgIC50cmFuc2xhdGVkX2FkZHIgPSAweGRlYWRiZWVmVUxMLA0KPisgICAgfTsNCj4rDQo+
KyAgICBBVEMgKmF0YyA9IGF0Y19uZXcoNDA5NiwgNDgpOw0KPisgICAgZ19hc3NlcnQoYXRjKTsN
Cj4rDQo+KyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5VTEwsIGVudHJ5LnBhc2lkLA0K
PisgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnkuaW92YSArIChlbnRyeS5hZGRyX21hc2sg
LyAyKSk7DQo+Kw0KPisgICAgYXRjX2NyZWF0ZV9hZGRyZXNzX3NwYWNlX2NhY2hlKGF0YywgZW50
cnkucGFzaWQpOw0KPisgICAgZ19hc3NlcnQoYXRjX3VwZGF0ZShhdGMsICZlbnRyeSkgPT0gMCk7
DQo+Kw0KPisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCBOVUxMLCBlbnRyeS5wYXNpZCAr
IDEsDQo+KyAgICAgICAgICAgICAgICAgICAgICAgICBlbnRyeS5pb3ZhICsgKGVudHJ5LmFkZHJf
bWFzayAvIDIpKTsNCj4rICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmVudHJ5LCBlbnRy
eS5wYXNpZCwNCj4rICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5LmlvdmEgKyAoZW50cnku
YWRkcl9tYXNrIC8gMikpOw0KPisNCj4rICAgIGF0Y19kZXN0cm95KGF0Yyk7DQo+K30NCj4rDQo+
K3N0YXRpYyB2b2lkIHRlc3RfcGFnZV9ib3VuZGFyaWVzKHZvaWQpDQo+K3sNCj4rICAgIHN0YXRp
YyBjb25zdCB1aW50MzJfdCBwYXNpZCA9IDU7DQo+KyAgICBzdGF0aWMgY29uc3QgaHdhZGRyIHBh
Z2Vfc2l6ZSA9IDQwOTY7DQo+Kw0KPisgICAgLyogMiBjb25zZWN1dGl2ZSBlbnRyaWVzICovDQo+
KyAgICBJT01NVVRMQkVudHJ5IGUxID0gew0KPisgICAgICAgIC5pb3ZhID0gMHgxMjM0NTY3ODkw
MDBVTEwsDQo+KyAgICAgICAgLmFkZHJfbWFzayA9IHBhZ2Vfc2l6ZSAtIDEsDQo+KyAgICAgICAg
LnBhc2lkID0gcGFzaWQsDQo+KyAgICAgICAgLnBlcm0gPSBJT01NVV9SVywNCj4rICAgICAgICAu
dHJhbnNsYXRlZF9hZGRyID0gMHhkZWFkYmVlZlVMTCwNCj4rICAgIH07DQo+KyAgICBJT01NVVRM
QkVudHJ5IGUyID0gew0KPisgICAgICAgIC5pb3ZhID0gZTEuaW92YSArIHBhZ2Vfc2l6ZSwNCj4r
ICAgICAgICAuYWRkcl9tYXNrID0gcGFnZV9zaXplIC0gMSwNCj4rICAgICAgICAucGFzaWQgPSBw
YXNpZCwNCj4rICAgICAgICAucGVybSA9IElPTU1VX1JXLA0KPisgICAgICAgIC50cmFuc2xhdGVk
X2FkZHIgPSAweDkwMGRmMDBkVUxMLA0KPisgICAgfTsNCj4rDQo+KyAgICBBVEMgKmF0YyA9IGF0
Y19uZXcocGFnZV9zaXplLCA0OCk7DQo+Kw0KPisgICAgYXRjX2NyZWF0ZV9hZGRyZXNzX3NwYWNl
X2NhY2hlKGF0YywgZTEucGFzaWQpOw0KPisgICAgLyogY3JlYXRpbmcgdGhlIGFkZHJlc3Mgc3Bh
Y2UgdHdpY2Ugc2hvdWxkIG5vdCBiZSBhIHByb2JsZW0gKi8NCj4rICAgIGF0Y19jcmVhdGVfYWRk
cmVzc19zcGFjZV9jYWNoZShhdGMsIGUxLnBhc2lkKTsNCj4rDQo+KyAgICBhdGNfdXBkYXRlKGF0
YywgJmUxKTsNCj4rICAgIGF0Y191cGRhdGUoYXRjLCAmZTIpOw0KPisNCj4rICAgIGFzc2VydF9s
b29rdXBfZXF1YWxzKGF0YywgTlVMTCwgZTEucGFzaWQsIGUxLmlvdmEgLSAxKTsNCj4rICAgIGFz
c2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUxLCBlMS5wYXNpZCwgZTEuaW92YSk7DQo+KyAgICBh
c3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMSwgZTEucGFzaWQsIGUxLmlvdmEgKyBlMS5hZGRy
X21hc2spOw0KPisgICAgZ19hc3NlcnQoKGUxLmlvdmEgKyBlMS5hZGRyX21hc2sgKyAxKSA9PSBl
Mi5pb3ZhKTsNCj4rICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUyLCBlMi5wYXNpZCwg
ZTIuaW92YSk7DQo+KyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMiwgZTIucGFzaWQs
IGUyLmlvdmEgKyBlMi5hZGRyX21hc2spOw0KPisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRj
LCBOVUxMLCBlMi5wYXNpZCwgZTIuaW92YSArIGUyLmFkZHJfbWFzayArIDEpOw0KPisNCj4rICAg
IGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgTlVMTCwgZTEucGFzaWQgKyAxMCwgZTEuaW92YSk7
DQo+KyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5VTEwsIGUyLnBhc2lkICsgMTAsIGUy
LmlvdmEpOw0KPisgICAgYXRjX2Rlc3Ryb3koYXRjKTsNCj4rfQ0KPisNCj4rc3RhdGljIHZvaWQg
dGVzdF9odWdlX3BhZ2Uodm9pZCkNCj4rew0KPisgICAgc3RhdGljIGNvbnN0IHVpbnQzMl90IHBh
c2lkID0gNTsNCj4rICAgIHN0YXRpYyBjb25zdCBod2FkZHIgcGFnZV9zaXplID0gNDA5NjsNCj4r
ICAgIElPTU1VVExCRW50cnkgZTEgPSB7DQo+KyAgICAgICAgLmlvdmEgPSAweDEyMzQ1NjYwMDAw
MFVMTCwNCj4rICAgICAgICAuYWRkcl9tYXNrID0gMHgxZmZmZmZVTEwsDQo+KyAgICAgICAgLnBh
c2lkID0gcGFzaWQsDQo+KyAgICAgICAgLnBlcm0gPSBJT01NVV9SVywNCj4rICAgICAgICAudHJh
bnNsYXRlZF9hZGRyID0gMHhkZWFkYmVlZlVMTCwNCj4rICAgIH07DQo+KyAgICBod2FkZHIgYWRk
cjsNCj4rDQo+KyAgICBBVEMgKmF0YyA9IGF0Y19uZXcocGFnZV9zaXplLCA0OCk7DQo+Kw0KPisg
ICAgYXRjX2NyZWF0ZV9hZGRyZXNzX3NwYWNlX2NhY2hlKGF0YywgZTEucGFzaWQpOw0KPisgICAg
YXRjX3VwZGF0ZShhdGMsICZlMSk7DQo+Kw0KPisgICAgZm9yIChhZGRyID0gZTEuaW92YTsgYWRk
ciA8PSBlMS5pb3ZhICsgZTEuYWRkcl9tYXNrOyBhZGRyICs9IHBhZ2Vfc2l6ZSkgew0KPisgICAg
ICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUxLCBlMS5wYXNpZCwgYWRkcik7DQo+KyAg
ICB9DQo+KyAgICAvKiBhZGRyIGlzIG5vdyBvdXQgb2YgdGhlIGh1Z2UgcGFnZSAqLw0KPisgICAg
YXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCBOVUxMLCBlMS5wYXNpZCwgYWRkcik7DQo+KyAgICBh
dGNfZGVzdHJveShhdGMpOw0KPit9DQo+Kw0KPitzdGF0aWMgdm9pZCB0ZXN0X3Bhc2lkKHZvaWQp
DQo+K3sNCj4rICAgIGh3YWRkciBhZGRyID0gMHhhYWFhYWFhYWEwMDBVTEw7DQo+KyAgICBJT01N
VVRMQkVudHJ5IGUxID0gew0KPisgICAgICAgIC5pb3ZhID0gYWRkciwNCj4rICAgICAgICAuYWRk
cl9tYXNrID0gMHhmZmZVTEwsDQo+KyAgICAgICAgLnBhc2lkID0gOCwNCj4rICAgICAgICAucGVy
bSA9IElPTU1VX1JXLA0KPisgICAgICAgIC50cmFuc2xhdGVkX2FkZHIgPSAweGRlYWRiZWVmVUxM
LA0KPisgICAgfTsNCj4rICAgIElPTU1VVExCRW50cnkgZTIgPSB7DQo+KyAgICAgICAgLmlvdmEg
PSBhZGRyLA0KPisgICAgICAgIC5hZGRyX21hc2sgPSAweGZmZlVMTCwNCj4rICAgICAgICAucGFz
aWQgPSAyLA0KPisgICAgICAgIC5wZXJtID0gSU9NTVVfUlcsDQo+KyAgICAgICAgLnRyYW5zbGF0
ZWRfYWRkciA9IDB4YjAwMVVMTCwNCj4rICAgIH07DQo+KyAgICB1aW50MTZfdCBpOw0KPisNCj4r
ICAgIEFUQyAqYXRjID0gYXRjX25ldyg0MDk2LCA0OCk7DQo+Kw0KPisgICAgYXRjX2NyZWF0ZV9h
ZGRyZXNzX3NwYWNlX2NhY2hlKGF0YywgZTEucGFzaWQpOw0KPisgICAgYXRjX2NyZWF0ZV9hZGRy
ZXNzX3NwYWNlX2NhY2hlKGF0YywgZTIucGFzaWQpOw0KPisgICAgYXRjX3VwZGF0ZShhdGMsICZl
MSk7DQo+KyAgICBhdGNfdXBkYXRlKGF0YywgJmUyKTsNCj4rDQo+KyAgICBmb3IgKGkgPSAwOyBp
IDw9IE1BWChlMS5wYXNpZCwgZTIucGFzaWQpICsgMTsgKytpKSB7DQo+KyAgICAgICAgaWYgKGkg
PT0gZTEucGFzaWQgfHwgaSA9PSBlMi5wYXNpZCkgew0KPisgICAgICAgICAgICBjb250aW51ZTsN
Cj4rICAgICAgICB9DQo+KyAgICAgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCBOVUxMLCBp
LCBhZGRyKTsNCj4rICAgIH0NCj4rICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUxLCBl
MS5wYXNpZCwgYWRkcik7DQo+KyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMSwgZTEu
cGFzaWQsIGFkZHIpOw0KPisgICAgYXRjX2Rlc3Ryb3koYXRjKTsNCj4rfQ0KPisNCj4rc3RhdGlj
IHZvaWQgdGVzdF9sYXJnZV9hZGRyZXNzKHZvaWQpDQo+K3sNCj4rICAgIElPTU1VVExCRW50cnkg
ZTEgPSB7DQo+KyAgICAgICAgLmlvdmEgPSAweGFhYWFhYWFhYTAwMFVMTCwNCj4rICAgICAgICAu
YWRkcl9tYXNrID0gMHhmZmZVTEwsDQo+KyAgICAgICAgLnBhc2lkID0gOCwNCj4rICAgICAgICAu
cGVybSA9IElPTU1VX1JXLA0KPisgICAgICAgIC50cmFuc2xhdGVkX2FkZHIgPSAweDVlZWVlZWVk
VUxMLA0KPisgICAgfTsNCj4rICAgIElPTU1VVExCRW50cnkgZTIgPSB7DQo+KyAgICAgICAgLmlv
dmEgPSAweDFmMDBiYWFhYWFiZjAwMFVMTCwNCj4rICAgICAgICAuYWRkcl9tYXNrID0gMHhmZmZV
TEwsDQo+KyAgICAgICAgLnBhc2lkID0gZTEucGFzaWQsDQo+KyAgICAgICAgLnBlcm0gPSBJT01N
VV9SVywNCj4rICAgICAgICAudHJhbnNsYXRlZF9hZGRyID0gMHhkZWFkYmVlZlVMTCwNCj4rICAg
IH07DQo+Kw0KPisgICAgQVRDICphdGMgPSBhdGNfbmV3KDQwOTYsIDU3KTsNCj4rDQo+KyAgICBh
dGNfY3JlYXRlX2FkZHJlc3Nfc3BhY2VfY2FjaGUoYXRjLCBlMS5wYXNpZCk7DQo+KyAgICBhdGNf
dXBkYXRlKGF0YywgJmUxKTsNCj4rICAgIGF0Y191cGRhdGUoYXRjLCAmZTIpOw0KPisNCj4rICAg
IGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUxLCBlMS5wYXNpZCwgZTEuaW92YSk7DQo+KyAg
ICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMiwgZTIucGFzaWQsIGUyLmlvdmEpOw0KPisg
ICAgYXRjX2Rlc3Ryb3koYXRjKTsNCj4rfQ0KPisNCj4rc3RhdGljIHZvaWQgdGVzdF9iaWdnZXJf
cGFnZSh2b2lkKQ0KPit7DQo+KyAgICBJT01NVVRMQkVudHJ5IGUxID0gew0KPisgICAgICAgIC5p
b3ZhID0gMHhhYWJiY2NkZGUwMDBVTEwsDQo+KyAgICAgICAgLmFkZHJfbWFzayA9IDB4MWZmZlVM
TCwNCj4rICAgICAgICAucGFzaWQgPSAxLA0KPisgICAgICAgIC5wZXJtID0gSU9NTVVfUlcsDQo+
KyAgICAgICAgLnRyYW5zbGF0ZWRfYWRkciA9IDB4NWVlZWVlZWRVTEwsDQo+KyAgICB9Ow0KPisg
ICAgaHdhZGRyIGk7DQo+Kw0KPisgICAgQVRDICphdGMgPSBhdGNfbmV3KDgxOTIsIDQzKTsNCj4r
DQo+KyAgICBhdGNfY3JlYXRlX2FkZHJlc3Nfc3BhY2VfY2FjaGUoYXRjLCBlMS5wYXNpZCk7DQo+
KyAgICBhdGNfdXBkYXRlKGF0YywgJmUxKTsNCj4rDQo+KyAgICBpID0gZTEuaW92YSAmICh+ZTEu
YWRkcl9tYXNrKTsNCj4rICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgTlVMTCwgZTEucGFz
aWQsIGkgLSAxKTsNCj4rICAgIHdoaWxlIChpIDw9IGUxLmlvdmEgKyBlMS5hZGRyX21hc2spIHsN
Cj4rICAgICAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMSwgZTEucGFzaWQsIGkpOw0K
PisgICAgICAgICsraTsNCj4rICAgIH0NCj4rICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0Yywg
TlVMTCwgZTEucGFzaWQsIGkpOw0KPisgICAgYXRjX2Rlc3Ryb3koYXRjKTsNCj4rfQ0KPisNCj4r
c3RhdGljIHZvaWQgdGVzdF91bmtub3duX3Bhc2lkKHZvaWQpDQo+K3sNCj4rICAgIElPTU1VVExC
RW50cnkgZTEgPSB7DQo+KyAgICAgICAgLmlvdmEgPSAweGFhYmJjY2ZmZjAwMFVMTCwNCj4rICAg
ICAgICAuYWRkcl9tYXNrID0gMHhmZmZVTEwsDQo+KyAgICAgICAgLnBhc2lkID0gMSwNCj4rICAg
ICAgICAucGVybSA9IElPTU1VX1JXLA0KPisgICAgICAgIC50cmFuc2xhdGVkX2FkZHIgPSAweDVl
ZWVlZWVkVUxMLA0KPisgICAgfTsNCj4rDQo+KyAgICBBVEMgKmF0YyA9IGF0Y19uZXcoNDA5Niwg
NDgpOw0KPisgICAgZ19hc3NlcnQoYXRjX3VwZGF0ZShhdGMsICZlMSkgIT0gMCk7DQo+KyAgICBh
c3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5VTEwsIGUxLnBhc2lkLCBlMS5pb3ZhKTsNCj4rfQ0K
PisNCj4rc3RhdGljIHZvaWQgdGVzdF9pbnZhbGlkYXRpb24odm9pZCkNCj4rew0KPisgICAgc3Rh
dGljIHVpbnQ2NF90IHBhZ2Vfc2l6ZSA9IDQwOTY7DQo+KyAgICBJT01NVVRMQkVudHJ5IGUxID0g
ew0KPisgICAgICAgIC5pb3ZhID0gMHhhYWJiY2NkZGYwMDBVTEwsDQo+KyAgICAgICAgLmFkZHJf
bWFzayA9IDB4ZmZmVUxMLA0KPisgICAgICAgIC5wYXNpZCA9IDEsDQo+KyAgICAgICAgLnBlcm0g
PSBJT01NVV9SVywNCj4rICAgICAgICAudHJhbnNsYXRlZF9hZGRyID0gMHg1ZWVlZWVlZFVMTCwN
Cj4rICAgIH07DQo+KyAgICBJT01NVVRMQkVudHJ5IGUyID0gew0KPisgICAgICAgIC5pb3ZhID0g
MHhmZmUwMDAwMFVMTCwNCj4rICAgICAgICAuYWRkcl9tYXNrID0gMHgxZmZmZmZVTEwsDQo+KyAg
ICAgICAgLnBhc2lkID0gMSwNCj4rICAgICAgICAucGVybSA9IElPTU1VX1JXLA0KPisgICAgICAg
IC50cmFuc2xhdGVkX2FkZHIgPSAweGIwMDAwMDFVTEwsDQo+KyAgICB9Ow0KPisgICAgSU9NTVVU
TEJFbnRyeSBlMzsNCj4rDQo+KyAgICBBVEMgKmF0YyA9IGF0Y19uZXcocGFnZV9zaXplICwgNDgp
Ow0KPisgICAgYXRjX2NyZWF0ZV9hZGRyZXNzX3NwYWNlX2NhY2hlKGF0YywgZTEucGFzaWQpOw0K
PisNCj4rICAgIGF0Y191cGRhdGUoYXRjLCAmZTEpOw0KPisgICAgYXNzZXJ0X2xvb2t1cF9lcXVh
bHMoYXRjLCAmZTEsIGUxLnBhc2lkLCBlMS5pb3ZhKTsNCj4rICAgIGF0Y19pbnZhbGlkYXRlKGF0
YywgJmUxKTsNCj4rICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgTlVMTCwgZTEucGFzaWQs
IGUxLmlvdmEpOw0KPisNCj4rICAgIGF0Y191cGRhdGUoYXRjLCAmZTEpOw0KPisgICAgYXRjX3Vw
ZGF0ZShhdGMsICZlMik7DQo+KyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMSwgZTEu
cGFzaWQsIGUxLmlvdmEpOw0KPisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCAmZTIsIGUy
LnBhc2lkLCBlMi5pb3ZhKTsNCj4rICAgIGF0Y19pbnZhbGlkYXRlKGF0YywgJmUyKTsNCj4rICAg
IGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUxLCBlMS5wYXNpZCwgZTEuaW92YSk7DQo+KyAg
ICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5VTEwsIGUyLnBhc2lkLCBlMi5pb3ZhKTsNCj4r
DQo+KyAgICAvKiBpbnZhbGlkYXRlIGEgaHVnZSBwYWdlIGJ5IGludmFsaWRhdGluZyBhIHNtYWxs
IHJlZ2lvbiAqLw0KPisgICAgZm9yIChod2FkZHIgYWRkciA9IGUyLmlvdmE7IGFkZHIgPD0gKGUy
LmlvdmEgKyBlMi5hZGRyX21hc2spOw0KPisgICAgICAgICBhZGRyICs9IHBhZ2Vfc2l6ZSkgew0K
PisgICAgICAgIGF0Y191cGRhdGUoYXRjLCAmZTIpOw0KPisgICAgICAgIGFzc2VydF9sb29rdXBf
ZXF1YWxzKGF0YywgJmUyLCBlMi5wYXNpZCwgZTIuaW92YSk7DQo+KyAgICAgICAgZTMgPSAoSU9N
TVVUTEJFbnRyeSl7DQo+KyAgICAgICAgICAgIC5pb3ZhID0gYWRkciwNCj4rICAgICAgICAgICAg
LmFkZHJfbWFzayA9IHBhZ2Vfc2l6ZSAtIDEsDQo+KyAgICAgICAgICAgIC5wYXNpZCA9IGUyLnBh
c2lkLA0KPisgICAgICAgICAgICAucGVybSA9IElPTU1VX1JXLA0KPisgICAgICAgICAgICAudHJh
bnNsYXRlZF9hZGRyID0gMCwNCj4rICAgICAgICB9Ow0KPisgICAgICAgIGF0Y19pbnZhbGlkYXRl
KGF0YywgJmUzKTsNCj4rICAgICAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5VTEwsIGUy
LnBhc2lkLCBlMi5pb3ZhKTsNCj4rICAgIH0NCj4rfQ0KPisNCj4rc3RhdGljIHZvaWQgdGVzdF9k
ZWxldGVfYWRkcmVzc19zcGFjZV9jYWNoZSh2b2lkKQ0KPit7DQo+KyAgICBzdGF0aWMgdWludDY0
X3QgcGFnZV9zaXplID0gNDA5NjsNCj4rICAgIElPTU1VVExCRW50cnkgZTEgPSB7DQo+KyAgICAg
ICAgLmlvdmEgPSAweGFhYmJjY2RkZjAwMFVMTCwNCj4rICAgICAgICAuYWRkcl9tYXNrID0gMHhm
ZmZVTEwsDQo+KyAgICAgICAgLnBhc2lkID0gMSwNCj4rICAgICAgICAucGVybSA9IElPTU1VX1JX
LA0KPisgICAgICAgIC50cmFuc2xhdGVkX2FkZHIgPSAweDVlZWVlZWVkVUxMLA0KPisgICAgfTsN
Cj4rICAgIElPTU1VVExCRW50cnkgZTIgPSB7DQo+KyAgICAgICAgLmlvdmEgPSBlMS5pb3ZhLA0K
PisgICAgICAgIC5hZGRyX21hc2sgPSAweGZmZlVMTCwNCj4rICAgICAgICAucGFzaWQgPSAyLA0K
PisgICAgICAgIC5wZXJtID0gSU9NTVVfUlcsDQo+KyAgICAgICAgLnRyYW5zbGF0ZWRfYWRkciA9
IDB4NWVlZWVlZWRVTEwsDQo+KyAgICB9Ow0KPisNCj4rICAgIEFUQyAqYXRjID0gYXRjX25ldyhw
YWdlX3NpemUgLCA0OCk7DQo+KyAgICBhdGNfY3JlYXRlX2FkZHJlc3Nfc3BhY2VfY2FjaGUoYXRj
LCBlMS5wYXNpZCk7DQo+Kw0KPisgICAgYXRjX3VwZGF0ZShhdGMsICZlMSk7DQo+KyAgICBhc3Nl
cnRfbG9va3VwX2VxdWFscyhhdGMsICZlMSwgZTEucGFzaWQsIGUxLmlvdmEpOw0KPisgICAgYXRj
X2ludmFsaWRhdGUoYXRjLCAmZTIpOyAvKiB1bmtvd24gcGFzaWQgOiBpcyBhIG5vcCovDQo+KyAg
ICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMSwgZTEucGFzaWQsIGUxLmlvdmEpOw0KPisN
Cj4rICAgIGF0Y19jcmVhdGVfYWRkcmVzc19zcGFjZV9jYWNoZShhdGMsIGUyLnBhc2lkKTsNCj4r
ICAgIGF0Y191cGRhdGUoYXRjLCAmZTIpOw0KPisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRj
LCAmZTEsIGUxLnBhc2lkLCBlMS5pb3ZhKTsNCj4rICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0
YywgJmUyLCBlMi5wYXNpZCwgZTIuaW92YSk7DQo+KyAgICBhdGNfaW52YWxpZGF0ZShhdGMsICZl
MSk7DQo+KyAgICAvKiBlMSBoYXMgYmVlbiByZW1vdmVkIGJ1dCBlMiBpcyBzdGlsbCB0aGVyZSAq
Lw0KPisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCBOVUxMLCBlMS5wYXNpZCwgZTEuaW92
YSk7DQo+KyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMiwgZTIucGFzaWQsIGUyLmlv
dmEpOw0KPisNCj4rICAgIGF0Y191cGRhdGUoYXRjLCAmZTEpOw0KPisgICAgYXNzZXJ0X2xvb2t1
cF9lcXVhbHMoYXRjLCAmZTEsIGUxLnBhc2lkLCBlMS5pb3ZhKTsNCj4rICAgIGFzc2VydF9sb29r
dXBfZXF1YWxzKGF0YywgJmUyLCBlMi5wYXNpZCwgZTIuaW92YSk7DQo+Kw0KPisgICAgYXRjX2Rl
bGV0ZV9hZGRyZXNzX3NwYWNlX2NhY2hlKGF0YywgZTIucGFzaWQpOw0KPisgICAgYXNzZXJ0X2xv
b2t1cF9lcXVhbHMoYXRjLCAmZTEsIGUxLnBhc2lkLCBlMS5pb3ZhKTsNCj4rICAgIGFzc2VydF9s
b29rdXBfZXF1YWxzKGF0YywgTlVMTCwgZTIucGFzaWQsIGUyLmlvdmEpOw0KPit9DQo+Kw0KPitz
dGF0aWMgdm9pZCB0ZXN0X2ludmFsaWRhdGVfZW50aXJlX2FkZHJlc3Nfc3BhY2Uodm9pZCkNCj4r
ew0KPisgICAgc3RhdGljIHVpbnQ2NF90IHBhZ2Vfc2l6ZSA9IDQwOTY7DQo+KyAgICBJT01NVVRM
QkVudHJ5IGUxID0gew0KPisgICAgICAgIC5pb3ZhID0gMHgxMDAwVUxMLA0KPisgICAgICAgIC5h
ZGRyX21hc2sgPSAweGZmZlVMTCwNCj4rICAgICAgICAucGFzaWQgPSAxLA0KPisgICAgICAgIC5w
ZXJtID0gSU9NTVVfUlcsDQo+KyAgICAgICAgLnRyYW5zbGF0ZWRfYWRkciA9IDB4NWVlZFVMTCwN
Cj4rICAgIH07DQo+KyAgICBJT01NVVRMQkVudHJ5IGUyID0gew0KPisgICAgICAgIC5pb3ZhID0g
MHhmZmZmZmZmZmYwMDBVTEwsDQo+KyAgICAgICAgLmFkZHJfbWFzayA9IDB4ZmZmVUxMLA0KPisg
ICAgICAgIC5wYXNpZCA9IDEsDQo+KyAgICAgICAgLnBlcm0gPSBJT01NVV9SVywNCj4rICAgICAg
ICAudHJhbnNsYXRlZF9hZGRyID0gMHhiZWVmVUxMLA0KPisgICAgfTsNCj4rICAgIElPTU1VVExC
RW50cnkgZTMgPSB7DQo+KyAgICAgICAgLmlvdmEgPSAwLA0KPisgICAgICAgIC5hZGRyX21hc2sg
PSAweGZmZmZmZmZmZmZmZmZmZmZVTEwsDQo+KyAgICAgICAgLnBhc2lkID0gMSwNCj4rICAgICAg
ICAucGVybSA9IElPTU1VX1JXLA0KPisgICAgICAgIC50cmFuc2xhdGVkX2FkZHIgPSAwLA0KPisg
ICAgfTsNCj4rDQo+KyAgICBBVEMgKmF0YyA9IGF0Y19uZXcocGFnZV9zaXplICwgNDgpOw0KPisg
ICAgYXRjX2NyZWF0ZV9hZGRyZXNzX3NwYWNlX2NhY2hlKGF0YywgZTEucGFzaWQpOw0KPisNCj4r
ICAgIGF0Y191cGRhdGUoYXRjLCAmZTEpOw0KPisgICAgYXRjX3VwZGF0ZShhdGMsICZlMik7DQo+
KyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMSwgZTEucGFzaWQsIGUxLmlvdmEpOw0K
PisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCAmZTIsIGUyLnBhc2lkLCBlMi5pb3ZhKTsN
Cj4rICAgIGF0Y19pbnZhbGlkYXRlKGF0YywgJmUzKTsNCj4rICAgIC8qIGUxIGhhcyBiZWVuIHJl
bW92ZWQgYnV0IGUyIGlzIHN0aWxsIHRoZXJlICovDQo+KyAgICBhc3NlcnRfbG9va3VwX2VxdWFs
cyhhdGMsIE5VTEwsIGUxLnBhc2lkLCBlMS5pb3ZhKTsNCj4rICAgIGFzc2VydF9sb29rdXBfZXF1
YWxzKGF0YywgTlVMTCwgZTIucGFzaWQsIGUyLmlvdmEpOw0KPisNCj4rICAgIGF0Y19kZXN0cm95
KGF0Yyk7DQo+K30NCj4rDQo+K3N0YXRpYyB2b2lkIHRlc3RfcmVzZXQodm9pZCkNCj4rew0KPisg
ICAgc3RhdGljIHVpbnQ2NF90IHBhZ2Vfc2l6ZSA9IDQwOTY7DQo+KyAgICBJT01NVVRMQkVudHJ5
IGUxID0gew0KPisgICAgICAgIC5pb3ZhID0gMHgxMDAwVUxMLA0KPisgICAgICAgIC5hZGRyX21h
c2sgPSAweGZmZlVMTCwNCj4rICAgICAgICAucGFzaWQgPSAxLA0KPisgICAgICAgIC5wZXJtID0g
SU9NTVVfUlcsDQo+KyAgICAgICAgLnRyYW5zbGF0ZWRfYWRkciA9IDB4NWVlZFVMTCwNCj4rICAg
IH07DQo+KyAgICBJT01NVVRMQkVudHJ5IGUyID0gew0KPisgICAgICAgIC5pb3ZhID0gMHhmZmZm
ZmZmZmYwMDBVTEwsDQo+KyAgICAgICAgLmFkZHJfbWFzayA9IDB4ZmZmVUxMLA0KPisgICAgICAg
IC5wYXNpZCA9IDIsDQo+KyAgICAgICAgLnBlcm0gPSBJT01NVV9SVywNCj4rICAgICAgICAudHJh
bnNsYXRlZF9hZGRyID0gMHhiZWVmVUxMLA0KPisgICAgfTsNCj4rDQo+KyAgICBBVEMgKmF0YyA9
IGF0Y19uZXcocGFnZV9zaXplICwgNDgpOw0KPisgICAgYXRjX2NyZWF0ZV9hZGRyZXNzX3NwYWNl
X2NhY2hlKGF0YywgZTEucGFzaWQpOw0KPisgICAgYXRjX2NyZWF0ZV9hZGRyZXNzX3NwYWNlX2Nh
Y2hlKGF0YywgZTIucGFzaWQpOw0KPisgICAgYXRjX3VwZGF0ZShhdGMsICZlMSk7DQo+KyAgICBh
dGNfdXBkYXRlKGF0YywgJmUyKTsNCj4rDQo+KyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMs
ICZlMSwgZTEucGFzaWQsIGUxLmlvdmEpOw0KPisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRj
LCAmZTIsIGUyLnBhc2lkLCBlMi5pb3ZhKTsNCj4rDQo+KyAgICBhdGNfcmVzZXQoYXRjKTsNCj4r
DQo+KyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5VTEwsIGUxLnBhc2lkLCBlMS5pb3Zh
KTsNCj4rICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgTlVMTCwgZTIucGFzaWQsIGUyLmlv
dmEpOw0KPit9DQo+Kw0KPitzdGF0aWMgdm9pZCB0ZXN0X2dldF9tYXhfbnVtYmVyX29mX3BhZ2Vz
KHZvaWQpDQo+K3sNCj4rICAgIHN0YXRpYyB1aW50NjRfdCBwYWdlX3NpemUgPSA0MDk2Ow0KPisg
ICAgaHdhZGRyIGJhc2UgPSAweGMwZmVlMDAwOyAvKiBhbGlnbmVkICovDQo+KyAgICBBVEMgKmF0
YyA9IGF0Y19uZXcocGFnZV9zaXplICwgNDgpOw0KPisgICAgZ19hc3NlcnQoYXRjX2dldF9tYXhf
bnVtYmVyX29mX3BhZ2VzKGF0YywgYmFzZSwgcGFnZV9zaXplIC8gMikgPT0gMSk7DQo+KyAgICBn
X2Fzc2VydChhdGNfZ2V0X21heF9udW1iZXJfb2ZfcGFnZXMoYXRjLCBiYXNlLCBwYWdlX3NpemUp
ID09IDEpOw0KPisgICAgZ19hc3NlcnQoYXRjX2dldF9tYXhfbnVtYmVyX29mX3BhZ2VzKGF0Yywg
YmFzZSwgcGFnZV9zaXplICsgMSkgPT0gMik7DQo+Kw0KPisgICAgZ19hc3NlcnQoYXRjX2dldF9t
YXhfbnVtYmVyX29mX3BhZ2VzKGF0YywgYmFzZSArIDEwLCAxKSA9PSAxKTsNCj4rICAgIGdfYXNz
ZXJ0KGF0Y19nZXRfbWF4X251bWJlcl9vZl9wYWdlcyhhdGMsIGJhc2UgKyAxMCwgcGFnZV9zaXpl
IC0gMTApDQo+PT0gMSk7DQo+KyAgICBnX2Fzc2VydChhdGNfZ2V0X21heF9udW1iZXJfb2ZfcGFn
ZXMoYXRjLCBiYXNlICsgMTAsDQo+KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcGFnZV9zaXplIC0gMTAgKyAxKSA9PSAyKTsNCj4rICAgIGdfYXNzZXJ0KGF0Y19nZXRf
bWF4X251bWJlcl9vZl9wYWdlcyhhdGMsIGJhc2UgKyAxMCwNCj4rICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBwYWdlX3NpemUgLSAxMCArIDIpID09IDIpOw0KPisNCj4r
ICAgIGdfYXNzZXJ0KGF0Y19nZXRfbWF4X251bWJlcl9vZl9wYWdlcyhhdGMsIGJhc2UgKyBwYWdl
X3NpemUgLSAxLCAxKSA9PQ0KPjEpOw0KPisgICAgZ19hc3NlcnQoYXRjX2dldF9tYXhfbnVtYmVy
X29mX3BhZ2VzKGF0YywgYmFzZSArIHBhZ2Vfc2l6ZSAtIDEsIDIpID09DQo+Mik7DQo+KyAgICBn
X2Fzc2VydChhdGNfZ2V0X21heF9udW1iZXJfb2ZfcGFnZXMoYXRjLCBiYXNlICsgcGFnZV9zaXpl
IC0gMSwgMykgPT0NCj4yKTsNCj4rDQo+KyAgICBnX2Fzc2VydChhdGNfZ2V0X21heF9udW1iZXJf
b2ZfcGFnZXMoYXRjLCBiYXNlICsgMTAsIHBhZ2Vfc2l6ZSAqIDIwKQ0KPj09IDIxKTsNCj4rICAg
IGdfYXNzZXJ0KGF0Y19nZXRfbWF4X251bWJlcl9vZl9wYWdlcyhhdGMsIGJhc2UgKyAxMCwNCj4r
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocGFnZV9zaXplICogMjAp
ICsgKHBhZ2Vfc2l6ZSAtIDEwKSkNCj4rICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgPT0gMjEpOw0KPisgICAgZ19hc3NlcnQoYXRjX2dldF9tYXhfbnVtYmVyX29mX3Bh
Z2VzKGF0YywgYmFzZSArIDEwLA0KPisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIChwYWdlX3NpemUgKiAyMCkgKw0KPisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIChwYWdlX3NpemUgLSAxMCArIDEpKSA9PSAyMik7DQo+K30NCj4rDQo+K2lu
dCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikNCj4rew0KPisgICAgZ190ZXN0X2luaXQoJmFy
Z2MsICZhcmd2LCBOVUxMKTsNCj4rICAgIGdfdGVzdF9hZGRfZnVuYygiL2F0Yy90ZXN0X2NyZWF0
aW9uX3BhcmFtZXRlcnMiLA0KPnRlc3RfY3JlYXRpb25fcGFyYW1ldGVycyk7DQo+KyAgICBnX3Rl
c3RfYWRkX2Z1bmMoIi9hdGMvdGVzdF9zaW5nbGVfZW50cnkiLCB0ZXN0X3NpbmdsZV9lbnRyeSk7
DQo+KyAgICBnX3Rlc3RfYWRkX2Z1bmMoIi9hdGMvdGVzdF9wYWdlX2JvdW5kYXJpZXMiLCB0ZXN0
X3BhZ2VfYm91bmRhcmllcyk7DQo+KyAgICBnX3Rlc3RfYWRkX2Z1bmMoIi9hdGMvdGVzdF9odWdl
X3BhZ2UiLCB0ZXN0X2h1Z2VfcGFnZSk7DQo+KyAgICBnX3Rlc3RfYWRkX2Z1bmMoIi9hdGMvdGVz
dF9wYXNpZCIsIHRlc3RfcGFzaWQpOw0KPisgICAgZ190ZXN0X2FkZF9mdW5jKCIvYXRjL3Rlc3Rf
bGFyZ2VfYWRkcmVzcyIsIHRlc3RfbGFyZ2VfYWRkcmVzcyk7DQo+KyAgICBnX3Rlc3RfYWRkX2Z1
bmMoIi9hdGMvdGVzdF9iaWdnZXJfcGFnZSIsIHRlc3RfYmlnZ2VyX3BhZ2UpOw0KPisgICAgZ190
ZXN0X2FkZF9mdW5jKCIvYXRjL3Rlc3RfdW5rbm93bl9wYXNpZCIsIHRlc3RfdW5rbm93bl9wYXNp
ZCk7DQo+KyAgICBnX3Rlc3RfYWRkX2Z1bmMoIi9hdGMvdGVzdF9pbnZhbGlkYXRpb24iLCB0ZXN0
X2ludmFsaWRhdGlvbik7DQo+KyAgICBnX3Rlc3RfYWRkX2Z1bmMoIi9hdGMvdGVzdF9kZWxldGVf
YWRkcmVzc19zcGFjZV9jYWNoZSIsDQo+KyAgICAgICAgICAgICAgICAgICAgdGVzdF9kZWxldGVf
YWRkcmVzc19zcGFjZV9jYWNoZSk7DQo+KyAgICBnX3Rlc3RfYWRkX2Z1bmMoIi9hdGMvdGVzdF9p
bnZhbGlkYXRlX2VudGlyZV9hZGRyZXNzX3NwYWNlIiwNCj4rICAgICAgICAgICAgICAgICAgICB0
ZXN0X2ludmFsaWRhdGVfZW50aXJlX2FkZHJlc3Nfc3BhY2UpOw0KPisgICAgZ190ZXN0X2FkZF9m
dW5jKCIvYXRjL3Rlc3RfcmVzZXQiLCB0ZXN0X3Jlc2V0KTsNCj4rICAgIGdfdGVzdF9hZGRfZnVu
YygiL2F0Yy90ZXN0X2dldF9tYXhfbnVtYmVyX29mX3BhZ2VzIiwNCj4rICAgICAgICAgICAgICAg
ICAgICB0ZXN0X2dldF9tYXhfbnVtYmVyX29mX3BhZ2VzKTsNCj4rICAgIHJldHVybiBnX3Rlc3Rf
cnVuKCk7DQo+K30NCj5kaWZmIC0tZ2l0IGEvdXRpbC9hdGMuYyBiL3V0aWwvYXRjLmMNCj5uZXcg
ZmlsZSBtb2RlIDEwMDY0NA0KPmluZGV4IDAwMDAwMDAwMDAuLmQ5NTE1MzJlMjYNCj4tLS0gL2Rl
di9udWxsDQo+KysrIGIvdXRpbC9hdGMuYw0KPkBAIC0wLDAgKzEsMjExIEBADQo+Ky8qDQo+KyAq
IFFFTVUgZW11bGF0aW9uIG9mIGFuIEFUQw0KPisgKg0KPisgKiBUaGlzIHByb2dyYW0gaXMgZnJl
ZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQ0KPisgKiBp
dCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1
Ymxpc2hlZCBieQ0KPisgKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVy
c2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcg0KPisgKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRl
ciB2ZXJzaW9uLg0KPisNCj4rICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBo
b3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQo+KyAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5U
WTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mDQo+KyAqIE1FUkNIQU5UQUJJ
TElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUNCj4rICog
R05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4NCj4rDQo+KyAqIFlv
dSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBM
aWNlbnNlIGFsb25nDQo+KyAqIHdpdGggdGhpcyBwcm9ncmFtOyBpZiBub3QsIHNlZSA8aHR0cDov
L3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uDQo+KyAqLw0KPisNCj4rI2luY2x1ZGUgInV0aWwvYXRj
LmgiDQo+Kw0KPisNCj4rI2RlZmluZSBQQUdFX1RBQkxFX0VOVFJZX1NJWkUgOA0KPisNCj4rLyog
YSBwYXNpZCBpcyBoYXNoZWQgdXNpbmcgdGhlIGlkZW50aXR5IGZ1bmN0aW9uICovDQo+K3N0YXRp
YyBndWludCBhdGNfcGFzaWRfa2V5X2hhc2goZ2NvbnN0cG9pbnRlciB2KQ0KPit7DQo+KyAgICBy
ZXR1cm4gKGd1aW50KSh1aW50cHRyX3QpdjsgLyogcGFzaWQgKi8NCj4rfQ0KPisNCj4rLyogcGFz
aWQgZXF1YWxpdHkgKi8NCj4rc3RhdGljIGdib29sZWFuIGF0Y19wYXNpZF9rZXlfZXF1YWwoZ2Nv
bnN0cG9pbnRlciB2MSwgZ2NvbnN0cG9pbnRlciB2MikNCj4rew0KPisgICAgcmV0dXJuIHYxID09
IHYyOw0KPit9DQo+Kw0KPisvKiBIYXNoIGZ1bmN0aW9uIGZvciBJT1RMQiBlbnRyaWVzICovDQo+
K3N0YXRpYyBndWludCBhdGNfYWRkcl9rZXlfaGFzaChnY29uc3Rwb2ludGVyIHYpDQo+K3sNCj4r
ICAgIGh3YWRkciBhZGRyID0gKGh3YWRkcil2Ow0KPisgICAgcmV0dXJuIChndWludCkoKGFkZHIg
Pj4gMzIpIF4gKGFkZHIgJiAweGZmZmZmZmZmVSkpOw0KPit9DQo+Kw0KPisvKiBFcXVhbGl0eSB0
ZXN0IGZvciBJT1RMQiBlbnRyaWVzICovDQo+K3N0YXRpYyBnYm9vbGVhbiBhdGNfYWRkcl9rZXlf
ZXF1YWwoZ2NvbnN0cG9pbnRlciB2MSwgZ2NvbnN0cG9pbnRlciB2MikNCj4rew0KPisgICAgcmV0
dXJuIChod2FkZHIpdjEgPT0gKGh3YWRkcil2MjsNCj4rfQ0KPisNCj4rc3RhdGljIHZvaWQgYXRj
X2FkZHJlc3Nfc3BhY2VfZnJlZSh2b2lkICphcykNCj4rew0KPisgICAgZ19oYXNoX3RhYmxlX3Vu
cmVmKGFzKTsNCj4rfQ0KPisNCj4rLyogcmV0dXJuIGxvZzIodmFsKSwgb3IgVUlOVDhfTUFYIGlm
IHZhbCBpcyBub3QgYSBwb3dlciBvZiAyICovDQo+K3N0YXRpYyB1aW50OF90IGlsb2cyKHVpbnQ2
NF90IHZhbCkNCj4rew0KPisgICAgdWludDhfdCByZXN1bHQgPSAwOw0KPisgICAgd2hpbGUgKHZh
bCAhPSAxKSB7DQo+KyAgICAgICAgaWYgKHZhbCAmIDEpIHsNCj4rICAgICAgICAgICAgcmV0dXJu
IFVJTlQ4X01BWDsNCj4rICAgICAgICB9DQo+Kw0KPisgICAgICAgIHZhbCA+Pj0gMTsNCj4rICAg
ICAgICByZXN1bHQgKz0gMTsNCj4rICAgIH0NCj4rICAgIHJldHVybiByZXN1bHQ7DQo+K30NCj4r
DQo+K0FUQyAqYXRjX25ldyh1aW50NjRfdCBwYWdlX3NpemUsIHVpbnQ4X3QgYWRkcmVzc193aWR0
aCkNCj4rew0KPisgICAgQVRDICphdGM7DQo+KyAgICB1aW50OF90IGxvZ19wYWdlX3NpemUgPSBp
bG9nMihwYWdlX3NpemUpOw0KPisgICAgLyogbnVtYmVyIG9mIGJpdHMgZWFjaCB1c2VkIHRvIHN0
b3JlIGFsbCB0aGUgaW50ZXJtZWRpYXRlIGluZGV4ZXMgKi8NCj4rICAgIHVpbnQ2NF90IGFkZHJf
bG9va3VwX2luZGV4ZXNfc2l6ZTsNCj4rDQo+KyAgICBpZiAobG9nX3BhZ2Vfc2l6ZSA9PSBVSU5U
OF9NQVgpIHsNCj4rICAgICAgICByZXR1cm4gTlVMTDsNCj4rICAgIH0NCj4rICAgIC8qDQo+KyAg
ICAgKiBXZSBvbmx5IHN1cHBvcnQgcGFnZSB0YWJsZSBlbnRyaWVzIG9mIDggKFBBR0VfVEFCTEVf
RU5UUllfU0laRSkNCj5ieXRlcw0KPisgICAgICogbG9nMihwYWdlX3NpemUgLyA4KSA9IGxvZzIo
cGFnZV9zaXplKSAtIDMNCj4rICAgICAqIGlzIHRoZSBsZXZlbCBvZmZzZXQNCj4rICAgICAqLw0K
PisgICAgaWYgKGxvZ19wYWdlX3NpemUgPD0gMykgew0KPisgICAgICAgIHJldHVybiBOVUxMOw0K
PisgICAgfQ0KPisNCj4rICAgIGF0YyA9IGdfbmV3MChBVEMsIDEpOw0KPisgICAgYXRjLT5hZGRy
ZXNzX3NwYWNlcyA9IGdfaGFzaF90YWJsZV9uZXdfZnVsbChhdGNfcGFzaWRfa2V5X2hhc2gsDQo+
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0Y19wYXNp
ZF9rZXlfZXF1YWwsDQo+KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIE5VTEwsIGF0Y19hZGRyZXNzX3NwYWNlX2ZyZWUpOw0KPisgICAgYXRjLT5sZXZlbF9v
ZmZzZXQgPSBsb2dfcGFnZV9zaXplIC0gMzsNCj4rICAgIC8qIGF0IHRoaXMgcG9pbnQsIHdlIGtu
b3cgdGhhdCBwYWdlX3NpemUgaXMgYSBwb3dlciBvZiAyICovDQo+KyAgICBhdGMtPm1pbl9hZGRy
X21hc2sgPSBwYWdlX3NpemUgLSAxOw0KPisgICAgYWRkcl9sb29rdXBfaW5kZXhlc19zaXplID0g
YWRkcmVzc193aWR0aCAtIGxvZ19wYWdlX3NpemU7DQo+KyAgICBpZiAoKGFkZHJfbG9va3VwX2lu
ZGV4ZXNfc2l6ZSAlIGF0Yy0+bGV2ZWxfb2Zmc2V0KSAhPSAwKSB7DQo+KyAgICAgICAgZ290byBl
cnJvcjsNCj4rICAgIH0NCj4rICAgIGF0Yy0+bGV2ZWxzID0gYWRkcl9sb29rdXBfaW5kZXhlc19z
aXplIC8gYXRjLT5sZXZlbF9vZmZzZXQ7DQo+KyAgICBhdGMtPnBhZ2Vfc2l6ZSA9IHBhZ2Vfc2l6
ZTsNCj4rICAgIHJldHVybiBhdGM7DQo+Kw0KPitlcnJvcjoNCj4rICAgIGdfZnJlZShhdGMpOw0K
PisgICAgcmV0dXJuIE5VTEw7DQo+K30NCj4rDQo+K3N0YXRpYyBpbmxpbmUgR0hhc2hUYWJsZSAq
YXRjX2dldF9hZGRyZXNzX3NwYWNlX2NhY2hlKEFUQyAqYXRjLCB1aW50MzJfdA0KPnBhc2lkKQ0K
Pit7DQo+KyAgICByZXR1cm4gZ19oYXNoX3RhYmxlX2xvb2t1cChhdGMtPmFkZHJlc3Nfc3BhY2Vz
LA0KPisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGdjb25zdHBvaW50ZXIpKHVpbnRw
dHJfdClwYXNpZCk7DQo+K30NCj4rDQo+K3ZvaWQgYXRjX2NyZWF0ZV9hZGRyZXNzX3NwYWNlX2Nh
Y2hlKEFUQyAqYXRjLCB1aW50MzJfdCBwYXNpZCkNCj4rew0KPisgICAgR0hhc2hUYWJsZSAqYXNf
Y2FjaGU7DQo+Kw0KPisgICAgYXNfY2FjaGUgPSBhdGNfZ2V0X2FkZHJlc3Nfc3BhY2VfY2FjaGUo
YXRjLCBwYXNpZCk7DQo+KyAgICBpZiAoIWFzX2NhY2hlKSB7DQo+KyAgICAgICAgYXNfY2FjaGUg
PSBnX2hhc2hfdGFibGVfbmV3X2Z1bGwoYXRjX2FkZHJfa2V5X2hhc2gsDQo+KyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRjX2FkZHJfa2V5X2VxdWFsLA0KPisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwsIGdfZnJlZSk7DQo+KyAg
ICAgICAgZ19oYXNoX3RhYmxlX3JlcGxhY2UoYXRjLT5hZGRyZXNzX3NwYWNlcywNCj4rICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAoZ3BvaW50ZXIpKHVpbnRwdHJfdClwYXNpZCwgYXNfY2Fj
aGUpOw0KPisgICAgfQ0KPit9DQo+Kw0KPit2b2lkIGF0Y19kZWxldGVfYWRkcmVzc19zcGFjZV9j
YWNoZShBVEMgKmF0YywgdWludDMyX3QgcGFzaWQpDQo+K3sNCj4rICAgIGdfaGFzaF90YWJsZV9y
ZW1vdmUoYXRjLT5hZGRyZXNzX3NwYWNlcywgKGdwb2ludGVyKSh1aW50cHRyX3QpcGFzaWQpOw0K
Pit9DQo+Kw0KPitpbnQgYXRjX3VwZGF0ZShBVEMgKmF0YywgSU9NTVVUTEJFbnRyeSAqZW50cnkp
DQo+K3sNCj4rICAgIElPTU1VVExCRW50cnkgKnZhbHVlOw0KPisgICAgR0hhc2hUYWJsZSAqYXNf
Y2FjaGUgPSBhdGNfZ2V0X2FkZHJlc3Nfc3BhY2VfY2FjaGUoYXRjLCBlbnRyeS0NCj4+cGFzaWQp
Ow0KPisgICAgaWYgKCFhc19jYWNoZSkgew0KPisgICAgICAgIHJldHVybiAtRU5PREVWOw0KPisg
ICAgfQ0KPisgICAgdmFsdWUgPSBnX21lbWR1cDIoZW50cnksIHNpemVvZigqdmFsdWUpKTsNCj4r
ICAgIGdfaGFzaF90YWJsZV9yZXBsYWNlKGFzX2NhY2hlLCAoZ3BvaW50ZXIpKGVudHJ5LT5pb3Zh
KSwgdmFsdWUpOw0KPisgICAgcmV0dXJuIDA7DQo+K30NCj4rDQo+K0lPTU1VVExCRW50cnkgKmF0
Y19sb29rdXAoQVRDICphdGMsIHVpbnQzMl90IHBhc2lkLCBod2FkZHIgYWRkcikNCj4rew0KPisg
ICAgSU9NTVVUTEJFbnRyeSAqZW50cnk7DQo+KyAgICBod2FkZHIgbWFzayA9IGF0Yy0+bWluX2Fk
ZHJfbWFzazsNCj4rICAgIGh3YWRkciBrZXkgPSBhZGRyICYgKH5tYXNrKTsNCj4rICAgIEdIYXNo
VGFibGUgKmFzX2NhY2hlID0gYXRjX2dldF9hZGRyZXNzX3NwYWNlX2NhY2hlKGF0YywgcGFzaWQp
Ow0KPisNCj4rICAgIGlmICghYXNfY2FjaGUpIHsNCj4rICAgICAgICByZXR1cm4gTlVMTDsNCj4r
ICAgIH0NCj4rDQo+KyAgICAvKg0KPisgICAgICogSXRlcmF0ZSBvdmVyIHRoZSBwb3NzaWJsZSBw
YWdlIHNpemVzIGFuZCB0cnkgdG8gZmluZCBhIGhpdA0KPisgICAgKi8NCj4rICAgIGZvciAodWlu
dDhfdCBsZXZlbCA9IDA7IGxldmVsIDwgYXRjLT5sZXZlbHM7ICsrbGV2ZWwpIHsNCj4rICAgICAg
ICBlbnRyeSA9IGdfaGFzaF90YWJsZV9sb29rdXAoYXNfY2FjaGUsIChnY29uc3Rwb2ludGVyKWtl
eSk7DQo+KyAgICAgICAgaWYgKGVudHJ5KSB7DQo+KyAgICAgICAgICAgIHJldHVybiBlbnRyeTsN
Cj4rICAgICAgICB9DQo+KyAgICAgICAgbWFzayA9IChtYXNrIDw8IGF0Yy0+bGV2ZWxfb2Zmc2V0
KSB8ICgoMSA8PCBhdGMtPmxldmVsX29mZnNldCkgLSAxKTsNCj4rICAgICAgICBrZXkgPSBhZGRy
ICYgKH5tYXNrKTsNCj4rICAgIH0NCj4rDQo+KyAgICByZXR1cm4gTlVMTDsNCj4rfQ0KPisNCj4r
c3RhdGljIGdib29sZWFuIGF0Y19pbnZhbGlkYXRlX2VudHJ5X3ByZWRpY2F0ZShncG9pbnRlciBr
ZXksIGdwb2ludGVyDQo+dmFsdWUsDQo+KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZ3BvaW50ZXIgdXNlcl9kYXRhKQ0KPit7DQo+KyAgICBJT01NVVRMQkVu
dHJ5ICplbnRyeSA9IChJT01NVVRMQkVudHJ5ICopdmFsdWU7DQo+KyAgICBJT01NVVRMQkVudHJ5
ICp0YXJnZXQgPSAoSU9NTVVUTEJFbnRyeSAqKXVzZXJfZGF0YTsNCj4rICAgIGh3YWRkciB0YXJn
ZXRfbWFzayA9IH50YXJnZXQtPmFkZHJfbWFzazsNCj4rICAgIGh3YWRkciBlbnRyeV9tYXNrID0g
fmVudHJ5LT5hZGRyX21hc2s7DQo+KyAgICByZXR1cm4gKCh0YXJnZXQtPmlvdmEgJiB0YXJnZXRf
bWFzaykgPT0gKGVudHJ5LT5pb3ZhICYgdGFyZ2V0X21hc2spKSB8fA0KPisgICAgICAgICAgICgo
dGFyZ2V0LT5pb3ZhICYgZW50cnlfbWFzaykgPT0gKGVudHJ5LT5pb3ZhICYgZW50cnlfbWFzaykp
Ow0KPit9DQo+Kw0KPit2b2lkIGF0Y19pbnZhbGlkYXRlKEFUQyAqYXRjLCBJT01NVVRMQkVudHJ5
ICplbnRyeSkNCj4rew0KPisgICAgR0hhc2hUYWJsZSAqYXNfY2FjaGUgPSBhdGNfZ2V0X2FkZHJl
c3Nfc3BhY2VfY2FjaGUoYXRjLCBlbnRyeS0NCj4+cGFzaWQpOw0KPisgICAgaWYgKCFhc19jYWNo
ZSkgew0KPisgICAgICAgIHJldHVybjsNCj4rICAgIH0NCj4rICAgIGdfaGFzaF90YWJsZV9mb3Jl
YWNoX3JlbW92ZShhc19jYWNoZSwNCj4rICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBh
dGNfaW52YWxpZGF0ZV9lbnRyeV9wcmVkaWNhdGUsDQo+KyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZW50cnkpOw0KPit9DQo+Kw0KPit2b2lkIGF0Y19kZXN0cm95KEFUQyAqYXRjKQ0K
Pit7DQo+KyAgICBnX2hhc2hfdGFibGVfdW5yZWYoYXRjLT5hZGRyZXNzX3NwYWNlcyk7DQo+K30N
Cj4rDQo+K3NpemVfdCBhdGNfZ2V0X21heF9udW1iZXJfb2ZfcGFnZXMoQVRDICphdGMsIGh3YWRk
ciBhZGRyLCBzaXplX3QNCj5sZW5ndGgpDQo+K3sNCj4rICAgIGh3YWRkciBwYWdlX21hc2sgPSB+
KGF0Yy0+bWluX2FkZHJfbWFzayk7DQo+KyAgICBzaXplX3QgcmVzdWx0ID0gKGxlbmd0aCAvIGF0
Yy0+cGFnZV9zaXplKTsNCj4rICAgIGlmICgoKChhZGRyICYgcGFnZV9tYXNrKSArIGxlbmd0aCAt
IDEpICYgcGFnZV9tYXNrKSAhPQ0KPisgICAgICAgICgoYWRkciArIGxlbmd0aCAtIDEpICYgcGFn
ZV9tYXNrKSkgew0KPisgICAgICAgIHJlc3VsdCArPSAxOw0KPisgICAgfQ0KPisgICAgcmV0dXJu
IHJlc3VsdCArIChsZW5ndGggJSBhdGMtPnBhZ2Vfc2l6ZSAhPSAwID8gMSA6IDApOw0KPit9DQo+
Kw0KPit2b2lkIGF0Y19yZXNldChBVEMgKmF0YykNCj4rew0KPisgICAgZ19oYXNoX3RhYmxlX3Jl
bW92ZV9hbGwoYXRjLT5hZGRyZXNzX3NwYWNlcyk7DQo+K30NCj5kaWZmIC0tZ2l0IGEvdXRpbC9h
dGMuaCBiL3V0aWwvYXRjLmgNCj5uZXcgZmlsZSBtb2RlIDEwMDY0NA0KPmluZGV4IDAwMDAwMDAw
MDAuLjhiZTk1ZjVjY2ENCj4tLS0gL2Rldi9udWxsDQo+KysrIGIvdXRpbC9hdGMuaA0KPkBAIC0w
LDAgKzEsMTE3IEBADQo+Ky8qDQo+KyAqIFFFTVUgZW11bGF0aW9uIG9mIGFuIEFUQw0KPisgKg0K
PisgKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUg
aXQgYW5kL29yIG1vZGlmeQ0KPisgKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5l
cmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQ0KPisgKiB0aGUgRnJlZSBTb2Z0d2Fy
ZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcg0KPisgKiAo
YXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLg0KPisNCj4rICogVGhpcyBwcm9ncmFt
IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQo+KyAq
IGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJh
bnR5IG9mDQo+KyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIg
UFVSUE9TRS4gIFNlZSB0aGUNCj4rICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1v
cmUgZGV0YWlscy4NCj4rDQo+KyAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2Yg
dGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFsb25nDQo+KyAqIHdpdGggdGhpcyBwcm9n
cmFtOyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uDQo+KyAqLw0K
PisNCj4rI2lmbmRlZiBVVElMX0FUQ19IDQo+KyNkZWZpbmUgVVRJTF9BVENfSA0KPisNCj4rI2lu
Y2x1ZGUgInFlbXUvb3NkZXAuaCINCj4rI2luY2x1ZGUgImV4ZWMvbWVtb3J5LmgiDQo+Kw0KPit0
eXBlZGVmIHN0cnVjdCBBVEMgew0KPisgICAgR0hhc2hUYWJsZSAqYWRkcmVzc19zcGFjZXM7IC8q
IEtleSA6IHBhc2lkLCB2YWx1ZSA6IEdIYXNoVGFibGUgKi8NCj4rICAgIGh3YWRkciBtaW5fYWRk
cl9tYXNrOw0KPisgICAgdWludDY0X3QgcGFnZV9zaXplOw0KPisgICAgdWludDhfdCBsZXZlbHM7
DQo+KyAgICB1aW50OF90IGxldmVsX29mZnNldDsNCj4rfSBBVEM7DQo+Kw0KPisvKg0KPisgKiBh
dGNfbmV3OiBDcmVhdGUgYW4gQVRDLg0KPisgKg0KPisgKiBSZXR1cm4gYW4gQVRDIG9yIE5VTEwg
aWYgdGhlIGNyZWF0aW9uIGZhaWxlZA0KPisgKg0KPisgKiBAcGFnZV9zaXplOiAjUENJRGV2aWNl
IGRvaW5nIHRoZSBtZW1vcnkgYWNjZXNzDQo+KyAqIEBhZGRyZXNzX3dpZHRoOiB3aWR0aCBvZiB0
aGUgdmlydHVhbCBhZGRyZXNzZXMgdXNlZCBieSB0aGUgSU9NTVUgKGluDQo+Yml0cykNCj4rICov
DQo+K0FUQyAqYXRjX25ldyh1aW50NjRfdCBwYWdlX3NpemUsIHVpbnQ4X3QgYWRkcmVzc193aWR0
aCk7DQo+Kw0KPisvKg0KPisgKiBhdGNfdXBkYXRlOiBJbnNlcnQgb3IgdXBkYXRlIGFuIGVudHJ5
IGluIHRoZSBjYWNoZQ0KPisgKg0KPisgKiBSZXR1cm4gMCBpZiB0aGUgb3BlcmF0aW9uIHN1Y2Nl
ZWRzLCBhIG5lZ2F0aXZlIGVycm9yIGNvZGUgb3RoZXJ3aXNlDQo+KyAqDQo+KyAqIFRoZSBpbnNl
cnRpb24gd2lsbCBmYWlsIGlmIHRoZSBhZGRyZXNzIHNwYWNlIGFzc29jaWF0ZWQgd2l0aCB0aGlz
IHBhc2lkDQo+KyAqIGhhcyBub3QgYmVlbiBjcmVhdGVkIHdpdGggYXRjX2NyZWF0ZV9hZGRyZXNz
X3NwYWNlX2NhY2hlDQo+KyAqDQo+KyAqIEBhdGM6IHRoZSBBVEMgdG8gdXBkYXRlDQo+KyAqIEBl
bnRyeTogdGhlIHRsYiBlbnRyeSB0byBpbnNlcnQgaW50byB0aGUgY2FjaGUNCj4rICovDQo+K2lu
dCBhdGNfdXBkYXRlKEFUQyAqYXRjLCBJT01NVVRMQkVudHJ5ICplbnRyeSk7DQo+Kw0KPisvKg0K
PisgKiBhdGNfY3JlYXRlX2FkZHJlc3Nfc3BhY2VfY2FjaGU6IGRlbGFyZSBhIG5ldyBhZGRyZXNz
IHNwYWNlDQo+KyAqIGlkZW50aWZpZWQgYnkgYSBQQVNJRA0KPisgKg0KPisgKiBAYXRjOiB0aGUg
QVRDIHRvIHVwZGF0ZQ0KPisgKiBAcGFzaWQ6IHRoZSBwYXNpZCBvZiB0aGUgYWRkcmVzcyBzcGFj
ZSB0byBiZSBjcmVhdGVkDQo+KyAqLw0KPit2b2lkIGF0Y19jcmVhdGVfYWRkcmVzc19zcGFjZV9j
YWNoZShBVEMgKmF0YywgdWludDMyX3QgcGFzaWQpOw0KPisNCj4rLyoNCj4rICogYXRjX2RlbGV0
ZV9hZGRyZXNzX3NwYWNlX2NhY2hlOiBkZWxldGUgYW4gYWRkcmVzcyBzcGFjZQ0KPisgKiBpZGVu
dGlmaWVkIGJ5IGEgUEFTSUQNCj4rICoNCj4rICogQGF0YzogdGhlIEFUQyB0byB1cGRhdGUNCj4r
ICogQHBhc2lkOiB0aGUgcGFzaWQgb2YgdGhlIGFkZHJlc3Mgc3BhY2UgdG8gYmUgZGVsZXRlZA0K
PisgKi8NCj4rdm9pZCBhdGNfZGVsZXRlX2FkZHJlc3Nfc3BhY2VfY2FjaGUoQVRDICphdGMsIHVp
bnQzMl90IHBhc2lkKTsNCj4rDQo+Ky8qDQo+KyAqIGF0Y19sb29rdXA6IHF1ZXJ5IHRoZSBjYWNo
ZSBpbiBhIGdpdmVuIGFkZHJlc3Mgc3BhY2UNCj4rICoNCj4rICogQGF0YzogdGhlIEFUQyB0byBx
dWVyeQ0KPisgKiBAcGFzaWQ6IHRoZSBwYXNpZCBvZiB0aGUgYWRkcmVzcyBzcGFjZSB0byBxdWVy
eQ0KPisgKiBAYWRkcjogdGhlIHZpcnR1YWwgYWRkcmVzcyB0byB0cmFuc2xhdGUNCj4rICovDQo+
K0lPTU1VVExCRW50cnkgKmF0Y19sb29rdXAoQVRDICphdGMsIHVpbnQzMl90IHBhc2lkLCBod2Fk
ZHIgYWRkcik7DQo+Kw0KPisvKg0KPisgKiBhdGNfaW52YWxpZGF0ZTogaW52YWxpZGF0ZSBhbiBl
bnRyeSBpbiB0aGUgY2FjaGUNCj4rICoNCj4rICogQGF0YzogdGhlIEFUQyB0byB1cGRhdGUNCj4r
ICogQGVudHJ5OiB0aGUgZW50cnkgdG8gaW52YWxpZGF0ZQ0KPisgKi8NCj4rdm9pZCBhdGNfaW52
YWxpZGF0ZShBVEMgKmF0YywgSU9NTVVUTEJFbnRyeSAqZW50cnkpOw0KPisNCj4rLyoNCj4rICog
YXRjX2Rlc3Ryb3k6IGRlbGV0ZSBhbiBBVEMNCj4rICoNCj4rICogQGF0YzogdGhlIGNhY2hlIHRv
IGJlIGRlbGV0ZWQNCj4rICovDQo+K3ZvaWQgYXRjX2Rlc3Ryb3koQVRDICphdGMpOw0KPisNCj4r
LyoNCj4rICogYXRjX2dldF9tYXhfbnVtYmVyX29mX3BhZ2VzOiBnZXQgdGhlIG51bWJlciBvZiBw
YWdlcyBhIG1lbW9yeQ0KPm9wZXJhdGlvbg0KPisgKiB3aWxsIGFjY2VzcyBpZiBhbGwgdGhlIHBh
Z2VzIGNvbmNlcm5lZCBoYXZlIHRoZSBtaW5pbXVtIHNpemUuDQo+KyAqDQo+KyAqIFRoaXMgZnVu
Y3Rpb24gY2FuIGJlIHVzZWQgdG8gZGV0ZXJtaW5lIHRoZSBzaXplIG9mIHRoZSByZXN1bHQgYXJy
YXkgdG8gYmUNCj4rICogYWxsb2NhdGVkIHdoZW4gaXNzdWluZyBhbiBBVFMgcmVxdWVzdC4NCj4r
ICoNCj4rICogQGF0YzogdGhlIGNhY2hlDQo+KyAqIEBhZGRyOiBzdGFydCBhZGRyZXNzDQo+KyAq
IEBsZW5ndGg6IG51bWJlciBvZiBieXRlcyBhY2Nlc3NlZCBmcm9tIGFkZHINCj4rICovDQo+K3Np
emVfdCBhdGNfZ2V0X21heF9udW1iZXJfb2ZfcGFnZXMoQVRDICphdGMsIGh3YWRkciBhZGRyLCBz
aXplX3QNCj5sZW5ndGgpOw0KPisNCj4rLyoNCj4rICogYXRjX3Jlc2V0OiBpbnZhbGlkYXRlcyBh
bGwgdGhlIGVudHJpZXMgc3RvcmVkIGluIHRoZSBBVEMNCj4rICoNCj4rICogQGF0YzogdGhlIGNh
Y2hlDQo+KyAqLw0KPit2b2lkIGF0Y19yZXNldChBVEMgKmF0Yyk7DQo+Kw0KPisjZW5kaWYNCj5k
aWZmIC0tZ2l0IGEvdXRpbC9tZXNvbi5idWlsZCBiL3V0aWwvbWVzb24uYnVpbGQNCj5pbmRleCAw
ZWY5ODg2YmUwLi5hMmUwZTllNWQ3IDEwMDY0NA0KPi0tLSBhL3V0aWwvbWVzb24uYnVpbGQNCj4r
KysgYi91dGlsL21lc29uLmJ1aWxkDQo+QEAgLTk0LDYgKzk0LDcgQEAgaWYgaGF2ZV9ibG9jaw0K
PiAgIHV0aWxfc3MuYWRkKGZpbGVzKCdoYml0bWFwLmMnKSkNCj4gICB1dGlsX3NzLmFkZChmaWxl
cygnaGV4ZHVtcC5jJykpDQo+ICAgdXRpbF9zcy5hZGQoZmlsZXMoJ2lvdmEtdHJlZS5jJykpDQo+
KyAgdXRpbF9zcy5hZGQoZmlsZXMoJ2F0Yy5jJykpDQo+ICAgdXRpbF9zcy5hZGQoZmlsZXMoJ2lv
di5jJywgJ3VyaS5jJykpDQo+ICAgdXRpbF9zcy5hZGQoZmlsZXMoJ252ZGltbS11dGlscy5jJykp
DQo+ICAgdXRpbF9zcy5hZGQoZmlsZXMoJ2Jsb2NrLWhlbHBlcnMuYycpKQ0KPi0tDQo+Mi40NC4w
DQo=

