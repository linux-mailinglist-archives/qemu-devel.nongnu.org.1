Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 5D0CE8BC5E2
	for <lists+qemu-devel@lfdr.de>; Mon,  6 May 2024 04:44:47 +0200 (CEST)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1s3oJh-0000ZS-3f; Sun, 05 May 2024 22:43:01 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <bcain@quicinc.com>) id 1s3oJc-0000WO-Bu
 for qemu-devel@nongnu.org; Sun, 05 May 2024 22:42:56 -0400
Received: from mx0b-0031df01.pphosted.com ([205.220.180.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <bcain@quicinc.com>) id 1s3oJY-0007Wb-4S
 for qemu-devel@nongnu.org; Sun, 05 May 2024 22:42:56 -0400
Received: from pps.filterd (m0279873.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 4462TTnD015613;
 Mon, 6 May 2024 02:42:50 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=quicinc.com; h=
 from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-type:content-transfer-encoding; s=
 qcppdkim1; bh=AwI8BKmLk3xr13sNsdTF8wQa14Y75aPk0aEXf4u9OZc=; b=Cw
 avWjGYjLRr04lYeiHB4j9I3RIZPqS63lJHkpCNp+dVYN4JFWaGP7i+cK8KJKNFYK
 +J7OHIthlX9tRWjpyO/RpXQewTwooUDGx6zYzi9oz8GMGsCRvzKAcuYgo9wmJ6lw
 MIUmyH4/OSppyY2RSJmxOXrrAggrUyVQQRv4nKnS9XEHR2VLbzRBWRSsJQDqNl9H
 K0I1NivizPtHb8CW3RbqcPA6/7jphgVZEENzV+ZlFfSIva4PS3voWteQ4ZCeDF0u
 yQkPHZBoUp3r6CLQ45mklmZ6JpEPh8nJ9FtCUAjtAVXoeexb9gtlgcH34RuYK8bB
 2eQGB1nxENL9dS0K3FOA==
Received: from nalasppmta04.qualcomm.com (Global_NAT1.qualcomm.com
 [129.46.96.20])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 3xwacsjmrp-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Mon, 06 May 2024 02:42:49 +0000 (GMT)
Received: from nalasex01a.na.qualcomm.com (nalasex01a.na.qualcomm.com
 [10.47.209.196])
 by NALASPPMTA04.qualcomm.com (8.17.1.5/8.17.1.5) with ESMTPS id 4462gmAa004394
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Mon, 6 May 2024 02:42:48 GMT
Received: from hu-bcain-lv.qualcomm.com (10.49.16.6) by
 nalasex01a.na.qualcomm.com (10.47.209.196) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.2.1544.9; Sun, 5 May 2024 19:42:47 -0700
From: Brian Cain <bcain@quicinc.com>
To: <qemu-devel@nongnu.org>
CC: <bcain@quicinc.com>, <armbru@redhat.com>, <richard.henderson@linaro.org>, 
 <philmd@linaro.org>, <peter.maydell@linaro.org>,
 <quic_mathbern@quicinc.com>, <stefanha@redhat.com>, <ale@rev.ng>,
 <anjo@rev.ng>, <quic_mliebel@quicinc.com>, <ltaylorsimpson@gmail.com>
Subject: [PULL 03/15] Hexagon (target/hexagon) Enable more short-circuit
 packets (HVX)
Date: Sun, 5 May 2024 19:42:15 -0700
Message-ID: <20240506024227.3345791-4-bcain@quicinc.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20240506024227.3345791-1-bcain@quicinc.com>
References: <20240506024227.3345791-1-bcain@quicinc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-Originating-IP: [10.49.16.6]
X-ClientProxiedBy: nalasex01c.na.qualcomm.com (10.47.97.35) To
 nalasex01a.na.qualcomm.com (10.47.209.196)
X-QCInternal: smtphost
X-Proofpoint-Virus-Version: vendor=nai engine=6200 definitions=5800
 signatures=585085
X-Proofpoint-GUID: sv5NtX1M-6beCk1nngs0Oog3O8hK0d36
X-Proofpoint-ORIG-GUID: sv5NtX1M-6beCk1nngs0Oog3O8hK0d36
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1011,Hydra:6.0.650,FMLib:17.11.176.26
 definitions=2024-05-05_17,2024-05-03_02,2023-05-22_02
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 malwarescore=0 mlxscore=0
 bulkscore=0 spamscore=0 phishscore=0 impostorscore=0 clxscore=1015
 priorityscore=1501 lowpriorityscore=0 suspectscore=0 adultscore=0
 mlxlogscore=905 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.19.0-2404010003 definitions=main-2405060012
Received-SPF: pass client-ip=205.220.180.131; envelope-from=bcain@quicinc.com;
 helo=mx0b-0031df01.pphosted.com
X-Spam_score_int: -20
X-Spam_score: -2.1
X-Spam_bar: --
X-Spam_report: (-2.1 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, DKIM_VALID_EF=-0.1, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

RnJvbTogVGF5bG9yIFNpbXBzb24gPGx0YXlsb3JzaW1wc29uQGdtYWlsLmNvbT4KCkxvb2sgZm9y
IHJlYWQtYWZ0ZXItd3JpdGUgaW5zdGVhZCBvZiBvdmVybGFwIG9mIHJlYWRzIGFuZCB3cml0ZXMK
CkhWWCBpbnN0cnVjdGlvbnMgd2l0aCBoZWxwZXJzIGhhdmUgcGFzcy1ieS1yZWZlcmVuY2Ugc2Vt
YW50aWNzLCBzbwp3ZSBjaGVjayBmb3Igb3ZlcmxhcHMgb2YgcmVhZHMgYW5kIHdyaXRlcyB3aXRo
aW4gdGhlIHNhbWUgaW5zdHJ1Y3Rpb24uCgpTaWduZWQtb2ZmLWJ5OiBUYXlsb3IgU2ltcHNvbiA8
bHRheWxvcnNpbXBzb25AZ21haWwuY29tPgpSZXZpZXdlZC1ieTogQnJpYW4gQ2FpbiA8YmNhaW5A
cXVpY2luYy5jb20+Ck1lc3NhZ2UtSWQ6IDwyMDI0MDIwMTEwMzM0MC4xMTkwODEtNC1sdGF5bG9y
c2ltcHNvbkBnbWFpbC5jb20+ClNpZ25lZC1vZmYtYnk6IEJyaWFuIENhaW4gPGJjYWluQHF1aWNp
bmMuY29tPgotLS0KIHRhcmdldC9oZXhhZ29uL2dlbl9hbmFseXplX2Z1bmNzLnB5IHwgMTkgKysr
Ky0tLQogdGFyZ2V0L2hleGFnb24vaGV4X2NvbW1vbi5weSAgICAgICAgfCA0NSArKysrKysrKysr
LS0tLS0KIHRhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5jICAgICAgICAgIHwgNTggKystLS0tLS0t
LS0tLS0tLS0tLQogdGFyZ2V0L2hleGFnb24vdHJhbnNsYXRlLmggICAgICAgICAgfCA4OCArKysr
KysrKysrKysrKysrKysrKysrKy0tLS0tLQogNCBmaWxlcyBjaGFuZ2VkLCAxMTUgaW5zZXJ0aW9u
cygrKSwgOTUgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vZ2VuX2Fu
YWx5emVfZnVuY3MucHkgYi90YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jcy5weQppbmRl
eCA4OTBlNmEzYTk1Li44MWUxZDljZmEzIDEwMDc1NQotLS0gYS90YXJnZXQvaGV4YWdvbi9nZW5f
YW5hbHl6ZV9mdW5jcy5weQorKysgYi90YXJnZXQvaGV4YWdvbi9nZW5fYW5hbHl6ZV9mdW5jcy5w
eQpAQCAtNDMsNiArNDMsMTYgQEAgZGVmIGdlbl9hbmFseXplX2Z1bmMoZiwgdGFnLCByZWdzLCBp
bW1zKToKICAgICBmLndyaXRlKCJ7XG4iKQogCiAgICAgZi53cml0ZSgiICAgIEluc24gKmluc24g
R19HTlVDX1VOVVNFRCA9IGN0eC0+aW5zbjtcbiIpCisgICAgaWYgKGhleF9jb21tb24uaXNfaHZ4
X2luc24odGFnKSk6CisgICAgICAgIGlmIGhleF9jb21tb24uaGFzX2h2eF9oZWxwZXIodGFnKToK
KyAgICAgICAgICAgIGYud3JpdGUoCisgICAgICAgICAgICAgICAgIiAgICBjb25zdCBib29sIEdf
R05VQ19VTlVTRUQgaW5zbl9oYXNfaHZ4X2hlbHBlciA9IHRydWU7XG4iCisgICAgICAgICAgICAp
CisgICAgICAgICAgICBmLndyaXRlKCIgICAgY3R4X3N0YXJ0X2h2eF9pbnNuKGN0eCk7XG4iKQor
ICAgICAgICBlbHNlOgorICAgICAgICAgICAgZi53cml0ZSgKKyAgICAgICAgICAgICAgICAiICAg
IGNvbnN0IGJvb2wgR19HTlVDX1VOVVNFRCBpbnNuX2hhc19odnhfaGVscGVyID0gZmFsc2U7XG4i
CisgICAgICAgICAgICApCiAKICAgICAjIyBEZWNsYXJlIGFsbCB0aGUgcmVnaXN0ZXJzCiAgICAg
Zm9yIHJlZ25vLCByZWdpc3RlciBpbiBlbnVtZXJhdGUocmVncyk6CkBAIC02NCwxNSArNzQsNiBA
QCBkZWYgZ2VuX2FuYWx5emVfZnVuYyhmLCB0YWcsIHJlZ3MsIGltbXMpOgogICAgICAgICBpZiBy
ZWcuaXNfd3JpdHRlbigpOgogICAgICAgICAgICAgcmVnLmFuYWx5emVfd3JpdGUoZiwgdGFnLCBy
ZWdubykKIAotICAgIGhhc19nZW5lcmF0ZWRfaGVscGVyID0gbm90IGhleF9jb21tb24uc2tpcF9x
ZW11X2hlbHBlcigKLSAgICAgICAgdGFnCi0gICAgKSBhbmQgbm90IGhleF9jb21tb24uaXNfaWRl
Zl9wYXJzZXJfZW5hYmxlZCh0YWcpCi0KLSAgICAjIyBNYXJrIEhWWCBpbnN0cnVjdGlvbnMgd2l0
aCBnZW5lcmF0ZWQgaGVscGVycwotICAgIGlmIChoYXNfZ2VuZXJhdGVkX2hlbHBlciBhbmQKLSAg
ICAgICAgIkFfQ1ZJIiBpbiBoZXhfY29tbW9uLmF0dHJpYmRpY3RbdGFnXSk6Ci0gICAgICAgIGYu
d3JpdGUoIiAgICBjdHgtPmhhc19odnhfaGVscGVyID0gdHJ1ZTtcbiIpCi0KICAgICBmLndyaXRl
KCJ9XG5cbiIpCiAKIApkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFnb24vaGV4X2NvbW1vbi5weSBi
L3RhcmdldC9oZXhhZ29uL2hleF9jb21tb24ucHkKaW5kZXggMzM4MDFlNGJkNy4uOWU3ZjYxM2Uz
YyAxMDA3NTUKLS0tIGEvdGFyZ2V0L2hleGFnb24vaGV4X2NvbW1vbi5weQorKysgYi90YXJnZXQv
aGV4YWdvbi9oZXhfY29tbW9uLnB5CkBAIC0yNDEsNiArMjQxLDE2IEBAIGRlZiBpc19pZGVmX3Bh
cnNlcl9lbmFibGVkKHRhZyk6CiAgICAgcmV0dXJuIHRhZyBpbiBpZGVmX3BhcnNlcl9lbmFibGVk
CiAKIAorZGVmIGlzX2h2eF9pbnNuKHRhZyk6CisgICAgcmV0dXJuICJBX0NWSSIgaW4gYXR0cmli
ZGljdFt0YWddCisKKworZGVmIGhhc19odnhfaGVscGVyKHRhZyk6CisgICAgcmV0dXJuIChpc19o
dnhfaW5zbih0YWcpIGFuZAorICAgICAgICAgICAgbm90IHNraXBfcWVtdV9oZWxwZXIodGFnKSBh
bmQKKyAgICAgICAgICAgIG5vdCBpc19pZGVmX3BhcnNlcl9lbmFibGVkKHRhZykpCisKKwogZGVm
IGltbV9uYW1lKGltbWxldHQpOgogICAgIHJldHVybiBmIntpbW1sZXR0fWlWIgogCkBAIC03MDQs
NyArNzE0LDggQEAgZGVmIGFuYWx5emVfd3JpdGUoc2VsZiwgZiwgdGFnLCByZWdubyk6CiAgICAg
ICAgIG5ld3YgPSBodnhfbmV3dih0YWcpCiAgICAgICAgIHByZWRpY2F0ZWQgPSAidHJ1ZSIgaWYg
aXNfcHJlZGljYXRlZCh0YWcpIGVsc2UgImZhbHNlIgogICAgICAgICBmLndyaXRlKGNvZGVfZm10
KGYiIiJcCi0gICAgICAgICAgICBjdHhfbG9nX3ZyZWdfd3JpdGUoY3R4LCB7c2VsZi5yZWdfbnVt
fSwge25ld3Z9LCB7cHJlZGljYXRlZH0pOworICAgICAgICAgICAgY3R4X2xvZ192cmVnX3dyaXRl
KGN0eCwge3NlbGYucmVnX251bX0sIHtuZXd2fSwge3ByZWRpY2F0ZWR9LAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGluc25faGFzX2h2eF9oZWxwZXIpOwogICAgICAgICAiIiIpKQog
CiBjbGFzcyBWUmVnU291cmNlKFJlZ2lzdGVyLCBIdngsIE9sZFNvdXJjZSk6CkBAIC03MjQsNyAr
NzM1LDcgQEAgZGVmIGhlbHBlcl9odnhfZGVzYyhzZWxmLCBmKToKICAgICAgICAgIiIiKSkKICAg
ICBkZWYgYW5hbHl6ZV9yZWFkKHNlbGYsIGYsIHJlZ25vKToKICAgICAgICAgZi53cml0ZShjb2Rl
X2ZtdChmIiIiXAotICAgICAgICAgICAgY3R4X2xvZ192cmVnX3JlYWQoY3R4LCB7c2VsZi5yZWdf
bnVtfSk7CisgICAgICAgICAgICBjdHhfbG9nX3ZyZWdfcmVhZChjdHgsIHtzZWxmLnJlZ19udW19
LCBpbnNuX2hhc19odnhfaGVscGVyKTsKICAgICAgICAgIiIiKSkKIAogY2xhc3MgVlJlZ05ld1Nv
dXJjZShSZWdpc3RlciwgSHZ4LCBOZXdTb3VyY2UpOgpAQCAtNzQxLDcgKzc1Miw3IEBAIGRlZiBo
ZWxwZXJfaHZ4X2Rlc2Moc2VsZiwgZik6CiAgICAgICAgICIiIikpCiAgICAgZGVmIGFuYWx5emVf
cmVhZChzZWxmLCBmLCByZWdubyk6CiAgICAgICAgIGYud3JpdGUoY29kZV9mbXQoZiIiIlwKLSAg
ICAgICAgICAgIGN0eF9sb2dfdnJlZ19yZWFkX25ldyhjdHgsIHtzZWxmLnJlZ19udW19KTsKKyAg
ICAgICAgICAgIGN0eF9sb2dfdnJlZ19yZWFkX25ldyhjdHgsIHtzZWxmLnJlZ19udW19LCBpbnNu
X2hhc19odnhfaGVscGVyKTsKICAgICAgICAgIiIiKSkKIAogY2xhc3MgVlJlZ1JlYWRXcml0ZShS
ZWdpc3RlciwgSHZ4LCBSZWFkV3JpdGUpOgpAQCAtNzY3LDEzICs3NzgsMTQgQEAgZGVmIGhlbHBl
cl9odnhfZGVzYyhzZWxmLCBmKToKICAgICAgICAgIiIiKSkKICAgICBkZWYgYW5hbHl6ZV9yZWFk
KHNlbGYsIGYsIHJlZ25vKToKICAgICAgICAgZi53cml0ZShjb2RlX2ZtdChmIiIiXAotICAgICAg
ICAgICAgY3R4X2xvZ192cmVnX3JlYWQoY3R4LCB7c2VsZi5yZWdfbnVtfSk7CisgICAgICAgICAg
ICBjdHhfbG9nX3ZyZWdfcmVhZChjdHgsIHtzZWxmLnJlZ19udW19LCBpbnNuX2hhc19odnhfaGVs
cGVyKTsKICAgICAgICAgIiIiKSkKICAgICBkZWYgYW5hbHl6ZV93cml0ZShzZWxmLCBmLCB0YWcs
IHJlZ25vKToKICAgICAgICAgbmV3diA9IGh2eF9uZXd2KHRhZykKICAgICAgICAgcHJlZGljYXRl
ZCA9ICJ0cnVlIiBpZiBpc19wcmVkaWNhdGVkKHRhZykgZWxzZSAiZmFsc2UiCiAgICAgICAgIGYu
d3JpdGUoY29kZV9mbXQoZiIiIlwKLSAgICAgICAgICAgIGN0eF9sb2dfdnJlZ193cml0ZShjdHgs
IHtzZWxmLnJlZ19udW19LCB7bmV3dn0sIHtwcmVkaWNhdGVkfSk7CisgICAgICAgICAgICBjdHhf
bG9nX3ZyZWdfd3JpdGUoY3R4LCB7c2VsZi5yZWdfbnVtfSwge25ld3Z9LCB7cHJlZGljYXRlZH0s
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zbl9oYXNfaHZ4X2hlbHBlcik7CiAg
ICAgICAgICIiIikpCiAKIGNsYXNzIFZSZWdUbXAoUmVnaXN0ZXIsIEh2eCwgUmVhZFdyaXRlKToK
QEAgLTgwMSwxMyArODEzLDE0IEBAIGRlZiBoZWxwZXJfaHZ4X2Rlc2Moc2VsZiwgZik6CiAgICAg
ICAgICIiIikpCiAgICAgZGVmIGFuYWx5emVfcmVhZChzZWxmLCBmLCByZWdubyk6CiAgICAgICAg
IGYud3JpdGUoY29kZV9mbXQoZiIiIlwKLSAgICAgICAgICAgIGN0eF9sb2dfdnJlZ19yZWFkKGN0
eCwge3NlbGYucmVnX251bX0pOworICAgICAgICAgICAgY3R4X2xvZ192cmVnX3JlYWQoY3R4LCB7
c2VsZi5yZWdfbnVtfSwgaW5zbl9oYXNfaHZ4X2hlbHBlcik7CiAgICAgICAgICIiIikpCiAgICAg
ZGVmIGFuYWx5emVfd3JpdGUoc2VsZiwgZiwgdGFnLCByZWdubyk6CiAgICAgICAgIG5ld3YgPSBo
dnhfbmV3dih0YWcpCiAgICAgICAgIHByZWRpY2F0ZWQgPSAidHJ1ZSIgaWYgaXNfcHJlZGljYXRl
ZCh0YWcpIGVsc2UgImZhbHNlIgogICAgICAgICBmLndyaXRlKGNvZGVfZm10KGYiIiJcCi0gICAg
ICAgICAgICBjdHhfbG9nX3ZyZWdfd3JpdGUoY3R4LCB7c2VsZi5yZWdfbnVtfSwge25ld3Z9LCB7
cHJlZGljYXRlZH0pOworICAgICAgICAgICAgY3R4X2xvZ192cmVnX3dyaXRlKGN0eCwge3NlbGYu
cmVnX251bX0sIHtuZXd2fSwge3ByZWRpY2F0ZWR9LAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGluc25faGFzX2h2eF9oZWxwZXIpOwogICAgICAgICAiIiIpKQogCiBjbGFzcyBWUmVn
UGFpckRlc3QoUmVnaXN0ZXIsIEh2eCwgRGVzdCk6CkBAIC04MzIsNyArODQ1LDggQEAgZGVmIGFu
YWx5emVfd3JpdGUoc2VsZiwgZiwgdGFnLCByZWdubyk6CiAgICAgICAgIG5ld3YgPSBodnhfbmV3
dih0YWcpCiAgICAgICAgIHByZWRpY2F0ZWQgPSAidHJ1ZSIgaWYgaXNfcHJlZGljYXRlZCh0YWcp
IGVsc2UgImZhbHNlIgogICAgICAgICBmLndyaXRlKGNvZGVfZm10KGYiIiJcCi0gICAgICAgICAg
ICBjdHhfbG9nX3ZyZWdfd3JpdGVfcGFpcihjdHgsIHtzZWxmLnJlZ19udW19LCB7bmV3dn0sIHtw
cmVkaWNhdGVkfSk7CisgICAgICAgICAgICBjdHhfbG9nX3ZyZWdfd3JpdGVfcGFpcihjdHgsIHtz
ZWxmLnJlZ19udW19LCB7bmV3dn0sIHtwcmVkaWNhdGVkfSwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGluc25faGFzX2h2eF9oZWxwZXIpOwogICAgICAgICAiIiIpKQogCiBj
bGFzcyBWUmVnUGFpclNvdXJjZShSZWdpc3RlciwgSHZ4LCBPbGRTb3VyY2UpOgpAQCAtODU5LDcg
Kzg3Myw3IEBAIGRlZiBoZWxwZXJfaHZ4X2Rlc2Moc2VsZiwgZik6CiAgICAgICAgICIiIikpCiAg
ICAgZGVmIGFuYWx5emVfcmVhZChzZWxmLCBmLCByZWdubyk6CiAgICAgICAgIGYud3JpdGUoY29k
ZV9mbXQoZiIiIlwKLSAgICAgICAgICAgIGN0eF9sb2dfdnJlZ19yZWFkX3BhaXIoY3R4LCB7c2Vs
Zi5yZWdfbnVtfSk7CisgICAgICAgICAgICBjdHhfbG9nX3ZyZWdfcmVhZF9wYWlyKGN0eCwge3Nl
bGYucmVnX251bX0sIGluc25faGFzX2h2eF9oZWxwZXIpOwogICAgICAgICAiIiIpKQogCiBjbGFz
cyBWUmVnUGFpclJlYWRXcml0ZShSZWdpc3RlciwgSHZ4LCBSZWFkV3JpdGUpOgpAQCAtODkxLDEz
ICs5MDUsMTQgQEAgZGVmIGhlbHBlcl9odnhfZGVzYyhzZWxmLCBmKToKICAgICAgICAgIiIiKSkK
ICAgICBkZWYgYW5hbHl6ZV9yZWFkKHNlbGYsIGYsIHJlZ25vKToKICAgICAgICAgZi53cml0ZShj
b2RlX2ZtdChmIiIiXAotICAgICAgICAgICAgY3R4X2xvZ192cmVnX3JlYWRfcGFpcihjdHgsIHtz
ZWxmLnJlZ19udW19KTsKKyAgICAgICAgICAgIGN0eF9sb2dfdnJlZ19yZWFkX3BhaXIoY3R4LCB7
c2VsZi5yZWdfbnVtfSwgaW5zbl9oYXNfaHZ4X2hlbHBlcik7CiAgICAgICAgICIiIikpCiAgICAg
ZGVmIGFuYWx5emVfd3JpdGUoc2VsZiwgZiwgdGFnLCByZWdubyk6CiAgICAgICAgIG5ld3YgPSBo
dnhfbmV3dih0YWcpCiAgICAgICAgIHByZWRpY2F0ZWQgPSAidHJ1ZSIgaWYgaXNfcHJlZGljYXRl
ZCh0YWcpIGVsc2UgImZhbHNlIgogICAgICAgICBmLndyaXRlKGNvZGVfZm10KGYiIiJcCi0gICAg
ICAgICAgICBjdHhfbG9nX3ZyZWdfd3JpdGVfcGFpcihjdHgsIHtzZWxmLnJlZ19udW19LCB7bmV3
dn0sIHtwcmVkaWNhdGVkfSk7CisgICAgICAgICAgICBjdHhfbG9nX3ZyZWdfd3JpdGVfcGFpcihj
dHgsIHtzZWxmLnJlZ19udW19LCB7bmV3dn0sIHtwcmVkaWNhdGVkfSwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGluc25faGFzX2h2eF9oZWxwZXIpOwogICAgICAgICAiIiIp
KQogCiBjbGFzcyBRUmVnRGVzdChSZWdpc3RlciwgSHZ4LCBEZXN0KToKQEAgLTkyMCw3ICs5MzUs
NyBAQCBkZWYgaGVscGVyX2h2eF9kZXNjKHNlbGYsIGYpOgogICAgICAgICAiIiIpKQogICAgIGRl
ZiBhbmFseXplX3dyaXRlKHNlbGYsIGYsIHRhZywgcmVnbm8pOgogICAgICAgICBmLndyaXRlKGNv
ZGVfZm10KGYiIiJcCi0gICAgICAgICAgICBjdHhfbG9nX3FyZWdfd3JpdGUoY3R4LCB7c2VsZi5y
ZWdfbnVtfSk7CisgICAgICAgICAgICBjdHhfbG9nX3FyZWdfd3JpdGUoY3R4LCB7c2VsZi5yZWdf
bnVtfSwgaW5zbl9oYXNfaHZ4X2hlbHBlcik7CiAgICAgICAgICIiIikpCiAKIGNsYXNzIFFSZWdT
b3VyY2UoUmVnaXN0ZXIsIEh2eCwgT2xkU291cmNlKToKQEAgLTk0MSw3ICs5NTYsNyBAQCBkZWYg
aGVscGVyX2h2eF9kZXNjKHNlbGYsIGYpOgogICAgICAgICAiIiIpKQogICAgIGRlZiBhbmFseXpl
X3JlYWQoc2VsZiwgZiwgcmVnbm8pOgogICAgICAgICBmLndyaXRlKGNvZGVfZm10KGYiIiJcCi0g
ICAgICAgICAgICBjdHhfbG9nX3FyZWdfcmVhZChjdHgsIHtzZWxmLnJlZ19udW19KTsKKyAgICAg
ICAgICAgIGN0eF9sb2dfcXJlZ19yZWFkKGN0eCwge3NlbGYucmVnX251bX0sIGluc25faGFzX2h2
eF9oZWxwZXIpOwogICAgICAgICAiIiIpKQogCiBjbGFzcyBRUmVnUmVhZFdyaXRlKFJlZ2lzdGVy
LCBIdngsIFJlYWRXcml0ZSk6CkBAIC05NjcsMTEgKzk4MiwxMSBAQCBkZWYgaGVscGVyX2h2eF9k
ZXNjKHNlbGYsIGYpOgogICAgICAgICAiIiIpKQogICAgIGRlZiBhbmFseXplX3JlYWQoc2VsZiwg
ZiwgcmVnbm8pOgogICAgICAgICBmLndyaXRlKGNvZGVfZm10KGYiIiJcCi0gICAgICAgICAgICBj
dHhfbG9nX3FyZWdfcmVhZChjdHgsIHtzZWxmLnJlZ19udW19KTsKKyAgICAgICAgICAgIGN0eF9s
b2dfcXJlZ19yZWFkKGN0eCwge3NlbGYucmVnX251bX0sIGluc25faGFzX2h2eF9oZWxwZXIpOwog
ICAgICAgICAiIiIpKQogICAgIGRlZiBhbmFseXplX3dyaXRlKHNlbGYsIGYsIHRhZywgcmVnbm8p
OgogICAgICAgICBmLndyaXRlKGNvZGVfZm10KGYiIiJcCi0gICAgICAgICAgICBjdHhfbG9nX3Fy
ZWdfd3JpdGUoY3R4LCB7c2VsZi5yZWdfbnVtfSk7CisgICAgICAgICAgICBjdHhfbG9nX3FyZWdf
d3JpdGUoY3R4LCB7c2VsZi5yZWdfbnVtfSwgaW5zbl9oYXNfaHZ4X2hlbHBlcik7CiAgICAgICAg
ICIiIikpCiAKIGRlZiBpbml0X3JlZ2lzdGVycygpOgpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2hleGFn
b24vdHJhbnNsYXRlLmMgYi90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYwppbmRleCA4ZDQyZWJk
OTFjLi4wOTA0ZGMyZDM4IDEwMDY0NAotLS0gYS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYwor
KysgYi90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuYwpAQCAtMzgwLDYwICszODAsMTAgQEAgc3Rh
dGljIGJvb2wgbmVlZF9jb21taXQoRGlzYXNDb250ZXh0ICpjdHgpCiAgICAgICAgIHJldHVybiB0
cnVlOwogICAgIH0KIAotICAgIGlmIChwa3QtPm51bV9pbnNucyA9PSAxKSB7Ci0gICAgICAgIGlm
IChwa3QtPnBrdF9oYXNfaHZ4KSB7Ci0gICAgICAgICAgICAvKgotICAgICAgICAgICAgICogVGhl
IEhWWCBpbnN0cnVjdGlvbnMgd2l0aCBnZW5lcmF0ZWQgaGVscGVycyB1c2UKLSAgICAgICAgICAg
ICAqIHBhc3MtYnktcmVmZXJlbmNlLCBzbyB0aGV5IG5lZWQgdGhlIHJlYWQvd3JpdGUgb3Zlcmxh
cAotICAgICAgICAgICAgICogY2hlY2sgYmVsb3cuCi0gICAgICAgICAgICAgKiBUaGUgSFZYIGlu
c3RydWN0aW9ucyB3aXRoIG92ZXJyaWRlcyBhcmUgT0suCi0gICAgICAgICAgICAgKi8KLSAgICAg
ICAgICAgIGlmICghY3R4LT5oYXNfaHZ4X2hlbHBlcikgewotICAgICAgICAgICAgICAgIHJldHVy
biBmYWxzZTsKLSAgICAgICAgICAgIH0KLSAgICAgICAgfSBlbHNlIHsKLSAgICAgICAgICAgIHJl
dHVybiBmYWxzZTsKLSAgICAgICAgfQotICAgIH0KLQotICAgIGlmIChjdHgtPnJlYWRfYWZ0ZXJf
d3JpdGUpIHsKKyAgICBpZiAoY3R4LT5yZWFkX2FmdGVyX3dyaXRlIHx8IGN0eC0+aGFzX2h2eF9v
dmVybGFwKSB7CiAgICAgICAgIHJldHVybiB0cnVlOwogICAgIH0KIAotICAgIC8qIENoZWNrIGZv
ciBvdmVybGFwIGJldHdlZW4gSFZYIHJlYWRzIGFuZCB3cml0ZXMgKi8KLSAgICBmb3IgKGludCBp
ID0gMDsgaSA8IGN0eC0+dnJlZ19sb2dfaWR4OyBpKyspIHsKLSAgICAgICAgaW50IHZudW0gPSBj
dHgtPnZyZWdfbG9nW2ldOwotICAgICAgICBpZiAodGVzdF9iaXQodm51bSwgY3R4LT52cmVnc19y
ZWFkKSkgewotICAgICAgICAgICAgcmV0dXJuIHRydWU7Ci0gICAgICAgIH0KLSAgICB9Ci0gICAg
aWYgKCFiaXRtYXBfZW1wdHkoY3R4LT52cmVnc191cGRhdGVkX3RtcCwgTlVNX1ZSRUdTKSkgewot
ICAgICAgICBpbnQgaSA9IGZpbmRfZmlyc3RfYml0KGN0eC0+dnJlZ3NfdXBkYXRlZF90bXAsIE5V
TV9WUkVHUyk7Ci0gICAgICAgIHdoaWxlIChpIDwgTlVNX1ZSRUdTKSB7Ci0gICAgICAgICAgICBp
ZiAodGVzdF9iaXQoaSwgY3R4LT52cmVnc19yZWFkKSkgewotICAgICAgICAgICAgICAgIHJldHVy
biB0cnVlOwotICAgICAgICAgICAgfQotICAgICAgICAgICAgaSA9IGZpbmRfbmV4dF9iaXQoY3R4
LT52cmVnc191cGRhdGVkX3RtcCwgTlVNX1ZSRUdTLCBpICsgMSk7Ci0gICAgICAgIH0KLSAgICB9
Ci0gICAgaWYgKCFiaXRtYXBfZW1wdHkoY3R4LT52cmVnc19zZWxlY3QsIE5VTV9WUkVHUykpIHsK
LSAgICAgICAgaW50IGkgPSBmaW5kX2ZpcnN0X2JpdChjdHgtPnZyZWdzX3NlbGVjdCwgTlVNX1ZS
RUdTKTsKLSAgICAgICAgd2hpbGUgKGkgPCBOVU1fVlJFR1MpIHsKLSAgICAgICAgICAgIGlmICh0
ZXN0X2JpdChpLCBjdHgtPnZyZWdzX3JlYWQpKSB7Ci0gICAgICAgICAgICAgICAgcmV0dXJuIHRy
dWU7Ci0gICAgICAgICAgICB9Ci0gICAgICAgICAgICBpID0gZmluZF9uZXh0X2JpdChjdHgtPnZy
ZWdzX3NlbGVjdCwgTlVNX1ZSRUdTLCBpICsgMSk7Ci0gICAgICAgIH0KLSAgICB9Ci0KLSAgICAv
KiBDaGVjayBmb3Igb3ZlcmxhcCBiZXR3ZWVuIEhWWCBwcmVkaWNhdGUgcmVhZHMgYW5kIHdyaXRl
cyAqLwotICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY3R4LT5xcmVnX2xvZ19pZHg7IGkrKykgewot
ICAgICAgICBpbnQgcW51bSA9IGN0eC0+cXJlZ19sb2dbaV07Ci0gICAgICAgIGlmICh0ZXN0X2Jp
dChxbnVtLCBjdHgtPnFyZWdzX3JlYWQpKSB7Ci0gICAgICAgICAgICByZXR1cm4gdHJ1ZTsKLSAg
ICAgICAgfQotICAgIH0KLQogICAgIHJldHVybiBmYWxzZTsKIH0KIApAQCAtNDU1LDggKzQwNSw4
IEBAIHN0YXRpYyB2b2lkIG1hcmtfaW1wbGljaXRfcHJlZF9yZWFkcyhEaXNhc0NvbnRleHQgKmN0
eCkKIHN0YXRpYyB2b2lkIGFuYWx5emVfcGFja2V0KERpc2FzQ29udGV4dCAqY3R4KQogewogICAg
IFBhY2tldCAqcGt0ID0gY3R4LT5wa3Q7Ci0gICAgY3R4LT5oYXNfaHZ4X2hlbHBlciA9IGZhbHNl
OwogICAgIGN0eC0+cmVhZF9hZnRlcl93cml0ZSA9IGZhbHNlOworICAgIGN0eC0+aGFzX2h2eF9v
dmVybGFwID0gZmFsc2U7CiAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwa3QtPm51bV9pbnNuczsg
aSsrKSB7CiAgICAgICAgIEluc24gKmluc24gPSAmcGt0LT5pbnNuW2ldOwogICAgICAgICBjdHgt
Pmluc24gPSBpbnNuOwpAQCAtNDg3LDEzICs0MzcsMTMgQEAgc3RhdGljIHZvaWQgZ2VuX3N0YXJ0
X3BhY2tldChEaXNhc0NvbnRleHQgKmN0eCkKICAgICBjdHgtPmZ1dHVyZV92cmVnc19pZHggPSAw
OwogICAgIGN0eC0+dG1wX3ZyZWdzX2lkeCA9IDA7CiAgICAgY3R4LT52cmVnX2xvZ19pZHggPSAw
OworICAgIGJpdG1hcF96ZXJvKGN0eC0+dnJlZ3Nfd3JpdHRlbiwgTlVNX1ZSRUdTKTsKICAgICBi
aXRtYXBfemVybyhjdHgtPnZyZWdzX3VwZGF0ZWRfdG1wLCBOVU1fVlJFR1MpOwogICAgIGJpdG1h
cF96ZXJvKGN0eC0+dnJlZ3NfdXBkYXRlZCwgTlVNX1ZSRUdTKTsKICAgICBiaXRtYXBfemVybyhj
dHgtPnZyZWdzX3NlbGVjdCwgTlVNX1ZSRUdTKTsKICAgICBiaXRtYXBfemVybyhjdHgtPnByZWRp
Y2F0ZWRfZnV0dXJlX3ZyZWdzLCBOVU1fVlJFR1MpOwogICAgIGJpdG1hcF96ZXJvKGN0eC0+cHJl
ZGljYXRlZF90bXBfdnJlZ3MsIE5VTV9WUkVHUyk7Ci0gICAgYml0bWFwX3plcm8oY3R4LT52cmVn
c19yZWFkLCBOVU1fVlJFR1MpOwotICAgIGJpdG1hcF96ZXJvKGN0eC0+cXJlZ3NfcmVhZCwgTlVN
X1FSRUdTKTsKKyAgICBiaXRtYXBfemVybyhjdHgtPnFyZWdzX3dyaXR0ZW4sIE5VTV9RUkVHUyk7
CiAgICAgY3R4LT5xcmVnX2xvZ19pZHggPSAwOwogICAgIGZvciAoaSA9IDA7IGkgPCBTVE9SRVNf
TUFYOyBpKyspIHsKICAgICAgICAgY3R4LT5zdG9yZV93aWR0aFtpXSA9IDA7CmRpZmYgLS1naXQg
YS90YXJnZXQvaGV4YWdvbi90cmFuc2xhdGUuaCBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5o
CmluZGV4IGQ1ZTdmNDlhZDguLjAwY2MyYmNkNjMgMTAwNjQ0Ci0tLSBhL3RhcmdldC9oZXhhZ29u
L3RyYW5zbGF0ZS5oCisrKyBiL3RhcmdldC9oZXhhZ29uL3RyYW5zbGF0ZS5oCkBAIC01MCwyMyAr
NTAsMjcgQEAgdHlwZWRlZiBzdHJ1Y3QgRGlzYXNDb250ZXh0IHsKICAgICBpbnQgdG1wX3ZyZWdz
X251bVtWRUNUT1JfVEVNUFNfTUFYXTsKICAgICBpbnQgdnJlZ19sb2dbTlVNX1ZSRUdTXTsKICAg
ICBpbnQgdnJlZ19sb2dfaWR4OworICAgIERFQ0xBUkVfQklUTUFQKHZyZWdzX3dyaXR0ZW4sIE5V
TV9WUkVHUyk7CisgICAgREVDTEFSRV9CSVRNQVAoaW5zbl92cmVnc193cml0dGVuLCBOVU1fVlJF
R1MpOwogICAgIERFQ0xBUkVfQklUTUFQKHZyZWdzX3VwZGF0ZWRfdG1wLCBOVU1fVlJFR1MpOwog
ICAgIERFQ0xBUkVfQklUTUFQKHZyZWdzX3VwZGF0ZWQsIE5VTV9WUkVHUyk7CiAgICAgREVDTEFS
RV9CSVRNQVAodnJlZ3Nfc2VsZWN0LCBOVU1fVlJFR1MpOwogICAgIERFQ0xBUkVfQklUTUFQKHBy
ZWRpY2F0ZWRfZnV0dXJlX3ZyZWdzLCBOVU1fVlJFR1MpOwogICAgIERFQ0xBUkVfQklUTUFQKHBy
ZWRpY2F0ZWRfdG1wX3ZyZWdzLCBOVU1fVlJFR1MpOwotICAgIERFQ0xBUkVfQklUTUFQKHZyZWdz
X3JlYWQsIE5VTV9WUkVHUyk7CisgICAgREVDTEFSRV9CSVRNQVAoaW5zbl92cmVnc19yZWFkLCBO
VU1fVlJFR1MpOwogICAgIGludCBxcmVnX2xvZ1tOVU1fUVJFR1NdOwogICAgIGludCBxcmVnX2xv
Z19pZHg7Ci0gICAgREVDTEFSRV9CSVRNQVAocXJlZ3NfcmVhZCwgTlVNX1FSRUdTKTsKKyAgICBE
RUNMQVJFX0JJVE1BUChxcmVnc193cml0dGVuLCBOVU1fUVJFR1MpOworICAgIERFQ0xBUkVfQklU
TUFQKGluc25fcXJlZ3Nfd3JpdHRlbiwgTlVNX1FSRUdTKTsKKyAgICBERUNMQVJFX0JJVE1BUChp
bnNuX3FyZWdzX3JlYWQsIE5VTV9RUkVHUyk7CiAgICAgYm9vbCBwcmVfY29tbWl0OwogICAgIGJv
b2wgbmVlZF9jb21taXQ7CiAgICAgVENHQ29uZCBicmFuY2hfY29uZDsKICAgICB0YXJnZXRfdWxv
bmcgYnJhbmNoX2Rlc3Q7CiAgICAgYm9vbCBpc190aWdodF9sb29wOwogICAgIGJvb2wgc2hvcnRf
Y2lyY3VpdDsKLSAgICBib29sIGhhc19odnhfaGVscGVyOwogICAgIGJvb2wgcmVhZF9hZnRlcl93
cml0ZTsKKyAgICBib29sIGhhc19odnhfb3ZlcmxhcDsKICAgICBUQ0d2IG5ld192YWx1ZVtUT1RB
TF9QRVJfVEhSRUFEX1JFR1NdOwogICAgIFRDR3YgbmV3X3ByZWRfdmFsdWVbTlVNX1BSRUdTXTsK
ICAgICBUQ0d2IHByZWRfd3JpdHRlbjsKQEAgLTE0NiwxMCArMTUwLDI1IEBAIGludHB0cl90IGN0
eF9mdXR1cmVfdnJlZ19vZmYoRGlzYXNDb250ZXh0ICpjdHgsIGludCByZWdudW0sCiBpbnRwdHJf
dCBjdHhfdG1wX3ZyZWdfb2ZmKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcmVnbnVtLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICBpbnQgbnVtLCBib29sIGFsbG9jX29rKTsKIAorc3RhdGljIGlu
bGluZSB2b2lkIGN0eF9zdGFydF9odnhfaW5zbihEaXNhc0NvbnRleHQgKmN0eCkKK3sKKyAgICBi
aXRtYXBfemVybyhjdHgtPmluc25fdnJlZ3Nfd3JpdHRlbiwgTlVNX1ZSRUdTKTsKKyAgICBiaXRt
YXBfemVybyhjdHgtPmluc25fdnJlZ3NfcmVhZCwgTlVNX1ZSRUdTKTsKKyAgICBiaXRtYXBfemVy
byhjdHgtPmluc25fcXJlZ3Nfd3JpdHRlbiwgTlVNX1FSRUdTKTsKKyAgICBiaXRtYXBfemVybyhj
dHgtPmluc25fcXJlZ3NfcmVhZCwgTlVNX1FSRUdTKTsKK30KKwogc3RhdGljIGlubGluZSB2b2lk
IGN0eF9sb2dfdnJlZ193cml0ZShEaXNhc0NvbnRleHQgKmN0eCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaW50IHJudW0sIFZSZWdXcml0ZVR5cGUgdHlwZSwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBpc19wcmVkaWNhdGVkKQorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIGlzX3ByZWRpY2F0ZWQsIGJv
b2wgaGFzX2hlbHBlcikKIHsKKyAgICBpZiAoaGFzX2hlbHBlcikgeworICAgICAgICBzZXRfYml0
KHJudW0sIGN0eC0+aW5zbl92cmVnc193cml0dGVuKTsKKyAgICAgICAgaWYgKHRlc3RfYml0KHJu
dW0sIGN0eC0+aW5zbl92cmVnc19yZWFkKSkgeworICAgICAgICAgICAgY3R4LT5oYXNfaHZ4X292
ZXJsYXAgPSB0cnVlOworICAgICAgICB9CisgICAgfQorICAgIHNldF9iaXQocm51bSwgY3R4LT52
cmVnc193cml0dGVuKTsKICAgICBpZiAodHlwZSAhPSBFWFRfVE1QKSB7CiAgICAgICAgIGlmICgh
dGVzdF9iaXQocm51bSwgY3R4LT52cmVnc191cGRhdGVkKSkgewogICAgICAgICAgICAgY3R4LT52
cmVnX2xvZ1tjdHgtPnZyZWdfbG9nX2lkeF0gPSBybnVtOwpAQCAtMTc1LDQyICsxOTQsNzcgQEAg
c3RhdGljIGlubGluZSB2b2lkIGN0eF9sb2dfdnJlZ193cml0ZShEaXNhc0NvbnRleHQgKmN0eCwK
IAogc3RhdGljIGlubGluZSB2b2lkIGN0eF9sb2dfdnJlZ193cml0ZV9wYWlyKERpc2FzQ29udGV4
dCAqY3R4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBy
bnVtLCBWUmVnV3JpdGVUeXBlIHR5cGUsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYm9vbCBpc19wcmVkaWNhdGVkKQorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGJvb2wgaXNfcHJlZGljYXRlZCwgYm9vbCBoYXNfaGVscGVyKQog
ewotICAgIGN0eF9sb2dfdnJlZ193cml0ZShjdHgsIHJudW0gXiAwLCB0eXBlLCBpc19wcmVkaWNh
dGVkKTsKLSAgICBjdHhfbG9nX3ZyZWdfd3JpdGUoY3R4LCBybnVtIF4gMSwgdHlwZSwgaXNfcHJl
ZGljYXRlZCk7CisgICAgY3R4X2xvZ192cmVnX3dyaXRlKGN0eCwgcm51bSBeIDAsIHR5cGUsIGlz
X3ByZWRpY2F0ZWQsIGhhc19oZWxwZXIpOworICAgIGN0eF9sb2dfdnJlZ193cml0ZShjdHgsIHJu
dW0gXiAxLCB0eXBlLCBpc19wcmVkaWNhdGVkLCBoYXNfaGVscGVyKTsKIH0KIAotc3RhdGljIGlu
bGluZSB2b2lkIGN0eF9sb2dfdnJlZ19yZWFkKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcm51bSkK
K3N0YXRpYyBpbmxpbmUgdm9pZCBjdHhfbG9nX3ZyZWdfcmVhZChEaXNhc0NvbnRleHQgKmN0eCwg
aW50IHJudW0sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBoYXNf
aGVscGVyKQogewotICAgIHNldF9iaXQocm51bSwgY3R4LT52cmVnc19yZWFkKTsKKyAgICBpZiAo
aGFzX2hlbHBlcikgeworICAgICAgICBzZXRfYml0KHJudW0sIGN0eC0+aW5zbl92cmVnc19yZWFk
KTsKKyAgICAgICAgaWYgKHRlc3RfYml0KHJudW0sIGN0eC0+aW5zbl92cmVnc193cml0dGVuKSkg
eworICAgICAgICAgICAgY3R4LT5oYXNfaHZ4X292ZXJsYXAgPSB0cnVlOworICAgICAgICB9Cisg
ICAgfQorICAgIGlmICh0ZXN0X2JpdChybnVtLCBjdHgtPnZyZWdzX3dyaXR0ZW4pKSB7CisgICAg
ICAgIGN0eC0+cmVhZF9hZnRlcl93cml0ZSA9IHRydWU7CisgICAgfQogfQogCi1zdGF0aWMgaW5s
aW5lIHZvaWQgY3R4X2xvZ192cmVnX3JlYWRfbmV3KERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcm51
bSkKK3N0YXRpYyBpbmxpbmUgdm9pZCBjdHhfbG9nX3ZyZWdfcmVhZF9uZXcoRGlzYXNDb250ZXh0
ICpjdHgsIGludCBybnVtLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBib29sIGhhc19oZWxwZXIpCiB7CiAgICAgZ19hc3NlcnQoaXNfZ2F0aGVyX3N0b3JlX2luc24o
Y3R4KSB8fAogICAgICAgICAgICAgIHRlc3RfYml0KHJudW0sIGN0eC0+dnJlZ3NfdXBkYXRlZCkg
fHwKICAgICAgICAgICAgICB0ZXN0X2JpdChybnVtLCBjdHgtPnZyZWdzX3NlbGVjdCkgfHwKICAg
ICAgICAgICAgICB0ZXN0X2JpdChybnVtLCBjdHgtPnZyZWdzX3VwZGF0ZWRfdG1wKSk7Ci0gICAg
c2V0X2JpdChybnVtLCBjdHgtPnZyZWdzX3JlYWQpOworICAgIGlmIChoYXNfaGVscGVyKSB7Cisg
ICAgICAgIHNldF9iaXQocm51bSwgY3R4LT5pbnNuX3ZyZWdzX3JlYWQpOworICAgICAgICBpZiAo
dGVzdF9iaXQocm51bSwgY3R4LT5pbnNuX3ZyZWdzX3dyaXR0ZW4pKSB7CisgICAgICAgICAgICBj
dHgtPmhhc19odnhfb3ZlcmxhcCA9IHRydWU7CisgICAgICAgIH0KKyAgICB9CisgICAgaWYgKGlz
X2dhdGhlcl9zdG9yZV9pbnNuKGN0eCkpIHsKKyAgICAgICAgY3R4LT5yZWFkX2FmdGVyX3dyaXRl
ID0gdHJ1ZTsKKyAgICB9CiB9CiAKLXN0YXRpYyBpbmxpbmUgdm9pZCBjdHhfbG9nX3ZyZWdfcmVh
ZF9wYWlyKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcm51bSkKK3N0YXRpYyBpbmxpbmUgdm9pZCBj
dHhfbG9nX3ZyZWdfcmVhZF9wYWlyKERpc2FzQ29udGV4dCAqY3R4LCBpbnQgcm51bSwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgaGFzX2hlbHBlcikKIHsK
LSAgICBjdHhfbG9nX3ZyZWdfcmVhZChjdHgsIHJudW0gXiAwKTsKLSAgICBjdHhfbG9nX3ZyZWdf
cmVhZChjdHgsIHJudW0gXiAxKTsKKyAgICBjdHhfbG9nX3ZyZWdfcmVhZChjdHgsIHJudW0gXiAw
LCBoYXNfaGVscGVyKTsKKyAgICBjdHhfbG9nX3ZyZWdfcmVhZChjdHgsIHJudW0gXiAxLCBoYXNf
aGVscGVyKTsKIH0KIAogc3RhdGljIGlubGluZSB2b2lkIGN0eF9sb2dfcXJlZ193cml0ZShEaXNh
c0NvbnRleHQgKmN0eCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50
IHJudW0pCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBybnVtLCBi
b29sIGhhc19oZWxwZXIpCiB7CisgICAgaWYgKGhhc19oZWxwZXIpIHsKKyAgICAgICAgc2V0X2Jp
dChybnVtLCBjdHgtPmluc25fcXJlZ3Nfd3JpdHRlbik7CisgICAgICAgIGlmICh0ZXN0X2JpdChy
bnVtLCBjdHgtPmluc25fcXJlZ3NfcmVhZCkpIHsKKyAgICAgICAgICAgIGN0eC0+aGFzX2h2eF9v
dmVybGFwID0gdHJ1ZTsKKyAgICAgICAgfQorICAgIH0KKyAgICBzZXRfYml0KHJudW0sIGN0eC0+
cXJlZ3Nfd3JpdHRlbik7CiAgICAgY3R4LT5xcmVnX2xvZ1tjdHgtPnFyZWdfbG9nX2lkeF0gPSBy
bnVtOwogICAgIGN0eC0+cXJlZ19sb2dfaWR4Kys7CiB9CiAKLXN0YXRpYyBpbmxpbmUgdm9pZCBj
dHhfbG9nX3FyZWdfcmVhZChEaXNhc0NvbnRleHQgKmN0eCwgaW50IHFudW0pCitzdGF0aWMgaW5s
aW5lIHZvaWQgY3R4X2xvZ19xcmVnX3JlYWQoRGlzYXNDb250ZXh0ICpjdHgsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHFudW0sIGJvb2wgaGFzX2hlbHBlcikKIHsK
LSAgICBzZXRfYml0KHFudW0sIGN0eC0+cXJlZ3NfcmVhZCk7CisgICAgaWYgKGhhc19oZWxwZXIp
IHsKKyAgICAgICAgc2V0X2JpdChxbnVtLCBjdHgtPmluc25fcXJlZ3NfcmVhZCk7CisgICAgICAg
IGlmICh0ZXN0X2JpdChxbnVtLCBjdHgtPmluc25fcXJlZ3Nfd3JpdHRlbikpIHsKKyAgICAgICAg
ICAgIGN0eC0+aGFzX2h2eF9vdmVybGFwID0gdHJ1ZTsKKyAgICAgICAgfQorICAgIH0KKyAgICBp
ZiAodGVzdF9iaXQocW51bSwgY3R4LT5xcmVnc193cml0dGVuKSkgeworICAgICAgICBjdHgtPnJl
YWRfYWZ0ZXJfd3JpdGUgPSB0cnVlOworICAgIH0KIH0KIAogZXh0ZXJuIFRDR3YgaGV4X2dwcltU
T1RBTF9QRVJfVEhSRUFEX1JFR1NdOwotLSAKMi4yNS4xCgo=

