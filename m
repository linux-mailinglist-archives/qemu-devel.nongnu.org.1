Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 078047D1D50
	for <lists+qemu-devel@lfdr.de>; Sat, 21 Oct 2023 15:51:54 +0200 (CEST)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1quCNs-0006xV-DE; Sat, 21 Oct 2023 09:51:20 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <ysato@users.sourceforge.jp>)
 id 1quCNq-0006wt-IL
 for qemu-devel@nongnu.org; Sat, 21 Oct 2023 09:51:18 -0400
Received: from hsmtpd-def.xspmail.jp ([2001:240:bb81:94:202:238:198:240])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_128_GCM_SHA256:128)
 (Exim 4.90_1) (envelope-from <ysato@users.sourceforge.jp>)
 id 1quCNn-0001a0-WA
 for qemu-devel@nongnu.org; Sat, 21 Oct 2023 09:51:18 -0400
X-Country-Code: JP
Received: from sakura.ysato.name (ik1-413-38519.vs.sakura.ne.jp
 [153.127.30.23])
 by hsmtpd-out-1.asahinet.cluster.xspmail.jp (Halon) with ESMTPA
 id bcb3e5f7-3bf7-49ea-b269-27608859e719;
 Sat, 21 Oct 2023 22:45:08 +0900 (JST)
Received: from SIOS1075.ysato.ml (ZM005235.ppp.dion.ne.jp [222.8.5.235])
 by sakura.ysato.name (Postfix) with ESMTPSA id 33D3A1C005D;
 Sat, 21 Oct 2023 22:45:05 +0900 (JST)
Date: Sat, 21 Oct 2023 22:45:04 +0900
Message-ID: <8734y484yn.wl-ysato@users.sourceforge.jp>
From: Yoshinori Sato <ysato@users.sourceforge.jp>
To: Richard Henderson <richard.henderson@linaro.org>
Cc: qemu-devel@nongnu.org, pbonzini@redhat.com, qemu-arm@nongnu.org,
 laurent@vivier.eu, kbastian@mail.uni-paderborn.de, jcmvbkbc@gmail.com
Subject: Re: [PATCH 5/7] target/rx: Use tcg_gen_ext_i32
In-Reply-To: <20231019182921.1772928-6-richard.henderson@linaro.org>
References: <20231019182921.1772928-1-richard.henderson@linaro.org>
 <20231019182921.1772928-6-richard.henderson@linaro.org>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?ISO-8859-4?Q?Goj=F2?=) APEL-LB/10.8 EasyPG/1.0.0
 Emacs/28.2 (x86_64-pc-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
Received-SPF: softfail client-ip=2001:240:bb81:94:202:238:198:240;
 envelope-from=ysato@users.sourceforge.jp; helo=hsmtpd-def.xspmail.jp
X-Spam_score_int: -11
X-Spam_score: -1.2
X-Spam_bar: -
X-Spam_report: (-1.2 / 5.0 requ) BAYES_00=-1.9, SPF_HELO_PASS=-0.001,
 SPF_SOFTFAIL=0.665 autolearn=no autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

On Fri, 20 Oct 2023 03:29:19 +0900,
Richard Henderson wrote:
> 
> Signed-off-by: Richard Henderson <richard.henderson@linaro.org>
Reviewed-by: Yoshinori Sato <ysato@users.sourceforge.jp>

> ---
>  target/rx/translate.c | 11 +++--------
>  1 file changed, 3 insertions(+), 8 deletions(-)
> 
> diff --git a/target/rx/translate.c b/target/rx/translate.c
> index f8860830ae..c6ce717a95 100644
> --- a/target/rx/translate.c
> +++ b/target/rx/translate.c
> @@ -492,13 +492,11 @@ static bool trans_MOV_ra(DisasContext *ctx, arg_MOV_ra *a)
>  /* mov.<bwl> rs,rd */
>  static bool trans_MOV_mm(DisasContext *ctx, arg_MOV_mm *a)
>  {
> -    static void (* const mov[])(TCGv ret, TCGv arg) = {
> -        tcg_gen_ext8s_i32, tcg_gen_ext16s_i32, tcg_gen_mov_i32,
> -    };
>      TCGv tmp, mem, addr;
> +
>      if (a->lds == 3 && a->ldd == 3) {
>          /* mov.<bwl> rs,rd */
> -        mov[a->sz](cpu_regs[a->rd], cpu_regs[a->rs]);
> +        tcg_gen_ext_i32(cpu_regs[a->rd], cpu_regs[a->rs], a->sz | MO_SIGN);
>          return true;
>      }
>  
> @@ -570,10 +568,7 @@ static bool trans_MOVU_mr(DisasContext *ctx, arg_MOVU_mr *a)
>  /* movu.<bw> rs,rd */
>  static bool trans_MOVU_rr(DisasContext *ctx, arg_MOVU_rr *a)
>  {
> -    static void (* const ext[])(TCGv ret, TCGv arg) = {
> -        tcg_gen_ext8u_i32, tcg_gen_ext16u_i32,
> -    };
> -    ext[a->sz](cpu_regs[a->rd], cpu_regs[a->rs]);
> +    tcg_gen_ext_i32(cpu_regs[a->rd], cpu_regs[a->rs], a->sz);
>      return true;
>  }
>  
> -- 
> 2.34.1
> 

-- 
Yosinori Sato

