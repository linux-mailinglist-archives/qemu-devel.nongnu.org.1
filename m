Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id C45D1A4AD13
	for <lists+qemu-devel@lfdr.de>; Sat,  1 Mar 2025 18:22:27 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1toQWg-0003DS-0t; Sat, 01 Mar 2025 12:21:22 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <brian.cain@oss.qualcomm.com>)
 id 1toQWW-0003BC-BD
 for qemu-devel@nongnu.org; Sat, 01 Mar 2025 12:21:13 -0500
Received: from mx0a-0031df01.pphosted.com ([205.220.168.131])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <brian.cain@oss.qualcomm.com>)
 id 1toQWP-0008SB-NE
 for qemu-devel@nongnu.org; Sat, 01 Mar 2025 12:21:10 -0500
Received: from pps.filterd (m0279863.ppops.net [127.0.0.1])
 by mx0a-0031df01.pphosted.com (8.18.1.2/8.18.1.2) with ESMTP id 521G0Saw032117
 for <qemu-devel@nongnu.org>; Sat, 1 Mar 2025 17:21:03 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=qualcomm.com; h=
 cc:content-transfer-encoding:content-type:date:from:in-reply-to
 :message-id:mime-version:references:subject:to; s=qcppdkim1; bh=
 YEymFSi7gxDmCY+MwmluxfHqyQEO07yBAxTBV7A/8/0=; b=jb+HQwmpG5RFPCKs
 GYZzMs530Ct0+Pyr5Af8oYp/U+HigI/3CKGvPwptEuRAFVNTy/g3S77/MrNyOmwV
 7o1doNVv2LnJ0kchJBPienCjin67ub3993dRQvGi+q75/AlVZhjFkAnP2wESBZod
 nehhmsBhCZfAVI+ASF89LMTp8oBn8fSJjBONS1sZBpfM+sHTh6woeUIgHRVmxwg5
 8uuzvXx/aQZKixvbv5BeWD9dcnCdbhqJ6bIkGTPDmh+GJbib5fv+WVeGfjCa3k3S
 8CdXpABHkxZ9h2lxeTbvKi1lnW0p/moy3tz73deYgzIZmXPBYelA+M7pOj0nzzTM
 D/CnOQ==
Received: from mail-pj1-f69.google.com (mail-pj1-f69.google.com
 [209.85.216.69])
 by mx0a-0031df01.pphosted.com (PPS) with ESMTPS id 453tf0h3t8-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT)
 for <qemu-devel@nongnu.org>; Sat, 01 Mar 2025 17:21:03 +0000 (GMT)
Received: by mail-pj1-f69.google.com with SMTP id
 98e67ed59e1d1-2fe86c01f4aso6335989a91.2
 for <qemu-devel@nongnu.org>; Sat, 01 Mar 2025 09:21:03 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20230601; t=1740849662; x=1741454462;
 h=content-transfer-encoding:mime-version:references:in-reply-to
 :message-id:date:subject:cc:to:from:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=YEymFSi7gxDmCY+MwmluxfHqyQEO07yBAxTBV7A/8/0=;
 b=ZMAPKgQwf3O0L3WmMHEpbPicdPDHZJ/z7XC/GazzJQDg44M2dfgoh98TCzDeQkuZ1i
 9y8TJ013loxoPvcMcaNLdrrH9bxX5F2dmJcvTa+ZACTJVmT2BHiJTJVCkmwpWth5qBnX
 Q0GRJGPcjOTnp4UV9miMNOGgjEqTIr3bmN2ofdbU3kbkq1rteJPyT2Ka02JD4nY8bIrM
 uYpZkkLT+s15SgAdh6CyE3kMBRyz3hUD9puMx76QEDkkgZAUfdNwKuBw1rTiekfIFo+I
 EgMdIIu1WbZSIjuB1S2X2+NBEzR4TQ2N+q3ptQd6CVbTun3ib767ZtbP8/i/qMFOcx3L
 8Ayg==
X-Gm-Message-State: AOJu0YzqqeNFCu0/luSclfx1xW537StQefs9JasVDHvTFHKTvGPynFgp
 aR54TPN8fBKntstwHNncFsXsQC5yNp7srh72gmTFInBR88z4itNOHCpFOyQNw8qbJxJMz89Slqt
 mlX29q2gegsRNMbhOyVeFHI9cWeoORi5TXOX8VtV4b06kv/NKyUNGSgD/eKgy7w==
X-Gm-Gg: ASbGncuC5nXqIya0wEBgqUX4yLkWgz9xSRfvmY4j4/BMKFbsJsBRCQiw4pIicKSDhTG
 qBP/ipZ+xvOd0/lKyDtmor4NbtPhAZP1YTN2vElItEUCXcgcK4BDdt9UByQF3q1cJhgz8c+4JM+
 NR8k5wwgU8x+Dwhi2D2pK4PpUVU0Hg7naX5BDrXdbqPYKHx4pHuXcTG4YyS+sQHr1D5T7IyBn2l
 ek74V+CLvQkL2aoCA7xDUKEBVyBXwTzpC6Ed0886NPwT/vOpaHLtWkYoFW05qbnhzvH9eDk9LT4
 /yq1J6kBxq//E6MCsrSOilE30FGgyeIaNFCAeUjIzFYcswEtEcltUNE84DjzwL+c
X-Received: by 2002:a17:90b:2f87:b0:2f2:3efd:96da with SMTP id
 98e67ed59e1d1-2febabf1aeamr12561802a91.24.1740849662080; 
 Sat, 01 Mar 2025 09:21:02 -0800 (PST)
X-Google-Smtp-Source: AGHT+IFUywgFFugDz50MHc+xn9wsL4kFbvfqPBTqCuTclXJ7sYjx6RIMOrwjakV6zlZoYEbP9ozMmw==
X-Received: by 2002:a17:90b:2f87:b0:2f2:3efd:96da with SMTP id
 98e67ed59e1d1-2febabf1aeamr12561763a91.24.1740849661517; 
 Sat, 01 Mar 2025 09:21:01 -0800 (PST)
Received: from hu-bcain-lv.qualcomm.com (Global_NAT1.qualcomm.com.
 [129.46.96.20]) by smtp.gmail.com with ESMTPSA id
 d9443c01a7336-223501f9dacsm51308275ad.83.2025.03.01.09.21.00
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Sat, 01 Mar 2025 09:21:01 -0800 (PST)
From: Brian Cain <brian.cain@oss.qualcomm.com>
To: qemu-devel@nongnu.org
Cc: brian.cain@oss.qualcomm.com, richard.henderson@linaro.org,
 philmd@linaro.org, quic_mathbern@quicinc.com, ale@rev.ng, anjo@rev.ng,
 quic_mliebel@quicinc.com, ltaylorsimpson@gmail.com,
 alex.bennee@linaro.org, quic_mburton@quicinc.com, sidneym@quicinc.com,
 Brian Cain <bcain@quicinc.com>, Paolo Bonzini <pbonzini@redhat.com>
Subject: [PATCH 7/8] hw/hexagon: Define hexagon "virt" machine
Date: Sat,  1 Mar 2025 09:20:44 -0800
Message-Id: <20250301172045.1295412-8-brian.cain@oss.qualcomm.com>
X-Mailer: git-send-email 2.34.1
In-Reply-To: <20250301172045.1295412-1-brian.cain@oss.qualcomm.com>
References: <20250301172045.1295412-1-brian.cain@oss.qualcomm.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
X-Proofpoint-GUID: kAJidwwOw42chFrXdKIN_8eAVUDU3UsS
X-Proofpoint-ORIG-GUID: kAJidwwOw42chFrXdKIN_8eAVUDU3UsS
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.293,Aquarius:18.0.1057,Hydra:6.0.680,FMLib:17.12.68.34
 definitions=2025-03-01_07,2025-02-28_01,2024-11-22_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0
 priorityscore=1501
 suspectscore=0 malwarescore=0 lowpriorityscore=0 mlxlogscore=999
 phishscore=0 adultscore=0 spamscore=0 clxscore=1015 mlxscore=0 bulkscore=0
 impostorscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.19.0-2502100000 definitions=main-2503010140
Received-SPF: pass client-ip=205.220.168.131;
 envelope-from=brian.cain@oss.qualcomm.com; helo=mx0a-0031df01.pphosted.com
X-Spam_score_int: -26
X-Spam_score: -2.7
X-Spam_bar: --
X-Spam_report: (-2.7 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_EF=-0.1, RCVD_IN_DNSWL_LOW=-0.7,
 RCVD_IN_VALIDITY_RPBL_BLOCKED=0.001, RCVD_IN_VALIDITY_SAFE_BLOCKED=0.001,
 SPF_HELO_NONE=0.001, SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

RnJvbTogQnJpYW4gQ2FpbiA8YmNhaW5AcXVpY2luYy5jb20+CgpTaWduZWQtb2ZmLWJ5OiBCcmlh
biBDYWluIDxicmlhbi5jYWluQG9zcy5xdWFsY29tbS5jb20+Ci0tLQogY29uZmlncy9kZXZpY2Vz
L2hleGFnb24tc29mdG1tdS9kZWZhdWx0Lm1hayB8ICAgMSArCiBjb25maWdzL3RhcmdldHMvaGV4
YWdvbi1zb2Z0bW11Lm1hayAgICAgICAgIHwgICAxICsKIGluY2x1ZGUvaHcvaGV4YWdvbi92aXJ0
LmggICAgICAgICAgICAgICAgICAgfCAgNDEgKysKIGh3L2hleGFnb24vdmlydC5jICAgICAgICAg
ICAgICAgICAgICAgICAgICAgfCAzOTUgKysrKysrKysrKysrKysrKysrKysKIHRhcmdldC9oZXhh
Z29uL2NwdS5jICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIGh3L2hleGFnb24vS2Nv
bmZpZyAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDggKwogaHcvaGV4YWdvbi9tZXNvbi5i
dWlsZCAgICAgICAgICAgICAgICAgICAgICB8ICAgMiArCiA3IGZpbGVzIGNoYW5nZWQsIDQ0OSBp
bnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgaW5jbHVkZS9o
dy9oZXhhZ29uL3ZpcnQuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGh3L2hleGFnb24vdmlydC5jCgpk
aWZmIC0tZ2l0IGEvY29uZmlncy9kZXZpY2VzL2hleGFnb24tc29mdG1tdS9kZWZhdWx0Lm1hayBi
L2NvbmZpZ3MvZGV2aWNlcy9oZXhhZ29uLXNvZnRtbXUvZGVmYXVsdC5tYWsKaW5kZXggMDhlNzA5
YWVhNy4uMzdiNGY5ZjMyMyAxMDA2NDQKLS0tIGEvY29uZmlncy9kZXZpY2VzL2hleGFnb24tc29m
dG1tdS9kZWZhdWx0Lm1haworKysgYi9jb25maWdzL2RldmljZXMvaGV4YWdvbi1zb2Z0bW11L2Rl
ZmF1bHQubWFrCkBAIC0zLDUgKzMsNiBAQAogIyBVbmNvbW1lbnQgdGhlIGZvbGxvd2luZyBsaW5l
cyB0byBkaXNhYmxlIHRoZXNlIG9wdGlvbmFsIGRldmljZXM6CiAKICMgQm9hcmRzIGFyZSBzZWxl
Y3RlZCBieSBkZWZhdWx0LCB1bmNvbW1lbnQgdG8ga2VlcCBvdXQgb2YgdGhlIGJ1aWxkLgorIyBD
T05GSUdfSEVYX1ZJUlQ9eQogIyBDT05GSUdfSEVYX0RTUD15CiAjIENPTkZJR19MMlZJQz15CmRp
ZmYgLS1naXQgYS9jb25maWdzL3RhcmdldHMvaGV4YWdvbi1zb2Z0bW11Lm1hayBiL2NvbmZpZ3Mv
dGFyZ2V0cy9oZXhhZ29uLXNvZnRtbXUubWFrCmluZGV4IDhjMjA4YmY0NjguLjlmOGZjYTFkYzEg
MTAwNjQ0Ci0tLSBhL2NvbmZpZ3MvdGFyZ2V0cy9oZXhhZ29uLXNvZnRtbXUubWFrCisrKyBiL2Nv
bmZpZ3MvdGFyZ2V0cy9oZXhhZ29uLXNvZnRtbXUubWFrCkBAIC00LDMgKzQsNCBAQCBUQVJHRVRf
QVJDSD1oZXhhZ29uCiBUQVJHRVRfU1VQUE9SVFNfTVRUQ0c9eQogVEFSR0VUX1hNTF9GSUxFUz1n
ZGIteG1sL2hleGFnb24tY29yZS54bWwgZ2RiLXhtbC9oZXhhZ29uLWh2eC54bWwgZ2RiLXhtbC9o
ZXhhZ29uLXN5cy54bWwKIFRBUkdFVF9MT05HX0JJVFM9MzIKK1RBUkdFVF9ORUVEX0ZEVD15CmRp
ZmYgLS1naXQgYS9pbmNsdWRlL2h3L2hleGFnb24vdmlydC5oIGIvaW5jbHVkZS9ody9oZXhhZ29u
L3ZpcnQuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwLi4wYzE2NWE3ODZk
Ci0tLSAvZGV2L251bGwKKysrIGIvaW5jbHVkZS9ody9oZXhhZ29uL3ZpcnQuaApAQCAtMCwwICsx
LDQxIEBACisvKgorICogRGVmaW5pdGlvbnMgZm9yIGhleGFnb24gdmlydCBib2FyZC4KKyAqCisg
KiBDb3B5cmlnaHQgKGMpIDIwMjQtMjAyNSBRdWFsY29tbSBJbm5vdmF0aW9uIENlbnRlciwgSW5j
LiBBbGwgUmlnaHRzIFJlc2VydmVkLgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0y
LjAtb3ItbGF0ZXIKKyAqLworCisjaWZuZGVmIEhXX0hFWEFHT05WSVJUX0gKKyNkZWZpbmUgSFdf
SEVYQUdPTlZJUlRfSAorCisjaW5jbHVkZSAiaHcvYm9hcmRzLmgiCisjaW5jbHVkZSAidGFyZ2V0
L2hleGFnb24vY3B1LmgiCisKK3N0cnVjdCBIZXhhZ29uVmlydE1hY2hpbmVTdGF0ZSB7CisgICAg
Lyo8IHByaXZhdGUgPiovCisgICAgTWFjaGluZVN0YXRlIHBhcmVudF9vYmo7CisKKyAgICBpbnQg
ZmR0X3NpemU7CisgICAgTWVtb3J5UmVnaW9uICpzeXM7CisgICAgTWVtb3J5UmVnaW9uIGNmZ3Rh
YmxlOworICAgIE1lbW9yeVJlZ2lvbiByYW07CisgICAgTWVtb3J5UmVnaW9uIHRjbTsKKyAgICBN
ZW1vcnlSZWdpb24gdnRjbTsKKyAgICBEZXZpY2VTdGF0ZSAqbDJ2aWM7Cit9OworCit2b2lkIGhl
eGFnb25fbG9hZF9mZHQoY29uc3Qgc3RydWN0IEhleGFnb25WaXJ0TWFjaGluZVN0YXRlICp2bXMp
OworCitlbnVtIHsKKyAgICBWSVJUX1VBUlQwLAorICAgIFZJUlRfUVRNUjAsCisgICAgVklSVF9R
VE1SMSwKKyAgICBWSVJUX0dQVCwKKyAgICBWSVJUX01NSU8sCisgICAgVklSVF9GRFQsCit9Owor
CisjZGVmaW5lIFRZUEVfSEVYQUdPTl9WSVJUX01BQ0hJTkUgTUFDSElORV9UWVBFX05BTUUoInZp
cnQiKQorT0JKRUNUX0RFQ0xBUkVfU0lNUExFX1RZUEUoSGV4YWdvblZpcnRNYWNoaW5lU3RhdGUs
IEhFWEFHT05fVklSVF9NQUNISU5FKQorCisjZW5kaWYgLyogSFdfSEVYQUdPTlZJUlRfSCAqLwpk
aWZmIC0tZ2l0IGEvaHcvaGV4YWdvbi92aXJ0LmMgYi9ody9oZXhhZ29uL3ZpcnQuYwpuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwLi5hMmU0Y2M4YzZjCi0tLSAvZGV2L251bGwK
KysrIGIvaHcvaGV4YWdvbi92aXJ0LmMKQEAgLTAsMCArMSwzOTUgQEAKKy8qCisgKiBIZXhhZ29u
IHZpcnQgZW11bGF0aW9uCisgKgorICogQ29weXJpZ2h0IChjKSAyMDI0LTIwMjUgUXVhbGNvbW0g
SW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAqIFNQRFgtTGlj
ZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9yLWxhdGVyCisgKi8KKworI2luY2x1ZGUgInFlbXUv
b3NkZXAuaCIKKyNpbmNsdWRlICJleGVjL2FkZHJlc3Mtc3BhY2VzLmgiCisjaW5jbHVkZSAiaHcv
Y2hhci9wbDAxMS5oIgorI2luY2x1ZGUgImh3L2NvcmUvc3lzYnVzLWZkdC5oIgorI2luY2x1ZGUg
Imh3L2hleGFnb24vaGV4YWdvbi5oIgorI2luY2x1ZGUgImh3L2hleGFnb24vdmlydC5oIgorI2lu
Y2x1ZGUgImh3L2xvYWRlci5oIgorI2luY2x1ZGUgImh3L3FkZXYtcHJvcGVydGllcy5oIgorI2lu
Y2x1ZGUgImh3L3JlZ2lzdGVyLmgiCisjaW5jbHVkZSAicWVtdS9lcnJvci1yZXBvcnQuaCIKKyNp
bmNsdWRlICJxZW11L2d1ZXN0LXJhbmRvbS5oIgorI2luY2x1ZGUgInFlbXUvdW5pdHMuaCIKKyNp
bmNsdWRlICJlbGYuaCIKKyNpbmNsdWRlICJtYWNoaW5lX2NmZ192NjhuXzEwMjQuaC5pbmMiCisj
aW5jbHVkZSAic3lzdGVtL2RldmljZV90cmVlLmgiCisjaW5jbHVkZSAic3lzdGVtL3Jlc2V0Lmgi
CisjaW5jbHVkZSAic3lzdGVtL3N5c3RlbS5oIgorI2luY2x1ZGUgPGxpYmZkdC5oPgorCitzdGF0
aWMgY29uc3QgaW50IFZJUlRJT19ERVZfQ09VTlQgPSAyOworCitzdGF0aWMgY29uc3QgTWVtTWFw
RW50cnkgYmFzZV9tZW1tYXBbXSA9IHsKKyAgICBbVklSVF9VQVJUMF0gPSB7IDB4MTAwMDAwMDAs
IDB4MDAwMDAyMDAgfSwKKyAgICBbVklSVF9NTUlPXSA9IHsgMHgxMTAwMDAwMCwgMHgxMDAwMDAw
LCB9LAorICAgIFtWSVJUX0dQVF0gPSB7IDB4YWIwMDAwMDAsIDB4MDAwMDEwMDAgfSwKKyAgICBb
VklSVF9GRFRdID0geyAweDk5OTAwMDAwLCAweDAwMDAwMjAwIH0sCit9OworCitzdGF0aWMgY29u
c3QgaW50IGlycW1hcFtdID0geworICAgIFtWSVJUX01NSU9dID0gMTgsIC8qIC4uLnRvIDE4ICsg
VklSVElPX0RFVl9DT1VOVCAtIDEgKi8KKyAgICBbVklSVF9HUFRdID0gMTIsCisgICAgW1ZJUlRf
VUFSVDBdID0gMTUsCisgICAgW1ZJUlRfUVRNUjBdID0gMiwKKyAgICBbVklSVF9RVE1SMV0gPSA0
LAorfTsKKworCitzdGF0aWMgdm9pZCBjcmVhdGVfZmR0KEhleGFnb25WaXJ0TWFjaGluZVN0YXRl
ICp2bXMpCit7CisgICAgTWFjaGluZVN0YXRlICptcyA9IE1BQ0hJTkUodm1zKTsKKyAgICB2b2lk
ICpmZHQgPSBjcmVhdGVfZGV2aWNlX3RyZWUoJnZtcy0+ZmR0X3NpemUpOworCisgICAgaWYgKCFm
ZHQpIHsKKyAgICAgICAgZXJyb3JfcmVwb3J0KCJjcmVhdGVfZGV2aWNlX3RyZWUoKSBmYWlsZWQi
KTsKKyAgICAgICAgZXhpdCgxKTsKKyAgICB9CisKKyAgICBtcy0+ZmR0ID0gZmR0OworCisgICAg
cWVtdV9mZHRfc2V0cHJvcF9zdHJpbmcoZmR0LCAiLyIsICJjb21wYXRpYmxlIiwgImxpbnV4LGhl
eGFnb24tdmlydCIpOworICAgIHFlbXVfZmR0X3NldHByb3BfY2VsbChmZHQsICIvIiwgIiNhZGRy
ZXNzLWNlbGxzIiwgMHgyKTsKKyAgICBxZW11X2ZkdF9zZXRwcm9wX2NlbGwoZmR0LCAiLyIsICIj
c2l6ZS1jZWxscyIsIDB4MSk7CisgICAgcWVtdV9mZHRfc2V0cHJvcF9zdHJpbmcoZmR0LCAiLyIs
ICJtb2RlbCIsICJsaW51eCxoZXhhZ29uLXZpcnQiKTsKKworICAgIHFlbXVfZmR0X3NldHByb3Bf
c3RyaW5nKGZkdCwgIi8iLCAibW9kZWwiLCAiaGV4YWdvbi12aXJ0LHFlbXUiKTsKKyAgICBxZW11
X2ZkdF9zZXRwcm9wX3N0cmluZyhmZHQsICIvIiwgImNvbXBhdGlibGUiLCAicWNvbSxzbTgxNTAi
KTsKKworICAgIHFlbXVfZmR0X2FkZF9zdWJub2RlKGZkdCwgIi9zb2MiKTsKKyAgICBxZW11X2Zk
dF9zZXRwcm9wX2NlbGwoZmR0LCAiL3NvYyIsICIjYWRkcmVzcy1jZWxscyIsIDB4Mik7CisgICAg
cWVtdV9mZHRfc2V0cHJvcF9jZWxsKGZkdCwgIi9zb2MiLCAiI3NpemUtY2VsbHMiLCAweDEpOwor
ICAgIHFlbXVfZmR0X3NldHByb3AoZmR0LCAiL3NvYyIsICJyYW5nZXMiLCBOVUxMLCAwKTsKKwor
ICAgIHFlbXVfZmR0X2FkZF9zdWJub2RlKGZkdCwgIi9jaG9zZW4iKTsKKworICAgIHVpbnQ4X3Qg
cm5nX3NlZWRbMzJdOworICAgIHFlbXVfZ3Vlc3RfZ2V0cmFuZG9tX25vZmFpbChybmdfc2VlZCwg
c2l6ZW9mKHJuZ19zZWVkKSk7CisgICAgcWVtdV9mZHRfc2V0cHJvcChmZHQsICIvY2hvc2VuIiwg
InJuZy1zZWVkIiwgcm5nX3NlZWQsIHNpemVvZihybmdfc2VlZCkpOworfQorCitzdGF0aWMgdm9p
ZCBmZHRfYWRkX2h2eChIZXhhZ29uVmlydE1hY2hpbmVTdGF0ZSAqdm1zLAorICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgaGV4YWdvbl9tYWNoaW5lX2NvbmZpZyAqbV9jZmcsIEVycm9yICoq
ZXJycCkKK3sKKyAgICBjb25zdCBNYWNoaW5lU3RhdGUgKm1zID0gTUFDSElORSh2bXMpOworICAg
IHVpbnQzMl90IHZ0Y21fc2l6ZV9ieXRlcyA9IG1fY2ZnLT5jZmd0YWJsZS52dGNtX3NpemVfa2Ig
KiAxMDI0OworICAgIGlmICh2dGNtX3NpemVfYnl0ZXMgPiAwKSB7CisgICAgICAgIG1lbW9yeV9y
ZWdpb25faW5pdF9yYW0oJnZtcy0+dnRjbSwgTlVMTCwgInZ0Y20ucmFtIiwgdnRjbV9zaXplX2J5
dGVzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycnApOworICAgICAgICBtZW1v
cnlfcmVnaW9uX2FkZF9zdWJyZWdpb24odm1zLT5zeXMsIG1fY2ZnLT5jZmd0YWJsZS52dGNtX2Jh
c2UgPDwgMTYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmdm1zLT52dGNt
KTsKKworICAgICAgICBxZW11X2ZkdF9hZGRfc3Vibm9kZShtcy0+ZmR0LCAiL3NvYy92dGNtIik7
CisgICAgICAgIHFlbXVfZmR0X3NldHByb3Bfc3RyaW5nKG1zLT5mZHQsICIvc29jL3Z0Y20iLCAi
Y29tcGF0aWJsZSIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJxY29tLGhleGFn
b25fdnRjbSIpOworCisgICAgICAgIGFzc2VydChzaXplb2YobV9jZmctPmNmZ3RhYmxlLnZ0Y21f
YmFzZSkgPT0gc2l6ZW9mKHVpbnQzMl90KSk7CisgICAgICAgIHFlbXVfZmR0X3NldHByb3BfY2Vs
bHMobXMtPmZkdCwgIi9zb2MvdnRjbSIsICJyZWciLCAwLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG1fY2ZnLT5jZmd0YWJsZS52dGNtX2Jhc2UgPDwgMTYsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdnRjbV9zaXplX2J5dGVzKTsKKyAgICB9CisKKyAgICBpZiAobV9j
ZmctPmNmZ3RhYmxlLmV4dF9jb250ZXh0cyA+IDApIHsKKyAgICAgICAgcWVtdV9mZHRfYWRkX3N1
Ym5vZGUobXMtPmZkdCwgIi9zb2MvaHZ4Iik7CisgICAgICAgIHFlbXVfZmR0X3NldHByb3Bfc3Ry
aW5nKG1zLT5mZHQsICIvc29jL2h2eCIsICJjb21wYXRpYmxlIiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgInFjb20saGV4YWdvbi1odngiKTsKKyAgICAgICAgcWVtdV9mZHRfc2V0
cHJvcF9jZWxscyhtcy0+ZmR0LCAiL3NvYy9odngiLCAicWNvbSxodngtbWF4LWN0eHRzIiwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtX2NmZy0+Y2ZndGFibGUuZXh0X2NvbnRleHRz
KTsKKyAgICAgICAgcWVtdV9mZHRfc2V0cHJvcF9jZWxscyhtcy0+ZmR0LCAiL3NvYy9odngiLCAi
cWNvbSxodngtdmxlbmd0aCIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbV9jZmct
PmNmZ3RhYmxlLmh2eF92ZWNfbG9nX2xlbmd0aCk7CisgICAgfQorfQorCitzdGF0aWMgaW50MzJf
dCBpcnFfaHZtX2ljX3BoYW5kbGUgPSAtMTsKK3N0YXRpYyB2b2lkIGZkdF9hZGRfaHZtX3BpY19u
b2RlKEhleGFnb25WaXJ0TWFjaGluZVN0YXRlICp2bXMsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBoZXhhZ29uX21hY2hpbmVfY29uZmlnICptX2NmZykKK3sKKyAgICBN
YWNoaW5lU3RhdGUgKm1zID0gTUFDSElORSh2bXMpOworICAgIGlycV9odm1faWNfcGhhbmRsZSA9
IHFlbXVfZmR0X2FsbG9jX3BoYW5kbGUobXMtPmZkdCk7CisKKyAgICBxZW11X2ZkdF9zZXRwcm9w
X2NlbGwobXMtPmZkdCwgIi9zb2MiLCAiaW50ZXJydXB0LXBhcmVudCIsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgIGlycV9odm1faWNfcGhhbmRsZSk7CisKKyAgICBxZW11X2ZkdF9hZGRfc3Vi
bm9kZShtcy0+ZmR0LCAiL3NvYy9pbnRlcnJ1cHQtY29udHJvbGxlciIpOworICAgIHFlbXVfZmR0
X3NldHByb3BfY2VsbChtcy0+ZmR0LCAiL3NvYy9pbnRlcnJ1cHQtY29udHJvbGxlciIsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICIjYWRkcmVzcy1jZWxscyIsIDIpOworICAgIHFlbXVfZmR0
X3NldHByb3BfY2VsbChtcy0+ZmR0LCAiL3NvYy9pbnRlcnJ1cHQtY29udHJvbGxlciIsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICIjaW50ZXJydXB0LWNlbGxzIiwgMik7CisgICAgcWVtdV9m
ZHRfc2V0cHJvcF9zdHJpbmcobXMtPmZkdCwgIi9zb2MvaW50ZXJydXB0LWNvbnRyb2xsZXIiLCAi
Y29tcGF0aWJsZSIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgInFjb20saDItcGljLGh2
bS1waWMiKTsKKyAgICBxZW11X2ZkdF9zZXRwcm9wKG1zLT5mZHQsICIvc29jL2ludGVycnVwdC1j
b250cm9sbGVyIiwKKyAgICAgICAgICAgICAgICAgICAgICJpbnRlcnJ1cHQtY29udHJvbGxlciIs
IE5VTEwsIDApOworICAgIHFlbXVfZmR0X3NldHByb3BfY2VsbChtcy0+ZmR0LCAiL3NvYy9pbnRl
cnJ1cHQtY29udHJvbGxlciIsICJwaGFuZGxlIiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
aXJxX2h2bV9pY19waGFuZGxlKTsKKworICAgIHN5c2J1c19tbWlvX21hcChTWVNfQlVTX0RFVklD
RSh2bXMtPmwydmljKSwgMSwKKyAgICAgICAgICAgICAgICAgICAgbV9jZmctPmNmZ3RhYmxlLmZh
c3RsMnZpY19iYXNlIDw8IDE2KTsKK30KKworCitzdGF0aWMgdm9pZCBmZHRfYWRkX2dwdF9ub2Rl
KEhleGFnb25WaXJ0TWFjaGluZVN0YXRlICp2bXMpCit7CisgICAgZ19hdXRvZnJlZSBjaGFyICpu
YW1lID0gTlVMTDsKKyAgICBNYWNoaW5lU3RhdGUgKm1zID0gTUFDSElORSh2bXMpOworCisgICAg
bmFtZSA9IGdfc3RyZHVwX3ByaW50ZigiL3NvYy9ncHRAJSIgUFJJeDY0LAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgKGludDY0X3QpYmFzZV9tZW1tYXBbVklSVF9HUFRdLmJhc2UpOworICAg
IHFlbXVfZmR0X2FkZF9zdWJub2RlKG1zLT5mZHQsIG5hbWUpOworICAgIHFlbXVfZmR0X3NldHBy
b3Bfc3RyaW5nKG1zLT5mZHQsIG5hbWUsICJjb21wYXRpYmxlIiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAicWNvbSxoMi10aW1lcixodm0tdGltZXIiKTsKKyAgICBxZW11X2ZkdF9zZXRw
cm9wX2NlbGxzKG1zLT5mZHQsIG5hbWUsICJpbnRlcnJ1cHRzIiwgaXJxbWFwW1ZJUlRfR1BUXSwg
MCk7CisgICAgcWVtdV9mZHRfc2V0cHJvcF9jZWxscyhtcy0+ZmR0LCBuYW1lLCAicmVnIiwgMHgw
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZV9tZW1tYXBbVklSVF9HUFRdLmJhc2Us
CisgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlX21lbW1hcFtWSVJUX0dQVF0uc2l6ZSk7
Cit9CisKK3N0YXRpYyBpbnQzMl90IGNsb2NrX3BoYW5kbGUgPSAtMTsKK3N0YXRpYyB2b2lkIGZk
dF9hZGRfY2xvY2tzKGNvbnN0IEhleGFnb25WaXJ0TWFjaGluZVN0YXRlICp2bXMpCit7CisgICAg
TWFjaGluZVN0YXRlICptcyA9IE1BQ0hJTkUodm1zKTsKKyAgICBjbG9ja19waGFuZGxlID0gcWVt
dV9mZHRfYWxsb2NfcGhhbmRsZShtcy0+ZmR0KTsKKyAgICBxZW11X2ZkdF9hZGRfc3Vibm9kZSht
cy0+ZmR0LCAiL2FwYi1wY2xrIik7CisgICAgcWVtdV9mZHRfc2V0cHJvcF9zdHJpbmcobXMtPmZk
dCwgIi9hcGItcGNsayIsICJjb21wYXRpYmxlIiwgImZpeGVkLWNsb2NrIik7CisgICAgcWVtdV9m
ZHRfc2V0cHJvcF9jZWxsKG1zLT5mZHQsICIvYXBiLXBjbGsiLCAiI2Nsb2NrLWNlbGxzIiwgMHgw
KTsKKyAgICBxZW11X2ZkdF9zZXRwcm9wX2NlbGwobXMtPmZkdCwgIi9hcGItcGNsayIsICJjbG9j
ay1mcmVxdWVuY3kiLCAyNDAwMDAwMCk7CisgICAgcWVtdV9mZHRfc2V0cHJvcF9zdHJpbmcobXMt
PmZkdCwgIi9hcGItcGNsayIsICJjbG9jay1vdXRwdXQtbmFtZXMiLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICJjbGsyNG1oeiIpOworICAgIHFlbXVfZmR0X3NldHByb3BfY2VsbChtcy0+
ZmR0LCAiL2FwYi1wY2xrIiwgInBoYW5kbGUiLCBjbG9ja19waGFuZGxlKTsKK30KKworc3RhdGlj
IHZvaWQgZmR0X2FkZF91YXJ0KGNvbnN0IEhleGFnb25WaXJ0TWFjaGluZVN0YXRlICp2bXMsIGlu
dCB1YXJ0KQoreworICAgIGNoYXIgKm5vZGVuYW1lOworICAgIGh3YWRkciBiYXNlID0gYmFzZV9t
ZW1tYXBbdWFydF0uYmFzZTsKKyAgICBod2FkZHIgc2l6ZSA9IGJhc2VfbWVtbWFwW3VhcnRdLnNp
emU7CisgICAgYXNzZXJ0KHVhcnQgPT0gMCk7CisgICAgaW50IGlycSA9IGlycW1hcFtWSVJUX1VB
UlQwICsgdWFydF07CisgICAgY29uc3QgY2hhciBjb21wYXRbXSA9ICJhcm0scGwwMTFcMGFybSxw
cmltZWNlbGwiOworICAgIGNvbnN0IGNoYXIgY2xvY2tuYW1lc1tdID0gInVhcnRjbGtcMGFwYl9w
Y2xrIjsKKyAgICBNYWNoaW5lU3RhdGUgKm1zID0gTUFDSElORSh2bXMpOworCisgICAgcGwwMTFf
Y3JlYXRlKGJhc2UsIHFkZXZfZ2V0X2dwaW9faW4odm1zLT5sMnZpYywgaXJxKSwgc2VyaWFsX2hk
KDApKTsKKworICAgIG5vZGVuYW1lID0gZ19zdHJkdXBfcHJpbnRmKCIvcGwwMTFAJSIgUFJJeDY0
LCBiYXNlKTsKKyAgICBxZW11X2ZkdF9hZGRfc3Vibm9kZShtcy0+ZmR0LCBub2RlbmFtZSk7CisK
KyAgICAvKiBOb3RlIHRoYXQgd2UgY2FuJ3QgdXNlIHNldHByb3Bfc3RyaW5nIGJlY2F1c2Ugb2Yg
dGhlIGVtYmVkZGVkIE5VTCAqLworICAgIHFlbXVfZmR0X3NldHByb3AobXMtPmZkdCwgbm9kZW5h
bWUsICJjb21wYXRpYmxlIiwgY29tcGF0LCBzaXplb2YoY29tcGF0KSk7CisgICAgcWVtdV9mZHRf
c2V0cHJvcF9jZWxscyhtcy0+ZmR0LCBub2RlbmFtZSwgInJlZyIsIDAsIGJhc2UsIHNpemUpOwor
ICAgIHFlbXVfZmR0X3NldHByb3BfY2VsbHMobXMtPmZkdCwgbm9kZW5hbWUsICJpbnRlcnJ1cHRz
IiwgMzIgKyBpcnEsIDApOworICAgIHFlbXVfZmR0X3NldHByb3BfY2VsbHMobXMtPmZkdCwgbm9k
ZW5hbWUsICJjbG9ja3MiLCBjbG9ja19waGFuZGxlLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY2xvY2tfcGhhbmRsZSk7CisgICAgcWVtdV9mZHRfc2V0cHJvcChtcy0+ZmR0LCBub2RlbmFt
ZSwgImNsb2NrLW5hbWVzIiwgY2xvY2tuYW1lcywKKyAgICAgICAgICAgICAgICAgICAgIHNpemVv
ZihjbG9ja25hbWVzKSk7CisgICAgcWVtdV9mZHRfc2V0cHJvcF9jZWxsKG1zLT5mZHQsIG5vZGVu
YW1lLCAiaW50ZXJydXB0LXBhcmVudCIsCisgICAgICAgICAgICAgICAgICAgICAgICAgIGlycV9o
dm1faWNfcGhhbmRsZSk7CisKKyAgICBxZW11X2ZkdF9zZXRwcm9wX3N0cmluZyhtcy0+ZmR0LCAi
L2Nob3NlbiIsICJzdGRvdXQtcGF0aCIsIG5vZGVuYW1lKTsKKyAgICBxZW11X2ZkdF9hZGRfc3Vi
bm9kZShtcy0+ZmR0LCAiL2FsaWFzZXMiKTsKKyAgICBxZW11X2ZkdF9zZXRwcm9wX3N0cmluZyht
cy0+ZmR0LCAiL2FsaWFzZXMiLCAic2VyaWFsMCIsIG5vZGVuYW1lKTsKKworICAgIGdfZnJlZShu
b2RlbmFtZSk7Cit9CisKK3N0YXRpYyB2b2lkIGZkdF9hZGRfY3B1X25vZGVzKGNvbnN0IEhleGFn
b25WaXJ0TWFjaGluZVN0YXRlICp2bXMpCit7CisgICAgTWFjaGluZVN0YXRlICptcyA9IE1BQ0hJ
TkUodm1zKTsKKyAgICBxZW11X2ZkdF9hZGRfc3Vibm9kZShtcy0+ZmR0LCAiL2NwdXMiKTsKKyAg
ICBxZW11X2ZkdF9zZXRwcm9wX2NlbGwobXMtPmZkdCwgIi9jcHVzIiwgIiNhZGRyZXNzLWNlbGxz
IiwgMHgxKTsKKyAgICBxZW11X2ZkdF9zZXRwcm9wX2NlbGwobXMtPmZkdCwgIi9jcHVzIiwgIiNz
aXplLWNlbGxzIiwgMHgwKTsKKworICAgIC8qIGNwdSBub2RlcyAqLworICAgIGZvciAoaW50IG51
bSA9IG1zLT5zbXAuY3B1cyAtIDE7IG51bSA+PSAwOyBudW0tLSkgeworICAgICAgICBjaGFyICpu
b2RlbmFtZSA9IGdfc3RyZHVwX3ByaW50ZigiL2NwdXMvY3B1QCVkIiwgbnVtKTsKKyAgICAgICAg
cWVtdV9mZHRfYWRkX3N1Ym5vZGUobXMtPmZkdCwgbm9kZW5hbWUpOworICAgICAgICBxZW11X2Zk
dF9zZXRwcm9wX3N0cmluZyhtcy0+ZmR0LCBub2RlbmFtZSwgImRldmljZV90eXBlIiwgImNwdSIp
OworICAgICAgICBxZW11X2ZkdF9zZXRwcm9wX2NlbGwobXMtPmZkdCwgbm9kZW5hbWUsICJyZWci
LCBudW0pOworICAgICAgICBxZW11X2ZkdF9zZXRwcm9wX2NlbGwobXMtPmZkdCwgbm9kZW5hbWUs
ICJwaGFuZGxlIiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFlbXVfZmR0X2FsbG9j
X3BoYW5kbGUobXMtPmZkdCkpOworICAgICAgICBnX2ZyZWUobm9kZW5hbWUpOworICAgIH0KK30K
KworCitzdGF0aWMgdm9pZCBmZHRfYWRkX3ZpcnRpb19kZXZpY2VzKGNvbnN0IEhleGFnb25WaXJ0
TWFjaGluZVN0YXRlICp2bXMpCit7CisgICAgTWFjaGluZVN0YXRlICptcyA9IE1BQ0hJTkUodm1z
KTsKKyAgICAvKiBWaXJ0SU8gTU1JTyBkZXZpY2VzICovCisgICAgZm9yIChpbnQgaSA9IDA7IGkg
PCBWSVJUSU9fREVWX0NPVU5UOyBpKyspIHsKKyAgICAgICAgY2hhciAqbm9kZW5hbWU7CisgICAg
ICAgIGludCBpcnEgPSBpcnFtYXBbVklSVF9NTUlPXSArIGk7CisgICAgICAgIHNpemVfdCBzaXpl
ID0gYmFzZV9tZW1tYXBbVklSVF9NTUlPXS5zaXplOworICAgICAgICBod2FkZHIgYmFzZSA9IGJh
c2VfbWVtbWFwW1ZJUlRfTU1JT10uYmFzZSArIGkgKiBzaXplOworCisgICAgICAgIG5vZGVuYW1l
ID0gZ19zdHJkdXBfcHJpbnRmKCIvdmlydGlvX21taW9AJSIgUFJJeDY0LCBiYXNlKTsKKyAgICAg
ICAgcWVtdV9mZHRfYWRkX3N1Ym5vZGUobXMtPmZkdCwgbm9kZW5hbWUpOworICAgICAgICBxZW11
X2ZkdF9zZXRwcm9wX3N0cmluZyhtcy0+ZmR0LCBub2RlbmFtZSwgImNvbXBhdGlibGUiLCAidmly
dGlvLG1taW8iKTsKKyAgICAgICAgcWVtdV9mZHRfc2V0cHJvcF9zaXplZF9jZWxscyhtcy0+ZmR0
LCBub2RlbmFtZSwgInJlZyIsIDIsIGJhc2UsIDEsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc2l6ZSk7CisgICAgICAgIHFlbXVfZmR0X3NldHByb3BfY2VsbHMobXMtPmZk
dCwgbm9kZW5hbWUsICJpbnRlcnJ1cHRzIiwgaXJxLCAwKTsKKyAgICAgICAgcWVtdV9mZHRfc2V0
cHJvcF9jZWxsKG1zLT5mZHQsIG5vZGVuYW1lLCAiaW50ZXJydXB0LXBhcmVudCIsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpcnFfaHZtX2ljX3BoYW5kbGUpOworCisgICAgICAgIHN5
c2J1c19jcmVhdGVfc2ltcGxlKAorICAgICAgICAgICAgInZpcnRpby1tbWlvIiwgYmFzZSwKKyAg
ICAgICAgICAgIHFkZXZfZ2V0X2dwaW9faW4odm1zLT5sMnZpYywgaXJxbWFwW1ZJUlRfTU1JT10g
KyBpKSk7CisKKyAgICAgICAgZ19mcmVlKG5vZGVuYW1lKTsKKyAgICB9Cit9CisKK3N0YXRpYyB2
b2lkIHZpcnRfaW5zdGFuY2VfaW5pdChPYmplY3QgKm9iaikKK3sKKyAgICBIZXhhZ29uVmlydE1h
Y2hpbmVTdGF0ZSAqdm1zID0gSEVYQUdPTl9WSVJUX01BQ0hJTkUob2JqKTsKKworICAgIGNyZWF0
ZV9mZHQodm1zKTsKK30KKwordm9pZCBoZXhhZ29uX2xvYWRfZmR0KGNvbnN0IEhleGFnb25WaXJ0
TWFjaGluZVN0YXRlICp2bXMpCit7CisgICAgTWFjaGluZVN0YXRlICptcyA9IE1BQ0hJTkUodm1z
KTsKKyAgICBod2FkZHIgZmR0X2FkZHIgPSBiYXNlX21lbW1hcFtWSVJUX0ZEVF0uYmFzZTsKKyAg
ICB1aW50MzJfdCBmZHRzaXplID0gdm1zLT5mZHRfc2l6ZTsKKworICAgIC8qIGNvcHkgaW4gdGhl
IGRldmljZSB0cmVlICovCisgICAgcWVtdV9mZHRfZHVtcGR0Yihtcy0+ZmR0LCBmZHRzaXplKTsK
KworICAgIHJvbV9hZGRfYmxvYl9maXhlZF9hcygiZmR0IiwgbXMtPmZkdCwgZmR0c2l6ZSwgZmR0
X2FkZHIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICZhZGRyZXNzX3NwYWNlX21lbW9yeSk7
CisgICAgcWVtdV9yZWdpc3Rlcl9yZXNldF9ub3NuYXBzaG90bG9hZCgKKyAgICAgICAgcWVtdV9m
ZHRfcmFuZG9taXplX3NlZWRzLAorICAgICAgICByb21fcHRyX2Zvcl9hcygmYWRkcmVzc19zcGFj
ZV9tZW1vcnksIGZkdF9hZGRyLCBmZHRzaXplKSk7Cit9CisKK3N0YXRpYyB1aW50NjRfdCBsb2Fk
X2tlcm5lbChjb25zdCBIZXhhZ29uVmlydE1hY2hpbmVTdGF0ZSAqdm1zKQoreworICAgIE1hY2hp
bmVTdGF0ZSAqbXMgPSBNQUNISU5FKHZtcyk7CisgICAgdWludDY0X3QgZW50cnkgPSAwOworICAg
IGlmIChsb2FkX2VsZl9yYW1fc3ltKG1zLT5rZXJuZWxfZmlsZW5hbWUsIE5VTEwsIE5VTEwsIE5V
TEwsIE5VTEwsICZlbnRyeSwKKyAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMLCBOVUxMLCAw
LCBFTV9IRVhBR09OLCAwLCAwLCAmYWRkcmVzc19zcGFjZV9tZW1vcnksCisgICAgICAgICAgICAg
ICAgICAgICAgICAgZmFsc2UsIE5VTEwpID4gMCkgeworICAgICAgICByZXR1cm4gZW50cnk7Cisg
ICAgfQorICAgIGVycm9yX3JlcG9ydCgiZXJyb3IgbG9hZGluZyAnJXMnIiwgbXMtPmtlcm5lbF9m
aWxlbmFtZSk7CisgICAgZXhpdCgxKTsKK30KKworc3RhdGljIHZvaWQgZG9fY3B1X3Jlc2V0KHZv
aWQgKm9wYXF1ZSkKK3sKKyAgICBIZXhhZ29uQ1BVICpjcHUgPSBvcGFxdWU7CisgICAgQ1BVU3Rh
dGUgKmNzID0gQ1BVKGNwdSk7CisgICAgY3B1X3Jlc2V0KGNzKTsKK30KKworc3RhdGljIHZvaWQg
dmlydF9pbml0KE1hY2hpbmVTdGF0ZSAqbXMpCit7CisgICAgSGV4YWdvblZpcnRNYWNoaW5lU3Rh
dGUgKnZtcyA9IEhFWEFHT05fVklSVF9NQUNISU5FKG1zKTsKKyAgICBFcnJvciAqKmVycnAgPSBO
VUxMOworICAgIGNvbnN0IGhleGFnb25fbWFjaGluZV9jb25maWcgKm1fY2ZnID0gJnY2OG5fMTAy
NDsKKworICAgIHFlbXVfZmR0X3NldHByb3Bfc3RyaW5nKG1zLT5mZHQsICIvY2hvc2VuIiwgImJv
b3RhcmdzIiwgbXMtPmtlcm5lbF9jbWRsaW5lKTsKKworICAgIHZtcy0+c3lzID0gZ2V0X3N5c3Rl
bV9tZW1vcnkoKTsKKworICAgIG1lbW9yeV9yZWdpb25faW5pdF9yYW0oJnZtcy0+cmFtLCBOVUxM
LCAiZGRyLnJhbSIsIG1zLT5yYW1fc2l6ZSwgZXJycCk7CisgICAgbWVtb3J5X3JlZ2lvbl9hZGRf
c3VicmVnaW9uKHZtcy0+c3lzLCAweDAsICZ2bXMtPnJhbSk7CisKKyAgICBpZiAobV9jZmctPmwy
dGNtX3NpemUpIHsKKyAgICAgICAgbWVtb3J5X3JlZ2lvbl9pbml0X3JhbSgmdm1zLT50Y20sIE5V
TEwsICJ0Y20ucmFtIiwgbV9jZmctPmwydGNtX3NpemUsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZXJycCk7CisgICAgICAgIG1lbW9yeV9yZWdpb25fYWRkX3N1YnJlZ2lvbih2bXMt
PnN5cywgbV9jZmctPmNmZ3RhYmxlLmwydGNtX2Jhc2UgPDwgMTYsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAmdm1zLT50Y20pOworICAgIH0KKworICAgIG1lbW9yeV9yZWdp
b25faW5pdF9yb20oJnZtcy0+Y2ZndGFibGUsIE5VTEwsICJjb25maWdfdGFibGUucm9tIiwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihtX2NmZy0+Y2ZndGFibGUpLCBlcnJwKTsK
KyAgICBtZW1vcnlfcmVnaW9uX2FkZF9zdWJyZWdpb24odm1zLT5zeXMsIG1fY2ZnLT5jZmdiYXNl
LCAmdm1zLT5jZmd0YWJsZSk7CisgICAgZmR0X2FkZF9odngodm1zLCBtX2NmZywgZXJycCk7Cisg
ICAgY29uc3QgY2hhciAqY3B1X21vZGVsID0gbXMtPmNwdV90eXBlOworCisgICAgaWYgKCFjcHVf
bW9kZWwpIHsKKyAgICAgICAgY3B1X21vZGVsID0gSEVYQUdPTl9DUFVfVFlQRV9OQU1FKCJ2NzMi
KTsKKyAgICB9CisKKyAgICBIZXhhZ29uQ1BVICpjcHVfMCA9IE5VTEw7CisgICAgZm9yIChpbnQg
aSA9IDA7IGkgPCBtcy0+c21wLmNwdXM7IGkrKykgeworICAgICAgICBIZXhhZ29uQ1BVICpjcHUg
PSBIRVhBR09OX0NQVShvYmplY3RfbmV3KG1zLT5jcHVfdHlwZSkpOworICAgICAgICBxZW11X3Jl
Z2lzdGVyX3Jlc2V0KGRvX2NwdV9yZXNldCwgY3B1KTsKKworICAgICAgICBpZiAoaSA9PSAwKSB7
CisgICAgICAgICAgICBjcHVfMCA9IGNwdTsKKyAgICAgICAgICAgIGlmIChtcy0+a2VybmVsX2Zp
bGVuYW1lKSB7CisgICAgICAgICAgICAgICAgdWludDY0X3QgZW50cnkgPSBsb2FkX2tlcm5lbCh2
bXMpOworCisgICAgICAgICAgICAgICAgcWRldl9wcm9wX3NldF91aW50MzIoREVWSUNFKGNwdV8w
KSwgImV4ZWMtc3RhcnQtYWRkciIsIGVudHJ5KTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfQor
ICAgICAgICBxZGV2X3Byb3Bfc2V0X2JpdChERVZJQ0UoY3B1KSwgInN0YXJ0LXBvd2VyZWQtb2Zm
IiwgKGkgIT0gMCkpOworICAgICAgICBxZGV2X3Byb3Bfc2V0X3VpbnQzMihERVZJQ0UoY3B1KSwg
Imh2eC1jb250ZXh0cyIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1fY2ZnLT5jZmd0
YWJsZS5leHRfY29udGV4dHMpOworICAgICAgICBxZGV2X3Byb3Bfc2V0X3VpbnQzMihERVZJQ0Uo
Y3B1KSwgImNvbmZpZy10YWJsZS1hZGRyIiwgbV9jZmctPmNmZ2Jhc2UpOworICAgICAgICBxZGV2
X3Byb3Bfc2V0X3VpbnQzMihERVZJQ0UoY3B1KSwgImwydmljLWJhc2UtYWRkciIsIG1fY2ZnLT5s
MnZpY19iYXNlKTsKKyAgICAgICAgcWRldl9wcm9wX3NldF91aW50MzIoREVWSUNFKGNwdSksICJq
dGxiLWVudHJpZXMiLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtX2NmZy0+Y2ZndGFi
bGUuanRsYl9zaXplX2VudHJpZXMpOworCisgICAgICAgIGlmICghcWRldl9yZWFsaXplX2FuZF91
bnJlZihERVZJQ0UoY3B1KSwgTlVMTCwgZXJycCkpIHsKKyAgICAgICAgICAgIHJldHVybjsKKyAg
ICAgICAgfQorICAgIH0KKyAgICB2bXMtPmwydmljID0gc3lzYnVzX2NyZWF0ZV92YXJhcmdzKAor
ICAgICAgICAibDJ2aWMiLCBtX2NmZy0+bDJ2aWNfYmFzZSwgcWRldl9nZXRfZ3Bpb19pbihERVZJ
Q0UoY3B1XzApLCAwKSwKKyAgICAgICAgcWRldl9nZXRfZ3Bpb19pbihERVZJQ0UoY3B1XzApLCAx
KSwgcWRldl9nZXRfZ3Bpb19pbihERVZJQ0UoY3B1XzApLCAyKSwKKyAgICAgICAgcWRldl9nZXRf
Z3Bpb19pbihERVZJQ0UoY3B1XzApLCAzKSwgcWRldl9nZXRfZ3Bpb19pbihERVZJQ0UoY3B1XzAp
LCA0KSwKKyAgICAgICAgcWRldl9nZXRfZ3Bpb19pbihERVZJQ0UoY3B1XzApLCA1KSwgcWRldl9n
ZXRfZ3Bpb19pbihERVZJQ0UoY3B1XzApLCA2KSwKKyAgICAgICAgcWRldl9nZXRfZ3Bpb19pbihE
RVZJQ0UoY3B1XzApLCA3KSwgTlVMTCk7CisKKyAgICBmZHRfYWRkX2h2bV9waWNfbm9kZSh2bXMs
IG1fY2ZnKTsKKyAgICBmZHRfYWRkX3ZpcnRpb19kZXZpY2VzKHZtcyk7CisgICAgZmR0X2FkZF9j
cHVfbm9kZXModm1zKTsKKyAgICBmZHRfYWRkX2Nsb2Nrcyh2bXMpOworICAgIGZkdF9hZGRfdWFy
dCh2bXMsIFZJUlRfVUFSVDApOworICAgIGZkdF9hZGRfZ3B0X25vZGUodm1zKTsKKworICAgIHJv
bV9hZGRfYmxvYl9maXhlZF9hcygiY29uZmlnX3RhYmxlLnJvbSIsICZtX2NmZy0+Y2ZndGFibGUs
CisgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihtX2NmZy0+Y2ZndGFibGUpLCBtX2Nm
Zy0+Y2ZnYmFzZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgJmFkZHJlc3Nfc3BhY2VfbWVt
b3J5KTsKKworCisgICAgaGV4YWdvbl9sb2FkX2ZkdCh2bXMpOworfQorCisKK3N0YXRpYyB2b2lk
IHZpcnRfY2xhc3NfaW5pdChPYmplY3RDbGFzcyAqb2MsIHZvaWQgKmRhdGEpCit7CisgICAgTWFj
aGluZUNsYXNzICptYyA9IE1BQ0hJTkVfQ0xBU1Mob2MpOworCisgICAgbWMtPmluaXQgPSB2aXJ0
X2luaXQ7CisgICAgbWMtPmRlZmF1bHRfY3B1X3R5cGUgPSBIRVhBR09OX0NQVV9UWVBFX05BTUUo
InY3MyIpOworICAgIG1jLT5kZWZhdWx0X3JhbV9zaXplID0gNCAqIEdpQjsKKyAgICBtYy0+bWF4
X2NwdXMgPSA4OworICAgIG1jLT5kZWZhdWx0X2NwdXMgPSA4OworICAgIG1jLT5pc19kZWZhdWx0
ID0gZmFsc2U7CisgICAgbWMtPmRlZmF1bHRfa2VybmVsX2lycWNoaXBfc3BsaXQgPSBmYWxzZTsK
KyAgICBtYy0+YmxvY2tfZGVmYXVsdF90eXBlID0gSUZfVklSVElPOworICAgIG1jLT5kZWZhdWx0
X2Jvb3Rfb3JkZXIgPSBOVUxMOworICAgIG1jLT5ub19jZHJvbSA9IDE7CisgICAgbWMtPm51bWFf
bWVtX3N1cHBvcnRlZCA9IGZhbHNlOworICAgIG1jLT5kZWZhdWx0X25pYyA9ICJ2aXJ0aW8tbW1p
by1idXMiOworfQorCisKK3N0YXRpYyBjb25zdCBUeXBlSW5mbyB2aXJ0X21hY2hpbmVfdHlwZXNb
XSA9IHsgeworICAgIC5uYW1lID0gVFlQRV9IRVhBR09OX1ZJUlRfTUFDSElORSwKKyAgICAucGFy
ZW50ID0gVFlQRV9NQUNISU5FLAorICAgIC5pbnN0YW5jZV9zaXplID0gc2l6ZW9mKEhleGFnb25W
aXJ0TWFjaGluZVN0YXRlKSwKKyAgICAuY2xhc3NfaW5pdCA9IHZpcnRfY2xhc3NfaW5pdCwKKyAg
ICAuaW5zdGFuY2VfaW5pdCA9IHZpcnRfaW5zdGFuY2VfaW5pdCwKK30gfTsKKworREVGSU5FX1RZ
UEVTKHZpcnRfbWFjaGluZV90eXBlcykKZGlmZiAtLWdpdCBhL3RhcmdldC9oZXhhZ29uL2NwdS5j
IGIvdGFyZ2V0L2hleGFnb24vY3B1LmMKaW5kZXggMzQ5NDBlOWE4NC4uN2Y4ZjcxNmQ2ZCAxMDA2
NDQKLS0tIGEvdGFyZ2V0L2hleGFnb24vY3B1LmMKKysrIGIvdGFyZ2V0L2hleGFnb24vY3B1LmMK
QEAgLTEsNSArMSw1IEBACiAvKgotICogIENvcHlyaWdodChjKSAyMDE5LTIwMjMgUXVhbGNvbW0g
SW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAqICBDb3B5cmln
aHQoYykgMjAxOS0yMDI1IFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCBSaWdo
dHMgUmVzZXJ2ZWQuCiAgKgogICogIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3Ug
Y2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAgKiAgaXQgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKZGlmZiAt
LWdpdCBhL2h3L2hleGFnb24vS2NvbmZpZyBiL2h3L2hleGFnb24vS2NvbmZpZwppbmRleCAzZmMx
NDc1NmU2Li5mM2YwMTE1NzMxIDEwMDY0NAotLS0gYS9ody9oZXhhZ29uL0tjb25maWcKKysrIGIv
aHcvaGV4YWdvbi9LY29uZmlnCkBAIC00LDMgKzQsMTEgQEAgY29uZmlnIEhFWF9EU1AKICAgICBk
ZXBlbmRzIG9uIEhFWEFHT04gJiYgVENHCiAgICAgaW1wbHkgUFRJTUVSCiAgICAgc2VsZWN0IEwy
VklDICAjIFZlY3RvciBQSUMKKworY29uZmlnIEhFWF9WSVJUCisgICAgYm9vbAorICAgIGRlZmF1
bHQgeQorICAgIGRlcGVuZHMgb24gSEVYX0RTUCAmJiBGRFQKKyAgICBzZWxlY3QgREVWSUNFX1RS
RUUKKyAgICBzZWxlY3QgVklSVElPX01NSU8KKyAgICBzZWxlY3QgUEwwMTEKZGlmZiAtLWdpdCBh
L2h3L2hleGFnb24vbWVzb24uYnVpbGQgYi9ody9oZXhhZ29uL21lc29uLmJ1aWxkCmluZGV4IDJl
ZjNkYmNkMzQuLjY0OWFkNmRjMDIgMTAwNjQ0Ci0tLSBhL2h3L2hleGFnb24vbWVzb24uYnVpbGQK
KysrIGIvaHcvaGV4YWdvbi9tZXNvbi5idWlsZApAQCAtMywzICszLDUgQEAgaGV4YWdvbl9zcy5h
ZGQod2hlbjogJ0NPTkZJR19IRVhfRFNQJywgaWZfdHJ1ZTogZmlsZXMoJ2hleGFnb25fZHNwLmMn
LCkpCiAKIGh3X2FyY2ggKz0geydoZXhhZ29uJzogaGV4YWdvbl9zc30KIAoraGV4YWdvbl9zcy5h
ZGQod2hlbjogJ0NPTkZJR19IRVhfVklSVCcsIGlmX3RydWU6IGZpbGVzKCd2aXJ0LmMnLCkpCisK
LS0gCjIuMzQuMQoK

