Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 243DB9567ED
	for <lists+qemu-devel@lfdr.de>; Mon, 19 Aug 2024 12:14:13 +0200 (CEST)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1sfzO6-0007hW-3Q; Mon, 19 Aug 2024 06:13:22 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <prvs=954944eb4=graf@amazon.de>)
 id 1sfzO3-0007gE-SF
 for qemu-devel@nongnu.org; Mon, 19 Aug 2024 06:13:20 -0400
Received: from smtp-fw-52005.amazon.com ([52.119.213.156])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <prvs=954944eb4=graf@amazon.de>)
 id 1sfzO1-0003BS-7s
 for qemu-devel@nongnu.org; Mon, 19 Aug 2024 06:13:19 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.com; i=@amazon.com; q=dns/txt; s=amazon201209;
 t=1724062397; x=1755598397;
 h=message-id:date:mime-version:subject:to:cc:references:
 from:in-reply-to:content-transfer-encoding;
 bh=Kp6QygZ65HD/6J1pPfNm6LnbiMx7IXXPUGbmOWJb9kE=;
 b=RqIBm+2rferZgeeZi7Fhbg4SpwdR1cAmQfU769jJ2QmO68ddKT3E/IVd
 UXrU29YZUYwOTUssO58gnAn5sIC1OF/lpaNz8AXwH8Jr4ukUWO9lSoF47
 NHnCfOCq048RQzzXHFmYgQoCLMfzZ0r24qkK9S3gVQNNWgPC04nP5exDR 0=;
X-IronPort-AV: E=Sophos;i="6.10,158,1719878400"; d="scan'208";a="674652188"
Received: from iad12-co-svc-p1-lb1-vlan3.amazon.com (HELO
 smtpout.prod.us-west-2.prod.farcaster.email.amazon.dev) ([10.43.8.6])
 by smtp-border-fw-52005.iad7.amazon.com with
 ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384; 19 Aug 2024 10:13:13 +0000
Received: from EX19MTAUWC001.ant.amazon.com [10.0.7.35:41256]
 by smtpin.naws.us-west-2.prod.farcaster.email.amazon.dev [10.0.57.153:2525]
 with esmtp (Farcaster)
 id 44f91d43-2780-4960-9ec7-863b71960b98; Mon, 19 Aug 2024 10:13:12 +0000 (UTC)
X-Farcaster-Flow-ID: 44f91d43-2780-4960-9ec7-863b71960b98
Received: from EX19D020UWC004.ant.amazon.com (10.13.138.149) by
 EX19MTAUWC001.ant.amazon.com (10.250.64.174) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA) id 15.2.1258.34;
 Mon, 19 Aug 2024 10:13:12 +0000
Received: from [0.0.0.0] (10.253.83.51) by EX19D020UWC004.ant.amazon.com
 (10.13.138.149) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA) id 15.2.1258.34; Mon, 19 Aug 2024
 10:13:09 +0000
Message-ID: <bffedf65-6046-4264-a2fe-011ff8c58860@amazon.com>
Date: Mon, 19 Aug 2024 12:13:06 +0200
MIME-Version: 1.0
User-Agent: Mozilla Thunderbird
Subject: Re: [PATCH v4 4/6] machine/nitro-enclave: Add built-in Nitro Secure
 Module device
To: Dorjoy Chowdhury <dorjoychy111@gmail.com>, <qemu-devel@nongnu.org>
CC: <agraf@csgraf.de>, <stefanha@redhat.com>, <pbonzini@redhat.com>,
 <slp@redhat.com>, <richard.henderson@linaro.org>, <eduardo@habkost.net>,
 <mst@redhat.com>, <marcel.apfelbaum@gmail.com>, <berrange@redhat.com>,
 <philmd@linaro.org>
References: <20240818114257.21456-1-dorjoychy111@gmail.com>
 <20240818114257.21456-5-dorjoychy111@gmail.com>
Content-Language: en-US
From: Alexander Graf <graf@amazon.com>
In-Reply-To: <20240818114257.21456-5-dorjoychy111@gmail.com>
X-Originating-IP: [10.253.83.51]
X-ClientProxiedBy: EX19D033UWC003.ant.amazon.com (10.13.139.217) To
 EX19D020UWC004.ant.amazon.com (10.13.138.149)
Content-Type: text/plain; charset="utf-8"; format="flowed"
Content-Transfer-Encoding: base64
Received-SPF: pass client-ip=52.119.213.156;
 envelope-from=prvs=954944eb4=graf@amazon.de; helo=smtp-fw-52005.amazon.com
X-Spam_score_int: -41
X-Spam_score: -4.2
X-Spam_bar: ----
X-Spam_report: (-4.2 / 5.0 requ) BAYES_00=-1.9, DKIMWL_WL_HIGH=-0.142,
 DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
 HEADER_FROM_DIFFERENT_DOMAINS=0.249, RCVD_IN_DNSWL_MED=-2.3,
 RCVD_IN_MSPIKE_H4=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_HELO_NONE=0.001,
 SPF_PASS=-0.001, T_SCC_BODY_TEXT_LINE=-0.01,
 UNPARSEABLE_RELAY=0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

SGV5IERvcmpveSwKCk9uIDE4LjA4LjI0IDEzOjQyLCBEb3Jqb3kgQ2hvd2RodXJ5IHdyb3RlOgo+
IEFXUyBOaXRybyBFbmNsYXZlcyBoYXZlIGJ1aWx0LWluIE5pdHJvIFNlY3VyZSBNb2R1bGUgKE5T
TSkgZGV2aWNlIHdoaWNoCj4gaXMgdXNlZCBmb3Igc3RyaXBwZWQgZG93biBUUE0gZnVuY3Rpb25h
bGl0eSBsaWtlIGF0dGVzdGF0aW9uLiBUaGlzIGNvbW1pdAo+IGFkZHMgdGhlIGJ1aWx0LWluIE5T
TSBkZXZpY2UgaW4gdGhlIG5pdHJvLWVuY2xhdmUgbWFjaGluZSB0eXBlLgo+Cj4gSW4gTml0cm8g
RW5jbGF2ZXMsIGFsbCB0aGUgUENScyBzdGFydCBpbiBhIGtub3duIHplcm8gc3RhdGUgYW5kIHRo
ZSBmaXJzdAo+IDE2IFBDUnMgYXJlIGxvY2tlZCBmcm9tIGJvb3QgYW5kIHJlc2VydmVkLiBUaGUg
UENSMCwgUENSMSwgUENSMiBhbmQgUENSOAo+IGNvbnRhaW4gdGhlIFNIQTM4NCBoYXNoZXMgcmVs
YXRlZCB0byB0aGUgRUlGIGZpbGUgdXNlZCB0byBib290IHRoZQo+IFZNIGZvciB2YWxpZGF0aW9u
Lgo+Cj4gU29tZSBvcHRpb25hbCBuaXRyby1lbmNsYXZlIG1hY2hpbmUgb3B0aW9ucyBoYXZlIGJl
ZW4gYWRkZWQ6Cj4gICAgICAtICdpZCc6IEVuY2xhdmUgaWRlbnRpZmllciwgcmVmbGVjdGVkIGlu
IHRoZSBtb2R1bGUtaWQgb2YgdGhlIE5TTQo+IGRldmljZS4gSWYgbm90IHByb3ZpZGVkLCBhIGRl
ZmF1bHQgaWQgd2lsbCBiZSBzZXQuCj4gICAgICAtICdwYXJlbnQtcm9sZSc6IFBhcmVudCBpbnN0
YW5jZSBJQU0gcm9sZSBBUk4sIHJlZmxlY3RlZCBpbiBQQ1IzCj4gb2YgdGhlIE5TTSBkZXZpY2Uu
Cj4gICAgICAtICdwYXJlbnQtaWQnOiBQYXJlbnQgaW5zdGFuY2UgaWRlbnRpZmllciwgcmVmbGVj
dGVkIGluIFBDUjQgb2YgdGhlCj4gTlNNIGRldmljZS4KPgo+IFNpZ25lZC1vZmYtYnk6IERvcmpv
eSBDaG93ZGh1cnkgPGRvcmpveWNoeTExMUBnbWFpbC5jb20+Cj4gLS0tCj4gICBjcnlwdG8vbWVz
b24uYnVpbGQgICAgICAgICAgICAgIHwgICAyICstCj4gICBjcnlwdG8veDUwOS11dGlscy5jICAg
ICAgICAgICAgIHwgIDczICsrKysrKysrKysrCgoKQ2FuIHlvdSBwbGVhc2UgcHV0IHRoaXMgbmV3
IEFQSSBpbnRvIGl0cyBvd24gcGF0Y2ggZmlsZT8KCgo+ICAgaHcvY29yZS9laWYuYyAgICAgICAg
ICAgICAgICAgICB8IDIyNSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLQo+ICAgaHcv
Y29yZS9laWYuaCAgICAgICAgICAgICAgICAgICB8ICAgNSArLQoKClRoZXNlIGNoYW5nZXMgdG8g
ZWlmLmMgc2hvdWxkIGlkZWFsbHkgYWxyZWFkeSBiZSBwYXJ0IG9mIHRoZSBwYXRjaCB0aGF0IApp
bnRyb2R1Y2VzIGVpZi5jIChwYXRjaCAxKSwgbm8/IEluIGZhY3QsIGRvIHlvdSB0aGluayB5b3Ug
Y2FuIG1ha2UgdGhlIAp3aG9sZSBlaWYgbG9naWMgaXRzIG93biBwYXRjaCBmaWxlPwoKCj4gICBo
dy9jb3JlL21lc29uLmJ1aWxkICAgICAgICAgICAgIHwgICA0ICstCj4gICBody9pMzg2L0tjb25m
aWcgICAgICAgICAgICAgICAgIHwgICAxICsKPiAgIGh3L2kzODYvbml0cm9fZW5jbGF2ZS5jICAg
ICAgICAgfCAxNDEgKysrKysrKysrKysrKysrKysrKy0KPiAgIGluY2x1ZGUvY3J5cHRvL3g1MDkt
dXRpbHMuaCAgICAgfCAgMjIgKysrKwo+ICAgaW5jbHVkZS9ody9pMzg2L25pdHJvX2VuY2xhdmUu
aCB8ICAyNiArKysrCj4gICA5IGZpbGVzIGNoYW5nZWQsIDQ3OSBpbnNlcnRpb25zKCspLCAyMCBk
ZWxldGlvbnMoLSkKPiAgIGNyZWF0ZSBtb2RlIDEwMDY0NCBjcnlwdG8veDUwOS11dGlscy5jCj4g
ICBjcmVhdGUgbW9kZSAxMDA2NDQgaW5jbHVkZS9jcnlwdG8veDUwOS11dGlscy5oCj4KPiBkaWZm
IC0tZ2l0IGEvY3J5cHRvL21lc29uLmJ1aWxkIGIvY3J5cHRvL21lc29uLmJ1aWxkCj4gaW5kZXgg
YzQ2ZjljMjJhNy4uMDk2MzMxOTRlZCAxMDA2NDQKPiAtLS0gYS9jcnlwdG8vbWVzb24uYnVpbGQK
PiArKysgYi9jcnlwdG8vbWVzb24uYnVpbGQKPiBAQCAtNjIsNyArNjIsNyBAQCBlbmRpZgo+ICAg
aWYgZ2NyeXB0LmZvdW5kKCkKPiAgICAgdXRpbF9zcy5hZGQoZ2NyeXB0LCBmaWxlcygncmFuZG9t
LWdjcnlwdC5jJykpCj4gICBlbGlmIGdudXRscy5mb3VuZCgpCj4gLSAgdXRpbF9zcy5hZGQoZ251
dGxzLCBmaWxlcygncmFuZG9tLWdudXRscy5jJykpCj4gKyAgdXRpbF9zcy5hZGQoZ251dGxzLCBm
aWxlcygncmFuZG9tLWdudXRscy5jJywgJ3g1MDktdXRpbHMuYycpKQoKCldoYXQgaWYgd2UgZG9u
J3QgaGF2ZSBnbnV0bHMuIFdpbGwgZXZlcnl0aGluZyBzdGlsbCBjb21waWxlIG9yIGRvIHdlIApu
ZWVkIHRvIGFkZCBhbnkgZGVwZW5kZW5jaWVzPwoKCj4gICBlbGlmIGdldF9vcHRpb24oJ3JuZ19u
b25lJykKPiAgICAgdXRpbF9zcy5hZGQoZmlsZXMoJ3JhbmRvbS1ub25lLmMnKSkKPiAgIGVsc2UK
PiBkaWZmIC0tZ2l0IGEvY3J5cHRvL3g1MDktdXRpbHMuYyBiL2NyeXB0by94NTA5LXV0aWxzLmMK
PiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwMDAuLjI0MjJlYjk5NWMKPiAt
LS0gL2Rldi9udWxsCj4gKysrIGIvY3J5cHRvL3g1MDktdXRpbHMuYwo+IEBAIC0wLDAgKzEsNzMg
QEAKPiArLyoKPiArICogWC41MDkgY2VydGlmaWNhdGUgcmVsYXRlZCBoZWxwZXJzCj4gKyAqCj4g
KyAqIENvcHlyaWdodCAoYykgMjAyNCBEb3Jqb3kgQ2hvd2RodXJ5IDxkb3Jqb3ljaHkxMTFAZ21h
aWwuY29tPgo+ICsgKgo+ICsgKiBUaGlzIHdvcmsgaXMgbGljZW5zZWQgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBHTlUgR1BMLCB2ZXJzaW9uIDIgb3IKPiArICogKGF0IHlvdXIgb3B0aW9uKSBhbnkg
bGF0ZXIgdmVyc2lvbi4gIFNlZSB0aGUgQ09QWUlORyBmaWxlIGluIHRoZQo+ICsgKiB0b3AtbGV2
ZWwgZGlyZWN0b3J5Lgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlICJxZW11L29zZGVwLmgiCj4gKyNp
bmNsdWRlICJxYXBpL2Vycm9yLmgiCj4gKyNpbmNsdWRlICJjcnlwdG8veDUwOS11dGlscy5oIgo+
ICsjaW5jbHVkZSA8Z251dGxzL2dudXRscy5oPgo+ICsjaW5jbHVkZSA8Z251dGxzL2NyeXB0by5o
Pgo+ICsjaW5jbHVkZSA8Z251dGxzL3g1MDkuaD4KPiArCj4gK3N0YXRpYyBpbnQgcWNyeXB0b190
b19nbnV0bHNfaGFzaF9hbGdfbWFwW1FDUllQVE9fSEFTSF9BTEdfX01BWF0gPSB7Cj4gKyAgICBb
UUNSWVBUT19IQVNIX0FMR19NRDVdID0gR05VVExTX0RJR19NRDUsCj4gKyAgICBbUUNSWVBUT19I
QVNIX0FMR19TSEExXSA9IEdOVVRMU19ESUdfU0hBMSwKPiArICAgIFtRQ1JZUFRPX0hBU0hfQUxH
X1NIQTIyNF0gPSBHTlVUTFNfRElHX1NIQTIyNCwKPiArICAgIFtRQ1JZUFRPX0hBU0hfQUxHX1NI
QTI1Nl0gPSBHTlVUTFNfRElHX1NIQTI1NiwKPiArICAgIFtRQ1JZUFRPX0hBU0hfQUxHX1NIQTM4
NF0gPSBHTlVUTFNfRElHX1NIQTM4NCwKPiArICAgIFtRQ1JZUFRPX0hBU0hfQUxHX1NIQTUxMl0g
PSBHTlVUTFNfRElHX1NIQTUxMiwKPiArICAgIFtRQ1JZUFRPX0hBU0hfQUxHX1JJUEVNRDE2MF0g
PSBHTlVUTFNfRElHX1JNRDE2MCwKPiArfTsKPiArCj4gK2ludCBxY3J5cHRvX2dldF94NTA5X2Nl
cnRfZmluZ2VycHJpbnQodWludDhfdCAqY2VydCwgc2l6ZV90IHNpemUsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgUUNyeXB0b0hhc2hBbGdvcml0aG0gYWxnLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4X3QgKipyZXN1bHQsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90ICpyZXN1bHRsZW4s
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRXJyb3IgKiplcnJwKQo+
ICt7Cj4gKyAgICBpbnQgcmV0Owo+ICsgICAgZ251dGxzX3g1MDlfY3J0X3QgY3J0Owo+ICsgICAg
Z251dGxzX2RhdHVtX3QgZGF0dW0gPSB7LmRhdGEgPSBjZXJ0LCAuc2l6ZSA9IHNpemV9Owo+ICsK
PiArICAgIGlmIChhbGcgPj0gR19OX0VMRU1FTlRTKHFjcnlwdG9fdG9fZ251dGxzX2hhc2hfYWxn
X21hcCkpIHsKPiArICAgICAgICBlcnJvcl9zZXRnKGVycnAsICJVbmtub3duIGhhc2ggYWxnb3Jp
dGhtIik7Cj4gKyAgICAgICAgcmV0dXJuIC0xOwo+ICsgICAgfQo+ICsKPiArICAgIGdudXRsc194
NTA5X2NydF9pbml0KCZjcnQpOwo+ICsKPiArICAgIGlmIChnbnV0bHNfeDUwOV9jcnRfaW1wb3J0
KGNydCwgJmRhdHVtLCBHTlVUTFNfWDUwOV9GTVRfUEVNKSAhPSAwKSB7Cj4gKyAgICAgICAgZXJy
b3Jfc2V0ZyhlcnJwLCAiRmFpbGVkIHRvIGltcG9ydCBjZXJ0aWZpY2F0ZSIpOwo+ICsgICAgICAg
IGdvdG8gY2xlYW51cDsKPiArICAgIH0KPiArCj4gKyAgICByZXQgPSBnbnV0bHNfaGFzaF9nZXRf
bGVuKHFjcnlwdG9fdG9fZ251dGxzX2hhc2hfYWxnX21hcFthbGddKTsKPiArICAgIGlmICgqcmVz
dWx0bGVuID09IDApIHsKPiArICAgICAgICAqcmVzdWx0bGVuID0gcmV0Owo+ICsgICAgICAgICpy
ZXN1bHQgPSBnX25ldzAodWludDhfdCwgKnJlc3VsdGxlbik7Cj4gKyAgICB9IGVsc2UgaWYgKCpy
ZXN1bHRsZW4gPCByZXQpIHsKPiArICAgICAgICBlcnJvcl9zZXRnKGVycnAsCj4gKyAgICAgICAg
ICAgICAgICAgICAiUmVzdWx0IGJ1ZmZlciBzaXplICV6dSBpcyBzbWFsbGVyIHRoYW4gaGFzaCAl
ZCIsCj4gKyAgICAgICAgICAgICAgICAgICAqcmVzdWx0bGVuLCByZXQpOwo+ICsgICAgICAgIGdv
dG8gY2xlYW51cDsKPiArICAgIH0KPiArCj4gKyAgICBpZiAoZ251dGxzX3g1MDlfY3J0X2dldF9m
aW5nZXJwcmludChjcnQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBxY3J5cHRvX3RvX2dudXRsc19oYXNoX2FsZ19tYXBbYWxnXSwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICpyZXN1bHQsIHJlc3VsdGxlbikgIT0gMCkgewo+ICsg
ICAgICAgIGVycm9yX3NldGcoZXJycCwgIkZhaWxlZCB0byBnZXQgZmluZ2VycHJpbnQgZnJvbSBj
ZXJ0aWZpY2F0ZSIpOwo+ICsgICAgICAgIGdvdG8gY2xlYW51cDsKPiArICAgIH0KPiArCj4gKyAg
ICByZXR1cm4gMDsKPiArCj4gKyBjbGVhbnVwOgo+ICsgICAgZ251dGxzX3g1MDlfY3J0X2RlaW5p
dChjcnQpOwo+ICsgICAgcmV0dXJuIC0xOwo+ICt9Cj4gZGlmZiAtLWdpdCBhL2h3L2NvcmUvZWlm
LmMgYi9ody9jb3JlL2VpZi5jCj4gaW5kZXggNTU1ODg3OWE5Ni4uOGUxNTE0MmQzNiAxMDA2NDQK
PiAtLS0gYS9ody9jb3JlL2VpZi5jCj4gKysrIGIvaHcvY29yZS9laWYuYwo+IEBAIC0xMSw3ICsx
MSwxMCBAQAo+ICAgI2luY2x1ZGUgInFlbXUvb3NkZXAuaCIKPiAgICNpbmNsdWRlICJxZW11L2Jz
d2FwLmgiCj4gICAjaW5jbHVkZSAicWFwaS9lcnJvci5oIgo+ICsjaW5jbHVkZSAiY3J5cHRvL2hh
c2guaCIKPiArI2luY2x1ZGUgImNyeXB0by94NTA5LXV0aWxzLmgiCj4gICAjaW5jbHVkZSA8emxp
Yi5oPiAvKiBmb3IgY3JjMzIgKi8KPiArI2luY2x1ZGUgPGNib3IuaD4KPgo+ICAgI2luY2x1ZGUg
Imh3L2NvcmUvZWlmLmgiCj4KPiBAQCAtMTgwLDExICsxODMsMTAgQEAgc3RhdGljIHZvaWQgc2Fm
ZV91bmxpbmsoY2hhciAqZikKPiAgICAqIFVwb24gc3VjY2VzcywgdGhlIGNhbGxlciBpcyByZXBv
bnNpYmxlIGZvciB1bmxpbmtpbmcgYW5kIGZyZWVpbmcgKmtlcm5lbF9wYXRoCj4gICAgKi8KPiAg
IHN0YXRpYyBib29sIHJlYWRfZWlmX2tlcm5lbChGSUxFICpmLCB1aW50NjRfdCBzaXplLCBjaGFy
ICoqa2VybmVsX3BhdGgsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCAq
Y3JjLCBFcnJvciAqKmVycnApCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50OF90
ICprZXJuZWwsIHVpbnQzMl90ICpjcmMsIEVycm9yICoqZXJycCkKPiAgIHsKPiAgICAgICBzaXpl
X3QgZ290Owo+ICAgICAgIEZJTEUgKnRtcF9maWxlID0gTlVMTDsKPiAtICAgIHVpbnQ4X3QgKmtl
cm5lbCA9IE5VTEw7Cj4KPiAgICAgICAqa2VybmVsX3BhdGggPSBOVUxMOwo+ICAgICAgIGlmICgh
Z2V0X3RtcF9maWxlKCJlaWYta2VybmVsLVhYWFhYWCIsIGtlcm5lbF9wYXRoLCBlcnJwKSkgewo+
IEBAIC0xOTgsNyArMjAwLDYgQEAgc3RhdGljIGJvb2wgcmVhZF9laWZfa2VybmVsKEZJTEUgKmYs
IHVpbnQ2NF90IHNpemUsIGNoYXIgKiprZXJuZWxfcGF0aCwKPiAgICAgICAgICAgZ290byBjbGVh
bnVwOwo+ICAgICAgIH0KPgo+IC0gICAga2VybmVsID0gZ19tYWxsb2Moc2l6ZSk7Cj4gICAgICAg
Z290ID0gZnJlYWQoa2VybmVsLCAxLCBzaXplLCBmKTsKPiAgICAgICBpZiAoKHVpbnQ2NF90KSBn
b3QgIT0gc2l6ZSkgewo+ICAgICAgICAgICBlcnJvcl9zZXRnKGVycnAsICJGYWlsZWQgdG8gcmVh
ZCBFSUYga2VybmVsIHNlY3Rpb24gZGF0YSIpOwo+IEBAIC0yMTMsNyArMjE0LDYgQEAgc3RhdGlj
IGJvb2wgcmVhZF9laWZfa2VybmVsKEZJTEUgKmYsIHVpbnQ2NF90IHNpemUsIGNoYXIgKiprZXJu
ZWxfcGF0aCwKPiAgICAgICB9Cj4KPiAgICAgICAqY3JjID0gY3JjMzIoKmNyYywga2VybmVsLCBz
aXplKTsKPiAtICAgIGdfZnJlZShrZXJuZWwpOwo+ICAgICAgIGZjbG9zZSh0bXBfZmlsZSk7Cj4K
PiAgICAgICByZXR1cm4gdHJ1ZTsKPiBAQCAtMjI1LDcgKzIyNSw2IEBAIHN0YXRpYyBib29sIHJl
YWRfZWlmX2tlcm5lbChGSUxFICpmLCB1aW50NjRfdCBzaXplLCBjaGFyICoqa2VybmVsX3BhdGgs
Cj4gICAgICAgZ19mcmVlKCprZXJuZWxfcGF0aCk7Cj4gICAgICAgKmtlcm5lbF9wYXRoID0gTlVM
TDsKPgo+IC0gICAgZ19mcmVlKGtlcm5lbCk7Cj4gICAgICAgcmV0dXJuIGZhbHNlOwo+ICAgfQo+
Cj4gQEAgLTI0MywyOSArMjQyLDExNSBAQCBzdGF0aWMgYm9vbCByZWFkX2VpZl9jbWRsaW5lKEZJ
TEUgKmYsIHVpbnQ2NF90IHNpemUsIGNoYXIgKmNtZGxpbmUsCj4gICB9Cj4KPiAgIHN0YXRpYyBi
b29sIHJlYWRfZWlmX3JhbWRpc2soRklMRSAqZWlmLCBGSUxFICppbml0cmQsIHVpbnQ2NF90IHNp
emUsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgKmNyYywgRXJyb3Ig
KiplcnJwKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4X3QgKnJhbWRpc2ss
IHVpbnQzMl90ICpjcmMsIEVycm9yICoqZXJycCkKPiAgIHsKPiAgICAgICBzaXplX3QgZ290Owo+
IC0gICAgdWludDhfdCAqcmFtZGlzayA9IGdfbWFsbG9jKHNpemUpOwo+Cj4gICAgICAgZ290ID0g
ZnJlYWQocmFtZGlzaywgMSwgc2l6ZSwgZWlmKTsKPiAgICAgICBpZiAoKHVpbnQ2NF90KSBnb3Qg
IT0gc2l6ZSkgewo+ICAgICAgICAgICBlcnJvcl9zZXRnKGVycnAsICJGYWlsZWQgdG8gcmVhZCBF
SUYgcmFtZGlzayBzZWN0aW9uIGRhdGEiKTsKPiAtICAgICAgICBnb3RvIGNsZWFudXA7Cj4gKyAg
ICAgICAgcmV0dXJuIGZhbHNlOwo+ICAgICAgIH0KPgo+ICAgICAgIGdvdCA9IGZ3cml0ZShyYW1k
aXNrLCAxLCBzaXplLCBpbml0cmQpOwo+ICAgICAgIGlmICgodWludDY0X3QpIGdvdCAhPSBzaXpl
KSB7Cj4gICAgICAgICAgIGVycm9yX3NldGcoZXJycCwgIkZhaWxlZCB0byB3cml0ZSBFSUYgcmFt
ZGlzayBkYXRhIHRvIHRlbXBvcmFyeSBmaWxlIik7Cj4gLSAgICAgICAgZ290byBjbGVhbnVwOwo+
ICsgICAgICAgIHJldHVybiBmYWxzZTsKPiAgICAgICB9Cj4KPiAgICAgICAqY3JjID0gY3JjMzIo
KmNyYywgcmFtZGlzaywgc2l6ZSk7Cj4gLSAgICBnX2ZyZWUocmFtZGlzayk7Cj4gKyAgICByZXR1
cm4gdHJ1ZTsKPiArfQo+ICsKPiArc3RhdGljIGJvb2wgZ2V0X3NpZ25hdHVyZV9maW5nZXJwcmlu
dF9zaGEzODQoRklMRSAqZWlmLCB1aW50NjRfdCBzaXplLAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50OF90ICpzaGEzODQsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90ICpjcmMsCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVycm9yICoqZXJycCkKPiAr
ewo+ICsgICAgc2l6ZV90IGdvdDsKPiArICAgIHVpbnQ4X3QgKnNpZyA9IE5VTEw7Cj4gKyAgICB1
aW50OF90ICpjZXJ0ID0gTlVMTDsKPiArICAgIGNib3JfaXRlbV90ICppdGVtID0gTlVMTDsKPiAr
ICAgIGNib3JfaXRlbV90ICpwY3IwID0gTlVMTDsKPiArICAgIHNpemVfdCBsZW47Cj4gKyAgICBz
aXplX3QgaGFzaF9sZW4gPSA0ODsKPiArICAgIHN0cnVjdCBjYm9yX3BhaXIgKnBhaXI7Cj4gKyAg
ICBzdHJ1Y3QgY2Jvcl9sb2FkX3Jlc3VsdCByZXN1bHQ7Cj4gKwo+ICsgICAgc2lnID0gZ19tYWxs
b2Moc2l6ZSk7Cj4gKyAgICBnb3QgPSBmcmVhZChzaWcsIDEsIHNpemUsIGVpZik7Cj4gKyAgICBp
ZiAoKHVpbnQ2NF90KSBnb3QgIT0gc2l6ZSkgewo+ICsgICAgICAgIGVycm9yX3NldGcoZXJycCwg
IkZhaWxlZCB0byByZWFkIEVJRiBzaWduYXR1cmUgc2VjdGlvbiBkYXRhIik7Cj4gKyAgICAgICAg
Z290byBjbGVhbnVwOwo+ICsgICAgfQo+ICsKPiArICAgICpjcmMgPSBjcmMzMigqY3JjLCBzaWcs
IHNpemUpOwo+ICsKPiArICAgIGl0ZW0gPSBjYm9yX2xvYWQoc2lnLCBzaXplLCAmcmVzdWx0KTsK
PiArICAgIGlmICghaXRlbSB8fCByZXN1bHQuZXJyb3IuY29kZSAhPSBDQk9SX0VSUl9OT05FKSB7
Cj4gKyAgICAgICAgZXJyb3Jfc2V0ZyhlcnJwLCAiRmFpbGVkIHRvIGxvYWQgc2lnbmF0dXJlIHNl
Y3Rpb24gZGF0YSBhcyBDQk9SIik7Cj4gKyAgICAgICAgZ290byBjbGVhbnVwOwo+ICsgICAgfQo+
ICsgICAgaWYgKCFjYm9yX2lzYV9hcnJheShpdGVtKSB8fCBjYm9yX2FycmF5X3NpemUoaXRlbSkg
PCAxKSB7Cj4gKyAgICAgICAgZXJyb3Jfc2V0ZyhlcnJwLCAiSW52YWxpZCBzaWduYXR1cmUgQ0JP
UiIpOwo+ICsgICAgICAgIGdvdG8gY2xlYW51cDsKPiArICAgIH0KPiArICAgIHBjcjAgPSBjYm9y
X2FycmF5X2dldChpdGVtLCAwKTsKPiArICAgIGlmICghcGNyMCkgewo+ICsgICAgICAgIGVycm9y
X3NldGcoZXJycCwgIkZhaWxlZCB0byBnZXQgUENSMCBzaWduYXR1cmUiKTsKPiArICAgICAgICBn
b3RvIGNsZWFudXA7Cj4gKyAgICB9Cj4gKyAgICBpZiAoIWNib3JfaXNhX21hcChwY3IwKSB8fCBj
Ym9yX21hcF9zaXplKHBjcjApICE9IDIpIHsKPiArICAgICAgICBlcnJvcl9zZXRnKGVycnAsICJJ
bnZhbGlkIHNpZ25hdHVyZSBDQk9SIik7Cj4gKyAgICAgICAgZ290byBjbGVhbnVwOwo+ICsgICAg
fQo+ICsgICAgcGFpciA9IGNib3JfbWFwX2hhbmRsZShwY3IwKTsKPiArICAgIGlmICghY2Jvcl9p
c2Ffc3RyaW5nKHBhaXItPmtleSkgfHwgY2Jvcl9zdHJpbmdfbGVuZ3RoKHBhaXItPmtleSkgIT0g
MTkgfHwKPiArICAgICAgICBtZW1jbXAoY2Jvcl9zdHJpbmdfaGFuZGxlKHBhaXItPmtleSksICJz
aWduaW5nX2NlcnRpZmljYXRlIiwgMTkpICE9IDApIHsKPiArICAgICAgICBlcnJvcl9zZXRnKGVy
cnAsICJJbnZhbGlkIHNpZ25hdXRyZSBDQk9SIik7Cj4gKyAgICAgICAgZ290byBjbGVhbnVwOwo+
ICsgICAgfQo+ICsgICAgaWYgKCFjYm9yX2lzYV9hcnJheShwYWlyLT52YWx1ZSkpIHsKPiArICAg
ICAgICBlcnJvcl9zZXRnKGVycnAsICJJbnZhbGlkIHNpZ25hdHVyZSBDQk9SIik7Cj4gKyAgICAg
ICAgZ290byBjbGVhbnVwOwo+ICsgICAgfQo+ICsgICAgbGVuID0gY2Jvcl9hcnJheV9zaXplKHBh
aXItPnZhbHVlKTsKPiArICAgIGlmIChsZW4gPT0gMCkgewo+ICsgICAgICAgIGVycm9yX3NldGco
ZXJycCwgIkludmFsaWQgc2lnbmF0dXJlIENCT1IiKTsKPiArICAgICAgICBnb3RvIGNsZWFudXA7
Cj4gKyAgICB9Cj4gKyAgICBjZXJ0ID0gZ19tYWxsb2MobGVuKTsKPiArICAgIGZvciAoaW50IGkg
PSAwOyBpIDwgbGVuOyArK2kpIHsKPiArICAgICAgICBjYm9yX2l0ZW1fdCAqdG1wID0gY2Jvcl9h
cnJheV9nZXQocGFpci0+dmFsdWUsIGkpOwo+ICsgICAgICAgIGlmICghdG1wKSB7Cj4gKyAgICAg
ICAgICAgIGVycm9yX3NldGcoZXJycCwgIkludmFsaWQgc2lnbmF0dXJlIENCT1IiKTsKPiArICAg
ICAgICAgICAgZ290byBjbGVhbnVwOwo+ICsgICAgICAgIH0KPiArICAgICAgICBpZiAoIWNib3Jf
aXNhX3VpbnQodG1wKSB8fCBjYm9yX2ludF9nZXRfd2lkdGgodG1wKSAhPSBDQk9SX0lOVF84KSB7
Cj4gKyAgICAgICAgICAgIGNib3JfZGVjcmVmKCZ0bXApOwo+ICsgICAgICAgICAgICBlcnJvcl9z
ZXRnKGVycnAsICJJbnZhbGlkIHNpZ25hdHVyZSBDQk9SIik7Cj4gKyAgICAgICAgICAgIGdvdG8g
Y2xlYW51cDsKPiArICAgICAgICB9Cj4gKyAgICAgICAgY2VydFtpXSA9IGNib3JfZ2V0X3VpbnQ4
KHRtcCk7Cj4gKyAgICAgICAgY2Jvcl9kZWNyZWYoJnRtcCk7Cj4gKyAgICB9Cj4gKwo+ICsgICAg
aWYgKHFjcnlwdG9fZ2V0X3g1MDlfY2VydF9maW5nZXJwcmludChjZXJ0LCBsZW4sIFFDUllQVE9f
SEFTSF9BTEdfU0hBMzg0LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAmc2hhMzg0LCAmaGFzaF9sZW4sIGVycnApKSB7Cj4gKyAgICAgICAgZ290byBjbGVhbnVw
Owo+ICsgICAgfQo+ICsKPiAgICAgICByZXR1cm4gdHJ1ZTsKPgo+ICAgIGNsZWFudXA6Cj4gLSAg
ICBnX2ZyZWUocmFtZGlzayk7Cj4gKyAgICBnX2ZyZWUoc2lnKTsKPiArICAgIGdfZnJlZShjZXJ0
KTsKPiArICAgIGlmIChwY3IwKSB7Cj4gKyAgICAgICAgY2Jvcl9kZWNyZWYoJnBjcjApOwo+ICsg
ICAgfQo+ICsgICAgaWYgKGl0ZW0pIHsKPiArICAgICAgICBjYm9yX2RlY3JlZigmaXRlbSk7Cj4g
KyAgICB9Cj4gICAgICAgcmV0dXJuIGZhbHNlOwo+ICAgfQo+Cj4gQEAgLTI5OSw3ICszODQsOSBA
QCBzdGF0aWMgbG9uZyBnZXRfZmlsZV9zaXplKEZJTEUgKmYsIEVycm9yICoqZXJycCkKPiAgICAq
Lwo+ICAgYm9vbCByZWFkX2VpZl9maWxlKGNvbnN0IGNoYXIgKmVpZl9wYXRoLCBjb25zdCBjaGFy
ICptYWNoaW5lX2luaXRyZCwKPiAgICAgICAgICAgICAgICAgICAgICBjaGFyICoqa2VybmVsX3Bh
dGgsIGNoYXIgKippbml0cmRfcGF0aCwgY2hhciAqKmNtZGxpbmUsCj4gLSAgICAgICAgICAgICAg
ICAgICBFcnJvciAqKmVycnApCj4gKyAgICAgICAgICAgICAgICAgICB1aW50OF90ICppbWFnZV9z
aGEzODQsIHVpbnQ4X3QgKmJvb3RzdHJhcF9zaGEzODQsCj4gKyAgICAgICAgICAgICAgICAgICB1
aW50OF90ICphcHBfc2hhMzg0LCB1aW50OF90ICpmaW5nZXJwcmludF9zaGEzODQsCj4gKyAgICAg
ICAgICAgICAgICAgICBib29sICpzaWduYXR1cmVfZm91bmQsIEVycm9yICoqZXJycCkKPiAgIHsK
PiAgICAgICBGSUxFICpmID0gTlVMTDsKPiAgICAgICBGSUxFICptYWNoaW5lX2luaXRyZF9mID0g
TlVMTDsKPiBAQCAtMzA4LDcgKzM5NSwxOSBAQCBib29sIHJlYWRfZWlmX2ZpbGUoY29uc3QgY2hh
ciAqZWlmX3BhdGgsIGNvbnN0IGNoYXIgKm1hY2hpbmVfaW5pdHJkLAo+ICAgICAgIHVpbnQzMl90
IGNyYyA9IDA7Cj4gICAgICAgRWlmSGVhZGVyIGVpZl9oZWFkZXI7Cj4gICAgICAgYm9vbCBzZWVu
X3NlY3Rpb25zW0VJRl9TRUNUSU9OX01BWF0gPSB7ZmFsc2V9Owo+IC0KPiArICAgIC8qIGtlcm5l
bCArIHJhbWRpc2tzICsgY21kbGluZSBzaGEzODQgaGFzaCAqLwo+ICsgICAgc3RydWN0IGlvdmVj
IGltYWdlX2hhc2hfaW92ZWNzW01BWF9TRUNUSU9OUyArIDFdOwo+ICsgICAgaW50IGltYWdlX2hh
c2hfaW92ZWNfY250ID0gMDsKPiArICAgIC8qIGtlcm5lbCArIGJvb3QgcmFtZGlzayArIGNtZGxp
bmUgc2hhMzg0IGhhc2ggKi8KPiArICAgIHN0cnVjdCBpb3ZlYyBib290c3RyYXBfaGFzaF9pb3Zl
Y3NbM107Cj4gKyAgICBpbnQgYm9vdHN0cmFwX2hhc2hfaW92ZWNfY250ID0gMDsKPiArICAgIC8q
IGFwcGxpY2F0aW9uIHJhbWRpc2socykgaGFzaCAqLwo+ICsgICAgc3RydWN0IGlvdmVjIGFwcF9o
YXNoX2lvdmVjc1tNQVhfU0VDVElPTlMgKyAxXTsKPiArICAgIGludCBhcHBfaGFzaF9pb3ZlY19j
bnQgPSAwOwo+ICsgICAgdWludDhfdCAqcHRyID0gTlVMTDsKPiArICAgIHNpemVfdCBkaWdlc3Rf
bGVuOwo+ICsKPiArICAgICpzaWduYXR1cmVfZm91bmQgPSBmYWxzZTsKPiAgICAgICAqa2VybmVs
X3BhdGggPSAqaW5pdHJkX3BhdGggPSAqY21kbGluZSA9IE5VTEw7Cj4KPiAgICAgICBmID0gZm9w
ZW4oZWlmX3BhdGgsICJyYiIpOwo+IEBAIC0zNzMsOCArNDcyLDE4IEBAIGJvb2wgcmVhZF9laWZf
ZmlsZShjb25zdCBjaGFyICplaWZfcGF0aCwgY29uc3QgY2hhciAqbWFjaGluZV9pbml0cmQsCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2VjdGlvbiIpOwo+ICAgICAgICAgICAgICAg
ICAgIGdvdG8gY2xlYW51cDsKPiAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAgICAgIHB0
ciA9IGdfbWFsbG9jKHNlY3Rpb25faGVhZGVyLnNlY3Rpb25fc2l6ZSk7Cj4gKwo+ICsgICAgICAg
ICAgICBpbWFnZV9oYXNoX2lvdmVjc1tpbWFnZV9oYXNoX2lvdmVjX2NudF0uaW92X2Jhc2UgPSBw
dHI7Cj4gKyAgICAgICAgICAgIGltYWdlX2hhc2hfaW92ZWNzW2ltYWdlX2hhc2hfaW92ZWNfY250
KytdLmlvdl9sZW4gPQo+ICsgICAgICAgICAgICAgICAgc2VjdGlvbl9oZWFkZXIuc2VjdGlvbl9z
aXplOwo+ICsgICAgICAgICAgICBib290c3RyYXBfaGFzaF9pb3ZlY3NbYm9vdHN0cmFwX2hhc2hf
aW92ZWNfY250XS5pb3ZfYmFzZSA9IHB0cjsKPiArICAgICAgICAgICAgYm9vdHN0cmFwX2hhc2hf
aW92ZWNzW2Jvb3RzdHJhcF9oYXNoX2lvdmVjX2NudCsrXS5pb3ZfbGVuID0KPiArICAgICAgICAg
ICAgICAgIHNlY3Rpb25faGVhZGVyLnNlY3Rpb25fc2l6ZTsKCgpUaGVzZSBzdXBlciBsb25nIHZh
cmlhYmxlIG5hbWVzIG1ha2UgdGhlIGNvZGUgcmVhbGx5IGRpZmZpY3VsdCB0byByZWFkLiAKSG93
IGFib3V0ICJpb3ZfUENSMCI/IEFsc28sIGlmIHlvdSBtYWtlIHRoaXMgYSBHTGlzdCwgeW91IGRv
bid0IG5lZWQgdG8gCmtlZXAgdHJhY2sgb2YgdGhlIGNvdW50IGFuZCBhbGxvY2F0ZSBhIGxhcmdl
IGNodW5rIG9mIG1lbW9yeSBvbiB0aGUgc3RhY2suCgoKPiArCj4gICAgICAgICAgICAgICBpZiAo
IXJlYWRfZWlmX2tlcm5lbChmLCBzZWN0aW9uX2hlYWRlci5zZWN0aW9uX3NpemUsIGtlcm5lbF9w
YXRoLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmY3JjLCBlcnJwKSkgewo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdHIsICZjcmMsIGVycnApKSB7Cj4g
ICAgICAgICAgICAgICAgICAgZ290byBjbGVhbnVwOwo+ICAgICAgICAgICAgICAgfQo+Cj4gQEAg
LTM4Miw2ICs0OTEsNyBAQCBib29sIHJlYWRfZWlmX2ZpbGUoY29uc3QgY2hhciAqZWlmX3BhdGgs
IGNvbnN0IGNoYXIgKm1hY2hpbmVfaW5pdHJkLAo+ICAgICAgICAgICBjYXNlIEVJRl9TRUNUSU9O
X0NNRExJTkU6Cj4gICAgICAgICAgIHsKPiAgICAgICAgICAgICAgIHVpbnQ2NF90IHNpemU7Cj4g
KyAgICAgICAgICAgIHVpbnQ4X3QgKmNtZGxpbmVfY29weTsKPiAgICAgICAgICAgICAgIGlmIChz
ZWVuX3NlY3Rpb25zW0VJRl9TRUNUSU9OX0NNRExJTkVdKSB7Cj4gICAgICAgICAgICAgICAgICAg
ZXJyb3Jfc2V0ZyhlcnJwLCAiSW52YWxpZCBFSUYgaW1hZ2UuIE1vcmUgdGhhbiAxIGNtZGxpbmUg
Igo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNlY3Rpb24iKTsKPiBAQCAtMzk0LDYg
KzUwNCwxOSBAQCBib29sIHJlYWRfZWlmX2ZpbGUoY29uc3QgY2hhciAqZWlmX3BhdGgsIGNvbnN0
IGNoYXIgKm1hY2hpbmVfaW5pdHJkLAo+ICAgICAgICAgICAgICAgfQo+ICAgICAgICAgICAgICAg
KCpjbWRsaW5lKVtzaXplXSA9ICdcMCc7Cj4KPiArICAgICAgICAgICAgLyoKPiArICAgICAgICAg
ICAgICogV2UgbWFrZSBhIGNvcHkgb2YgJypjbWRsaW5lJyBmb3IgcHV0dGluZyBpdCBpbiBpb3Zl
Y3Mgc28gdGhhdAo+ICsgICAgICAgICAgICAgKiB3ZSBjYW4gZWFzaWx5IGZyZWUgYWxsIHRoZSBp
b3ZlYyBlbnRyaWVzIGxhdGVyIGFzIHdlIGNhbm5vdAo+ICsgICAgICAgICAgICAgKiBmcmVlICcq
Y21kbGluZScgd2hpY2ggaXMgdXNlZCBieSB0aGUgY2FsbGVyLgo+ICsgICAgICAgICAgICAgKi8K
PiArICAgICAgICAgICAgY21kbGluZV9jb3B5ID0gZ19tYWxsb2Moc2l6ZSk7Cj4gKyAgICAgICAg
ICAgIG1lbWNweShjbWRsaW5lX2NvcHksICpjbWRsaW5lLCBzaXplKTsKCgpJcyB0aGlzIGdfbWVt
ZHVwMigpPwoKCj4gKyAgICAgICAgICAgIGltYWdlX2hhc2hfaW92ZWNzW2ltYWdlX2hhc2hfaW92
ZWNfY250XS5pb3ZfYmFzZSA9IGNtZGxpbmVfY29weTsKPiArICAgICAgICAgICAgaW1hZ2VfaGFz
aF9pb3ZlY3NbaW1hZ2VfaGFzaF9pb3ZlY19jbnQrK10uaW92X2xlbiA9IHNpemU7Cj4gKyAgICAg
ICAgICAgIGJvb3RzdHJhcF9oYXNoX2lvdmVjc1tib290c3RyYXBfaGFzaF9pb3ZlY19jbnRdLmlv
dl9iYXNlID0KPiArICAgICAgICAgICAgICAgIGNtZGxpbmVfY29weTsKPiArICAgICAgICAgICAg
Ym9vdHN0cmFwX2hhc2hfaW92ZWNzW2Jvb3RzdHJhcF9oYXNoX2lvdmVjX2NudCsrXS5pb3ZfbGVu
ID0gc2l6ZTsKPiArCj4gICAgICAgICAgICAgICBicmVhazsKPiAgICAgICAgICAgfQo+ICAgICAg
ICAgICBjYXNlIEVJRl9TRUNUSU9OX1JBTURJU0s6Cj4gQEAgLTQxNCwxMyArNTM3LDQxIEBAIGJv
b2wgcmVhZF9laWZfZmlsZShjb25zdCBjaGFyICplaWZfcGF0aCwgY29uc3QgY2hhciAqbWFjaGlu
ZV9pbml0cmQsCj4gICAgICAgICAgICAgICAgICAgfQo+ICAgICAgICAgICAgICAgfQo+Cj4gKyAg
ICAgICAgICAgIHB0ciA9IGdfbWFsbG9jKHNlY3Rpb25faGVhZGVyLnNlY3Rpb25fc2l6ZSk7Cj4g
Kwo+ICsgICAgICAgICAgICBpbWFnZV9oYXNoX2lvdmVjc1tpbWFnZV9oYXNoX2lvdmVjX2NudF0u
aW92X2Jhc2UgPSBwdHI7Cj4gKyAgICAgICAgICAgIGltYWdlX2hhc2hfaW92ZWNzW2ltYWdlX2hh
c2hfaW92ZWNfY250KytdLmlvdl9sZW4gPQo+ICsgICAgICAgICAgICAgICAgc2VjdGlvbl9oZWFk
ZXIuc2VjdGlvbl9zaXplOwo+ICsgICAgICAgICAgICAvKgo+ICsgICAgICAgICAgICAgKiBJZiBp
dCdzIHRoZSBmaXJzdCByYW1kaXNrLCB3ZSBuZWVkIHRvIGhhc2ggaXQgaW50byBib290c3RyYXAs
Cj4gKyAgICAgICAgICAgICAqIG90aGVyd2lzZSB3ZSBuZWVkIHRvIGhhc2ggaXQgaW50byBhcHAu
Cj4gKyAgICAgICAgICAgICAqLwo+ICsgICAgICAgICAgICBpZiAoIXNlZW5fc2VjdGlvbnNbRUlG
X1NFQ1RJT05fUkFNRElTS10pIHsKPiArICAgICAgICAgICAgICAgIGJvb3RzdHJhcF9oYXNoX2lv
dmVjc1tib290c3RyYXBfaGFzaF9pb3ZlY19jbnRdLmlvdl9iYXNlID0gcHRyOwo+ICsgICAgICAg
ICAgICAgICAgYm9vdHN0cmFwX2hhc2hfaW92ZWNzW2Jvb3RzdHJhcF9oYXNoX2lvdmVjX2NudCsr
XS5pb3ZfbGVuID0KPiArICAgICAgICAgICAgICAgICAgICBzZWN0aW9uX2hlYWRlci5zZWN0aW9u
X3NpemU7CgoKU2VlaW5nIGFsbCB0aGVzZSBsb25nIGxpbmVzOiBXaGF0IGlmIHlvdSBqdXN0IGNh
bGxlZCAic2VjdGlvbl9oZWFkZXIiIAoic2VjdGlvbiIgb3IgImhkciIgYW5kICJzZWN0aW9uX3Np
emUiICJsZW4iPwoKCj4gKyAgICAgICAgICAgIH0gZWxzZSB7Cj4gKyAgICAgICAgICAgICAgICBh
cHBfaGFzaF9pb3ZlY3NbYXBwX2hhc2hfaW92ZWNfY250XS5pb3ZfYmFzZSA9IHB0cjsKPiArICAg
ICAgICAgICAgICAgIGFwcF9oYXNoX2lvdmVjc1thcHBfaGFzaF9pb3ZlY19jbnQrK10uaW92X2xl
biA9Cj4gKyAgICAgICAgICAgICAgICAgICAgc2VjdGlvbl9oZWFkZXIuc2VjdGlvbl9zaXplOwo+
ICsgICAgICAgICAgICB9Cj4gKwo+ICAgICAgICAgICAgICAgaWYgKCFyZWFkX2VpZl9yYW1kaXNr
KGYsIGluaXRyZF9wYXRoX2YsIHNlY3Rpb25faGVhZGVyLnNlY3Rpb25fc2l6ZSwKPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICZjcmMsIGVycnApKSB7Cj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBwdHIsICZjcmMsIGVycnApKSB7Cj4gICAgICAgICAgICAg
ICAgICAgZ290byBjbGVhbnVwOwo+ICAgICAgICAgICAgICAgfQo+Cj4gICAgICAgICAgICAgICBi
cmVhazsKPiAgICAgICAgICAgfQo+ICsgICAgICAgIGNhc2UgRUlGX1NFQ1RJT05fU0lHTkFUVVJF
Ogo+ICsgICAgICAgICAgICAqc2lnbmF0dXJlX2ZvdW5kID0gdHJ1ZTsKPiArICAgICAgICAgICAg
aWYgKCFnZXRfc2lnbmF0dXJlX2ZpbmdlcnByaW50X3NoYTM4NChmLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY3Rpb25faGVhZGVyLnNlY3Rp
b25fc2l6ZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBmaW5nZXJwcmludF9zaGEzODQsICZjcmMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJycCkpIHsKPiArICAgICAgICAgICAgICAgIGdv
dG8gY2xlYW51cDsKPiArICAgICAgICAgICAgfQo+ICsgICAgICAgICAgICBicmVhazsKPiAgICAg
ICAgICAgZGVmYXVsdDoKPiAgICAgICAgICAgICAgIC8qIG90aGVyIHNlY3Rpb25zIGluY2x1ZGlu
ZyBpbnZhbGlkIG9yIHVua25vd24gc2VjdGlvbnMgKi8KPiAgICAgICAgICAgewo+IEBAIC00ODMs
MTggKzYzNCw2MCBAQCBib29sIHJlYWRfZWlmX2ZpbGUoY29uc3QgY2hhciAqZWlmX3BhdGgsIGNv
bnN0IGNoYXIgKm1hY2hpbmVfaW5pdHJkLAo+ICAgICAgICAgICAgICAgZ290byBjbGVhbnVwOwo+
ICAgICAgICAgICB9Cj4KPiArICAgICAgICBwdHIgPSBnX21hbGxvYyhtYWNoaW5lX2luaXRyZF9z
aXplKTsKPiArCj4gKyAgICAgICAgaW1hZ2VfaGFzaF9pb3ZlY3NbaW1hZ2VfaGFzaF9pb3ZlY19j
bnRdLmlvdl9iYXNlID0gcHRyOwo+ICsgICAgICAgIGltYWdlX2hhc2hfaW92ZWNzW2ltYWdlX2hh
c2hfaW92ZWNfY250KytdLmlvdl9sZW4gPSBtYWNoaW5lX2luaXRyZF9zaXplOwo+ICsgICAgICAg
IGFwcF9oYXNoX2lvdmVjc1thcHBfaGFzaF9pb3ZlY19jbnRdLmlvdl9iYXNlID0gcHRyOwo+ICsg
ICAgICAgIGFwcF9oYXNoX2lvdmVjc1thcHBfaGFzaF9pb3ZlY19jbnQrK10uaW92X2xlbiA9IG1h
Y2hpbmVfaW5pdHJkX3NpemU7Cj4gKwo+ICAgICAgICAgICBpZiAoIXJlYWRfZWlmX3JhbWRpc2so
bWFjaGluZV9pbml0cmRfZiwgaW5pdHJkX3BhdGhfZiwKPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbWFjaGluZV9pbml0cmRfc2l6ZSwgJmNyYywgZXJycCkpIHsKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbWFjaGluZV9pbml0cmRfc2l6ZSwgcHRyLCAmY3JjLCBlcnJw
KSkgewo+ICAgICAgICAgICAgICAgZ290byBjbGVhbnVwOwo+ICAgICAgICAgICB9Cj4gICAgICAg
fQo+Cj4gKyAgICBkaWdlc3RfbGVuID0gNDg7Cj4gKyAgICBpZiAocWNyeXB0b19oYXNoX2J5dGVz
dihRQ1JZUFRPX0hBU0hfQUxHX1NIQTM4NCwgaW1hZ2VfaGFzaF9pb3ZlY3MsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBpbWFnZV9oYXNoX2lvdmVjX2NudCwgJmltYWdlX3NoYTM4NCwg
JmRpZ2VzdF9sZW4sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJwKSA8IDApIHsK
PiArICAgICAgICBnb3RvIGNsZWFudXA7Cj4gKwo+ICsgICAgfQo+ICsKPiArICAgIGRpZ2VzdF9s
ZW4gPSA0ODsKPiArICAgIGlmIChxY3J5cHRvX2hhc2hfYnl0ZXN2KFFDUllQVE9fSEFTSF9BTEdf
U0hBMzg0LCBib290c3RyYXBfaGFzaF9pb3ZlY3MsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBib290c3RyYXBfaGFzaF9pb3ZlY19jbnQsICZib290c3RyYXBfc2hhMzg0LAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgJmRpZ2VzdF9sZW4sIGVycnApIDwgMCkgewo+ICsgICAg
ICAgIGdvdG8gY2xlYW51cDsKPiArCj4gKyAgICB9Cj4gKwo+ICsgICAgZGlnZXN0X2xlbiA9IDQ4
Owo+ICsgICAgaWYgKHFjcnlwdG9faGFzaF9ieXRlc3YoUUNSWVBUT19IQVNIX0FMR19TSEEzODQs
IGFwcF9oYXNoX2lvdmVjcywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcF9oYXNo
X2lvdmVjX2NudCwgJmFwcF9zaGEzODQsICZkaWdlc3RfbGVuLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZXJycCkgPCAwKSB7Cj4gKyAgICAgICAgZ290byBjbGVhbnVwOwo+ICsKPiAr
ICAgIH0KPiArCj4gKyAgICAvKgo+ICsgICAgICogV2Ugb25seSBuZWVkIHRvIGZyZWUgaW1hZ2Vf
aGFzaF9pb3ZlYyBlbnRyaWVzIGJlY2F1c2UgYm9vdHN0cmFwIGFuZAo+ICsgICAgICogYXBwIGlv
dmVjIGVudHJpZXMgYXJlIHN1YnNldHMgb2YgaW1hZ2VfaGFzaF9pb3ZlYyBlbnRyaWVzLgo+ICsg
ICAgICovCj4gKyAgICBmb3IgKGludCBpID0gMDsgaSA8IGltYWdlX2hhc2hfaW92ZWNfY250OyAr
K2kpIHsKPiArICAgICAgICBnX2ZyZWUoaW1hZ2VfaGFzaF9pb3ZlY3NbaV0uaW92X2Jhc2UpOwo+
ICsgICAgfQo+ICAgICAgIGZjbG9zZShmKTsKPiAgICAgICBmY2xvc2UoaW5pdHJkX3BhdGhfZik7
Cj4gICAgICAgc2FmZV9mY2xvc2UobWFjaGluZV9pbml0cmRfZik7Cj4gICAgICAgcmV0dXJuIHRy
dWU7Cj4KPiAgICBjbGVhbnVwOgo+ICsgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpbWFnZV9oYXNo
X2lvdmVjX2NudDsgKytpKSB7Cj4gKyAgICAgICAgZ19mcmVlKGltYWdlX2hhc2hfaW92ZWNzW2ld
Lmlvdl9iYXNlKTsKPiArICAgIH0KPiArCj4gICAgICAgc2FmZV9mY2xvc2UoZik7Cj4gICAgICAg
c2FmZV9mY2xvc2UoaW5pdHJkX3BhdGhfZik7Cj4gICAgICAgc2FmZV9mY2xvc2UobWFjaGluZV9p
bml0cmRfZik7Cj4gZGlmZiAtLWdpdCBhL2h3L2NvcmUvZWlmLmggYi9ody9jb3JlL2VpZi5oCj4g
aW5kZXggNzA2Mzk3NGQ5My4uZmVkM2NiNTUxNCAxMDA2NDQKPiAtLS0gYS9ody9jb3JlL2VpZi5o
Cj4gKysrIGIvaHcvY29yZS9laWYuaAo+IEBAIC0xMyw3ICsxMywxMCBAQAo+Cj4gICBib29sIHJl
YWRfZWlmX2ZpbGUoY29uc3QgY2hhciAqZWlmX3BhdGgsIGNvbnN0IGNoYXIgKm1hY2hpbmVfaW5p
dHJkLAo+ICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKiprZXJuZWxfcGF0aCwgY2hhciAqKmlu
aXRyZF9wYXRoLAo+IC0gICAgICAgICAgICAgICAgICAgY2hhciAqKmtlcm5lbF9jbWRsaW5lLCBF
cnJvciAqKmVycnApOwo+ICsgICAgICAgICAgICAgICAgICAgY2hhciAqKmtlcm5lbF9jbWRsaW5l
LCB1aW50OF90ICppbWFnZV9zaGEzODQsCj4gKyAgICAgICAgICAgICAgICAgICB1aW50OF90ICpi
b290c3RyYXBfc2hhMzg0LCB1aW50OF90ICphcHBfc2hhMzg0LAo+ICsgICAgICAgICAgICAgICAg
ICAgdWludDhfdCAqZmluZ2VycHJpbnRfc2hhMzg0LCBib29sICpzaWduYXR1cmVfZm91bmQsCj4g
KyAgICAgICAgICAgICAgICAgICBFcnJvciAqKmVycnApOwo+Cj4gICAjZW5kaWYKPgo+IGRpZmYg
LS1naXQgYS9ody9jb3JlL21lc29uLmJ1aWxkIGIvaHcvY29yZS9tZXNvbi5idWlsZAo+IGluZGV4
IGYzMmQxYWQ5NDMuLjhkYzQ1NTJlMzUgMTAwNjQ0Cj4gLS0tIGEvaHcvY29yZS9tZXNvbi5idWls
ZAo+ICsrKyBiL2h3L2NvcmUvbWVzb24uYnVpbGQKPiBAQCAtMTIsNiArMTIsOCBAQCBod2NvcmVf
c3MuYWRkKGZpbGVzKAo+ICAgICAncWRldi1jbG9jay5jJywKPiAgICkpCj4KPiArbGliY2JvciA9
IGRlcGVuZGVuY3koJ2xpYmNib3InLCB2ZXJzaW9uOiAnPj0wLjcuMCcpCj4gKwo+ICAgY29tbW9u
X3NzLmFkZChmaWxlcygnY3B1LWNvbW1vbi5jJykpCj4gICBjb21tb25fc3MuYWRkKGZpbGVzKCdt
YWNoaW5lLXNtcC5jJykpCj4gICBzeXN0ZW1fc3MuYWRkKHdoZW46ICdDT05GSUdfRklUTE9BREVS
JywgaWZfdHJ1ZTogZmlsZXMoJ2xvYWRlci1maXQuYycpKQo+IEBAIC0yNCw3ICsyNiw3IEBAIHN5
c3RlbV9zcy5hZGQod2hlbjogJ0NPTkZJR19SRUdJU1RFUicsIGlmX3RydWU6IGZpbGVzKCdyZWdp
c3Rlci5jJykpCj4gICBzeXN0ZW1fc3MuYWRkKHdoZW46ICdDT05GSUdfU1BMSVRfSVJRJywgaWZf
dHJ1ZTogZmlsZXMoJ3NwbGl0LWlycS5jJykpCj4gICBzeXN0ZW1fc3MuYWRkKHdoZW46ICdDT05G
SUdfWElMSU5YX0FYSScsIGlmX3RydWU6IGZpbGVzKCdzdHJlYW0uYycpKQo+ICAgc3lzdGVtX3Nz
LmFkZCh3aGVuOiAnQ09ORklHX1BMQVRGT1JNX0JVUycsIGlmX3RydWU6IGZpbGVzKCdzeXNidXMt
ZmR0LmMnKSkKPiAtc3lzdGVtX3NzLmFkZCh3aGVuOiAnQ09ORklHX05JVFJPX0VOQ0xBVkUnLCBp
Zl90cnVlOiBbZmlsZXMoJ2VpZi5jJyksIHpsaWJdKQo+ICtzeXN0ZW1fc3MuYWRkKHdoZW46ICdD
T05GSUdfTklUUk9fRU5DTEFWRScsIGlmX3RydWU6IFtmaWxlcygnZWlmLmMnKSwgemxpYiwgbGli
Y2JvciwgZ251dGxzXSkKCgpBaCwgeW91IGFkZCB0aGUgZ251dGxzIGRlcGVuZGVuY3kgaGVyZS4g
R3JlYXQhIEhvd2V2ZXIsIHRoaXMgbWVhbnMgd2UgCm5vdyBtYWtlIGdudXRscyAoYW5kIGxpYmNi
b3IpIGEgbWFuZGF0b3J5IGRlcGVuZGVuY3kgZm9yIHRoZSBkZWZhdWx0IApjb25maWd1cmF0aW9u
LiBEb2VzIGNvbmZpZ3VyZSBrbm93IGFib3V0IHRoYXQ/IEkgYmVsaWV2ZSBiZWZvcmUgZ251dGxz
IAp3YXMgb3B0aW9uYWwsIHJpZ2h0PwoKCkFsZXgKCgoKCgpBbWF6b24gV2ViIFNlcnZpY2VzIERl
dmVsb3BtZW50IENlbnRlciBHZXJtYW55IEdtYkgKS3JhdXNlbnN0ci4gMzgKMTAxMTcgQmVybGlu
Ckdlc2NoYWVmdHNmdWVocnVuZzogQ2hyaXN0aWFuIFNjaGxhZWdlciwgSm9uYXRoYW4gV2Vpc3MK
RWluZ2V0cmFnZW4gYW0gQW10c2dlcmljaHQgQ2hhcmxvdHRlbmJ1cmcgdW50ZXIgSFJCIDI1Nzc2
NCBCClNpdHo6IEJlcmxpbgpVc3QtSUQ6IERFIDM2NSA1MzggNTk3Cg==


