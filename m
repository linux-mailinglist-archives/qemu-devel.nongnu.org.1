Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id DF9FCCCB032
	for <lists+qemu-devel@lfdr.de>; Thu, 18 Dec 2025 09:52:01 +0100 (CET)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1vW9jb-0001rq-SH; Thu, 18 Dec 2025 03:51:44 -0500
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <15927021679@163.com>)
 id 1vW9jU-0001rd-CY
 for qemu-devel@nongnu.org; Thu, 18 Dec 2025 03:51:36 -0500
Received: from m16.mail.163.com ([220.197.31.3])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <15927021679@163.com>)
 id 1vW9jP-0003dF-Bi
 for qemu-devel@nongnu.org; Thu, 18 Dec 2025 03:51:34 -0500
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=163.com;
 s=s110527; h=From:To:Subject:Date:Message-ID:MIME-Version; bh=xZ
 OFWtHE6D36OG96Dtr0/wh+7UDnYEjYk6Ahfch1TUE=; b=hwsZzIwK2FNsJPS2Js
 iqZ/8XNCx1qcnXaoBn3WBjoLr7tgej4I8nZgNytP4ySskJiqJpcleqm2oW1HzKup
 r4susVPJixIy6+qKxFG/6XljBR3pF2ODhG6+GX1atcqFCMImLmyA32a7kAk/oVoh
 WaaKkr2aNN+OTL26jvFmD8La0=
Received: from xwm-TianYi510Pro-14IMB.. (unknown [])
 by gzsmtp3 (Coremail) with SMTP id PigvCgDXnbB+wENpAnaEIA--.24S3;
 Thu, 18 Dec 2025 16:51:19 +0800 (CST)
From: Xiong Weimin <15927021679@163.com>
To: "Michael S . Tsirkin" <mst@redhat.com>,
 David Hildenbrand <david@redhat.com>, Jason Wang <jasowang@redhat.com>,
 Stefano Garzarella <sgarzare@redhat.com>
Cc: qemu-devel@nongnu.org,
	xiongweimin <xiongweimin@kylinos.cn>
Subject: [PATCH] hw/rdma: Implement vhost-user RDMA device with PCI support
Date: Thu, 18 Dec 2025 16:50:02 +0800
Message-ID: <20251218085059.54160-2-15927021679@163.com>
X-Mailer: git-send-email 2.43.0
In-Reply-To: <20251218085059.54160-1-15927021679@163.com>
References: <20251218085059.54160-1-15927021679@163.com>
MIME-Version: 1.0
Content-Transfer-Encoding: base64
X-CM-TRANSID: PigvCgDXnbB+wENpAnaEIA--.24S3
X-Coremail-Antispam: 1Uf129KBjvAXoWftr48Cw1DXFyrJry7Aw4kXrb_yoW5WF13to
 W7Jrya9F4rtw1UCFsY9r17ArW2gFyj9F17Cr4S9rZFqayxJw1DtF97Ka9rJ3yrCr4fK34x
 CryfG3yxGa15AFZ3n29KB7ZKAUJUUUU8529EdanIXcx71UUUUU7v73VFW2AGmfu7bjvjm3
 AaLaJ3UbIYCTnIWIevJa73UjIFyTuYvjxUwhLnUUUUU
X-Originating-IP: [116.128.244.169]
X-CM-SenderInfo: jprvmjixqsilmxzbiqqrwthudrp/xtbC9Ad8BWlDwIcRtwAA3B
Received-SPF: pass client-ip=220.197.31.3; envelope-from=15927021679@163.com;
 helo=m16.mail.163.com
X-Spam_score_int: 0
X-Spam_score: -0.1
X-Spam_bar: /
X-Spam_report: (-0.1 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, DKIM_VALID_EF=-0.1,
 FREEMAIL_ENVFROM_END_DIGIT=0.25, FREEMAIL_FROM=0.001, FROM_LOCAL_DIGITS=0.001,
 FROM_LOCAL_HEX=0.006, MIME_BASE64_TEXT=1.741, RCVD_IN_DNSWL_NONE=-0.0001,
 RCVD_IN_MSPIKE_H4=0.001, RCVD_IN_MSPIKE_WL=0.001,
 RCVD_IN_VALIDITY_RPBL_BLOCKED=0.001, RCVD_IN_VALIDITY_SAFE_BLOCKED=0.001,
 SPF_HELO_NONE=0.001, SPF_PASS=-0.001,
 UNPARSEABLE_RELAY=0.001 autolearn=no autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

RnJvbTogeGlvbmd3ZWltaW4gPHhpb25nd2VpbWluQGt5bGlub3MuY24+CgpUaGlzIGNvbW1pdCBp
bnRyb2R1Y2VzIGEgY29tcGxldGUgdmhvc3QtdXNlciBSRE1BIGRldmljZSBpbXBsZW1lbnRhdGlv
bgppbmNsdWRpbmcgUENJIGludGVyZmFjZSBiaW5kaW5ncy4gVGhlIGltcGxlbWVudGF0aW9uIGVu
YWJsZXMgUkRNQSBvcGVyYXRpb25zCnRocm91Z2ggYSB2aG9zdC11c2VyIGJhY2tlbmQgYW5kIHBy
b3ZpZGVzIGEgUENJIGRldmljZSBpbnRlcmZhY2UgZm9yIGd1ZXN0cy4KCktleSBjb21wb25lbnRz
IGluY2x1ZGVkOgoxLiBQQ0kgZGV2aWNlIGJpbmRpbmcgbGF5ZXI6CiAgIC0gQXV0b21hdGljIE1T
SS1YIHZlY3RvciBhbGxvY2F0aW9uIChxdWV1ZXMgKyAxKQogICAtIFZpcnRpbyAxLjAgY29tcGxp
YW5jZSAobm8gbGVnYWN5IHN1cHBvcnQpCiAgIC0gU3RhbmRhcmQgUmVkIEhhdCB2ZW5kb3IvZGV2
aWNlIElEcwogICAtIEJvb3RpbmRleCBwcm9wZXJ0eSBwYXNzdGhyb3VnaAogICAtIFRyYW5zaXRp
b25hbC9ub24tdHJhbnNpdGlvbmFsIGRldmljZSB2YXJpYW50cwoKMi4gQ29yZSB2aG9zdC11c2Vy
IFJETUEgZGV2aWNlOgogICAtIENoYXJkZXYtYmFzZWQgYmFja2VuZCBjb21tdW5pY2F0aW9uCiAg
IC0gRHluYW1pYyBjb25uZWN0aW9uIG1hbmFnZW1lbnQgd2l0aCByZWNvbm5lY3QKICAgLSAyNTYg
dmlydHF1ZXVlcyAoNTEyIGVudHJpZXMgZWFjaCkKICAgLSBGZWF0dXJlIG5lZ290aWF0aW9uIChW
SVJUSU9fRl9WRVJTSU9OXzEsIElORElSRUNUX0RFU0MsIGV0Yy4pCiAgIC0gQ29uZmlnIHNwYWNl
IGhhbmRsaW5nIHdpdGggbGl2ZSB1cGRhdGVzCiAgIC0gVk0gc3RhdGUgcHJlc2VydmF0aW9uIGZv
ciBtaWdyYXRpb24KICAgLSBHcmFjZWZ1bCBzdGFydC9zdG9wIHNlcXVlbmNlcwogICAtIEhvc3Qg
bm90aWZpZXIgbWFuYWdlbWVudAoKMy4gS2V5IGZ1bmN0aW9uYWxpdGllczoKICAgLSBBdXRvbWF0
aWMgYmFja2VuZCBjb25uZWN0aW9uIG1hbmFnZW1lbnQKICAgLSBDb25maWcgY2hhbmdlIG5vdGlm
aWNhdGlvbiBoYW5kbGluZwogICAtIFF1ZXVlIGVuYWJsZW1lbnQgb24gZ3Vlc3QgYWN0aXZpdHkK
ICAgLSBFcnJvciBoYW5kbGluZyBmb3IgYmFja2VuZCBkaXNjb25uZWN0aW9ucwogICAtIFJlc291
cmNlIGNsZWFudXAgb24gZGV2aWNlIHVucmVhbGl6ZQoKVGhlIGltcGxlbWVudGF0aW9uIGZvbGxv
d3MgdmlydGlvIGFuZCB2aG9zdC11c2VyIHN0YW5kYXJkcywgcHJvdmlkaW5nCmEgZm91bmRhdGlv
biBmb3IgUkRNQSB2aXJ0dWFsaXphdGlvbiB1c2luZyB1c2VyLXNwYWNlIGJhY2tlbmRzLgoKQ0M6
IHFlbXUtZGV2ZWxAbm9uZ251Lm9yZwpTaWduZWQtb2ZmLWJ5OiBYaW9uZyBXZWltaW4gPHhpb25n
d2VpbWluQGt5bGlub3MuY24+CkNoYW5nZS1JZDogSTMyOTkyMTkyODJiYzk4ODAwNDIyZTEzMjI5
ODAwNmVkMWIzNjM3ZGEKLS0tCiBody9yZG1hL0tjb25maWcgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHwgICA1ICsKIGh3L3JkbWEvbWVzb24uYnVpbGQgICAgICAgICAgICAgICAgICAgICAg
ICAgfCAgIDUgKwogaHcvcmRtYS92aG9zdC11c2VyLXJkbWEuYyAgICAgICAgICAgICAgICAgICB8
IDQ2MyArKysrKysrKysrKysrKysrKysrKwogaHcvdmlydGlvL21lc29uLmJ1aWxkICAgICAgICAg
ICAgICAgICAgICAgICB8ICAgMSArCiBody92aXJ0aW8vdmhvc3QtdXNlci1yZG1hLXBjaS5jICAg
ICAgICAgICAgIHwgIDkzICsrKysKIGh3L3ZpcnRpby92aG9zdC11c2VyLmMgICAgICAgICAgICAg
ICAgICAgICAgfCAgMTEgKwogaHcvdmlydGlvL3Zob3N0LmMgICAgICAgICAgICAgICAgICAgICAg
ICAgICB8ICAgMiArCiBody92aXJ0aW8vdmlydGlvLmMgICAgICAgICAgICAgICAgICAgICAgICAg
IHwgICAxICsKIGluY2x1ZGUvaHcvcGNpL3BjaS5oICAgICAgICAgICAgICAgICAgICAgICAgfCAg
IDEgKwogaW5jbHVkZS9ody92aXJ0aW8vdmhvc3QtdXNlci1yZG1hLmggICAgICAgICB8ICA0MyAr
KwogaW5jbHVkZS9ody92aXJ0aW8vdmlydGlvLmggICAgICAgICAgICAgICAgICB8ICAgMiArLQog
aW5jbHVkZS9zdGFuZGFyZC1oZWFkZXJzL2xpbnV4L3ZpcnRpb19pZHMuaCB8ICAgMSArCiBpbmNs
dWRlL3N0YW5kYXJkLWhlYWRlcnMvcmRtYS92aXJ0aW9fcmRtYS5oIHwgIDYwICsrKwogMTMgZmls
ZXMgY2hhbmdlZCwgNjg3IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKIGNyZWF0ZSBtb2Rl
IDEwMDY0NCBody9yZG1hL3Zob3N0LXVzZXItcmRtYS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgaHcv
dmlydGlvL3Zob3N0LXVzZXItcmRtYS1wY2kuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGluY2x1ZGUv
aHcvdmlydGlvL3Zob3N0LXVzZXItcmRtYS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgaW5jbHVkZS9z
dGFuZGFyZC1oZWFkZXJzL3JkbWEvdmlydGlvX3JkbWEuaAoKZGlmZiAtLWdpdCBhL2h3L3JkbWEv
S2NvbmZpZyBiL2h3L3JkbWEvS2NvbmZpZwppbmRleCA4NDAzMjBiZGMwLi4xY2I3ZWU3MmFiIDEw
MDY0NAotLS0gYS9ody9yZG1hL0tjb25maWcKKysrIGIvaHcvcmRtYS9LY29uZmlnCkBAIC0xLDMg
KzEsOCBAQAogY29uZmlnIFZNV19QVlJETUEKICAgICBkZWZhdWx0IHkgaWYgUENJX0RFVklDRVMK
ICAgICBkZXBlbmRzIG9uIFBWUkRNQSAmJiBNU0lfTk9OQlJPS0VOICYmIFZNWE5FVDNfUENJCisK
K2NvbmZpZyBWSE9TVF9VU0VSX1JETUEKKyAgICBib29sCisgICAgZGVmYXVsdCB5IGlmIFZJUlRJ
T19QQ0kKKyAgICBkZXBlbmRzIG9uIFZJUlRJTyAmJiBWSE9TVF9VU0VSICYmIExJTlVYCmRpZmYg
LS1naXQgYS9ody9yZG1hL21lc29uLmJ1aWxkIGIvaHcvcmRtYS9tZXNvbi5idWlsZAppbmRleCAz
NjNjOWI4YzgzLi41MWM0N2IyZDQ0IDEwMDY0NAotLS0gYS9ody9yZG1hL21lc29uLmJ1aWxkCisr
KyBiL2h3L3JkbWEvbWVzb24uYnVpbGQKQEAgLTEwLDMgKzEwLDggQEAgc3BlY2lmaWNfc3MuYWRk
KHdoZW46ICdDT05GSUdfVk1XX1BWUkRNQScsIGlmX3RydWU6IGZpbGVzKAogICAndm13L3B2cmRt
YV9kZXZfcmluZy5jJywKICAgJ3Ztdy9wdnJkbWFfbWFpbi5jJywKICkpCisKKworc3BlY2lmaWNf
c3MuYWRkKHdoZW46ICdDT05GSUdfVkhPU1RfVVNFUl9SRE1BJywgaWZfdHJ1ZTogZmlsZXMoCisg
ICd2aG9zdC11c2VyLXJkbWEuYycsCispKQpkaWZmIC0tZ2l0IGEvaHcvcmRtYS92aG9zdC11c2Vy
LXJkbWEuYyBiL2h3L3JkbWEvdmhvc3QtdXNlci1yZG1hLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMDAwMC4uZTU0YjM0OWVjNAotLS0gL2Rldi9udWxsCisrKyBiL2h3L3JkbWEv
dmhvc3QtdXNlci1yZG1hLmMKQEAgLTAsMCArMSw0NjMgQEAKKy8qCisgKiBSRE1BIGRldmljZSBp
bnRlcmZhY2UKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMjUgS3lsaW5zb2Z0CisgKgorICogQXV0
aG9yczoKKyAqCQlYaW9uZyBXZWltaW4gPHhpb25nd2VpbWluQGt5bGlub3MuY24+CisgKgorICog
VGhpcyB3b3JrIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdQTCwgdmVy
c2lvbiAyIG9yIGxhdGVyLgorICogU2VlIHRoZSBDT1BZSU5HIGZpbGUgaW4gdGhlIHRvcC1sZXZl
bCBkaXJlY3RvcnkuCisgKgorICovCisKKyNpbmNsdWRlICJxZW11L29zZGVwLmgiCisjaW5jbHVk
ZSAicWFwaS9lcnJvci5oIgorI2luY2x1ZGUgInFlbXUvZXJyb3ItcmVwb3J0LmgiCisjaW5jbHVk
ZSAicWVtdS9jdXRpbHMuaCIKKyNpbmNsdWRlICJody9xZGV2LWNvcmUuaCIKKyNpbmNsdWRlICJo
dy9xZGV2LXByb3BlcnRpZXMuaCIKKyNpbmNsdWRlICJody92aXJ0aW8vdmhvc3QuaCIKKyNpbmNs
dWRlICJody92aXJ0aW8vdmhvc3QtdXNlci1yZG1hLmgiCisjaW5jbHVkZSAiaHcvdmlydGlvL3Zp
cnRpby5oIgorI2luY2x1ZGUgImh3L3ZpcnRpby92aXJ0aW8tYnVzLmgiCisjaW5jbHVkZSAiaHcv
dmlydGlvL3ZpcnRpby1hY2Nlc3MuaCIKKyNpbmNsdWRlICJzeXNlbXUvc3lzZW11LmgiCisjaW5j
bHVkZSAic3lzZW11L3J1bnN0YXRlLmgiCisKKyNkZWZpbmUgVkhPU1RfVVNFUl9SRE1BX05VTV9R
VUVVRVMgMjU2CisjZGVmaW5lIFZIT1NUX1VTRVJfUkRNQV9RVUVVRV9TSVpFIDUxMgorCitzdGF0
aWMgY29uc3QgaW50IHVzZXJfZmVhdHVyZV9iaXRzW10gPSB7CisJVklSVElPX0ZfVkVSU0lPTl8x
LAorCVZJUlRJT19SSU5HX0ZfSU5ESVJFQ1RfREVTQywKKwlWSVJUSU9fUklOR19GX0VWRU5UX0lE
WCwKKwlWSVJUSU9fRl9OT1RJRllfT05fRU1QVFksCisJVkhPU1RfSU5WQUxJRF9GRUFUVVJFX0JJ
VAorfTsKKworc3RhdGljIHZvaWQgdmhvc3RfdXNlcl9yZG1hX2V2ZW50KHZvaWQgKm9wYXF1ZSwg
UUVNVUNockV2ZW50IGV2ZW50KTsKKworc3RhdGljIGludCB2aG9zdF91c2VyX3JkbWFfc3RhcnQo
VmlydElPRGV2aWNlICp2ZGV2KQoreworCVZIb3N0VXNlclJkbWEgKnIgPSBWSE9TVF9VU0VSX1JE
TUEodmRldik7CisJQnVzU3RhdGUgKnFidXMgPSBCVVMocWRldl9nZXRfcGFyZW50X2J1cyhERVZJ
Q0UodmRldikpKTsKKwlWaXJ0aW9CdXNDbGFzcyAqayA9IFZJUlRJT19CVVNfR0VUX0NMQVNTKHFi
dXMpOworCWludCBpLCByZXQ7CisKKwlpZiAoIWstPnNldF9ndWVzdF9ub3RpZmllcnMpIHsKKwkJ
ZXJyb3JfcmVwb3J0KCJiaW5kaW5nIGRvZXMgbm90IHN1cHBvcnQgZ3Vlc3Qgbm90aWZpZXJzIik7
CisJCXJldHVybiAtRU5PU1lTOworCX0KKworCXJldCA9IHZob3N0X2Rldl9lbmFibGVfbm90aWZp
ZXJzKCZyLT5kZXYsIHZkZXYpOworCWlmIChyZXQgPCAwKSB7CisJCWVycm9yX3JlcG9ydCgiRXJy
b3IgZW5hYmxpbmcgaG9zdCBub3RpZmllcnM6ICVkIiwgLXJldCk7CisJCXJldHVybiByZXQ7CisJ
fQorCisJcmV0ID0gay0+c2V0X2d1ZXN0X25vdGlmaWVycyhxYnVzLT5wYXJlbnQsIHItPmRldi5u
dnFzLCB0cnVlKTsKKwlpZiAocmV0IDwgMCkgeworCQllcnJvcl9yZXBvcnQoIkVycm9yIGJpbmRp
bmcgZ3Vlc3Qgbm90aWZpZXI6ICVkIiwgLXJldCk7CisJCWdvdG8gZXJyX2hvc3Rfbm90aWZpZXJz
OworCX0KKworCXItPmRldi5hY2tlZF9mZWF0dXJlcyA9IHZkZXYtPmd1ZXN0X2ZlYXR1cmVzOwor
CisJcmV0ID0gdmhvc3RfZGV2X3N0YXJ0KCZyLT5kZXYsIHZkZXYsIHRydWUpOworCWlmIChyZXQg
PCAwKSB7CisJCWVycm9yX3JlcG9ydCgiRXJyb3Igc3RhcnRpbmcgdmhvc3Q6ICVkIiwgLXJldCk7
CisJCWdvdG8gZXJyX2d1ZXN0X25vdGlmaWVyczsKKwl9CisJci0+c3RhcnRlZF92dSA9IHRydWU7
CisKKwlmb3IgKGkgPSAwOyBpIDwgci0+ZGV2Lm52cXM7IGkrKykgeworCQl2aG9zdF92aXJ0cXVl
dWVfbWFzaygmci0+ZGV2LCB2ZGV2LCBpLCBmYWxzZSk7CisJfQorCisJcmV0dXJuIHJldDsKKwor
ZXJyX2d1ZXN0X25vdGlmaWVyczoKKwlrLT5zZXRfZ3Vlc3Rfbm90aWZpZXJzKHFidXMtPnBhcmVu
dCwgci0+ZGV2Lm52cXMsIGZhbHNlKTsKK2Vycl9ob3N0X25vdGlmaWVyczoKKwl2aG9zdF9kZXZf
ZGlzYWJsZV9ub3RpZmllcnMoJnItPmRldiwgdmRldik7CisJcmV0dXJuIHJldDsKK30KKworc3Rh
dGljIHZvaWQgdmhvc3RfdXNlcl9yZG1hX3N0b3AoVmlydElPRGV2aWNlICp2ZGV2KQoreworCVZI
b3N0VXNlclJkbWEgKnIgPSBWSE9TVF9VU0VSX1JETUEodmRldik7CisJQnVzU3RhdGUgKnFidXMg
PSBCVVMocWRldl9nZXRfcGFyZW50X2J1cyhERVZJQ0UodmRldikpKTsKKwlWaXJ0aW9CdXNDbGFz
cyAqayA9IFZJUlRJT19CVVNfR0VUX0NMQVNTKHFidXMpOworCWludCByZXQ7CisKKwlpZiAoIXIt
PnN0YXJ0ZWRfdnUpIHsKKwkJcmV0dXJuOworCX0KKwlyLT5zdGFydGVkX3Z1ID0gZmFsc2U7CisK
KwlpZiAoIWstPnNldF9ndWVzdF9ub3RpZmllcnMpIHsKKwkJcmV0dXJuOworCX0KKworCXZob3N0
X2Rldl9zdG9wKCZyLT5kZXYsIHZkZXYsIHRydWUpOworCisJcmV0ID0gay0+c2V0X2d1ZXN0X25v
dGlmaWVycyhxYnVzLT5wYXJlbnQsIHItPmRldi5udnFzLCBmYWxzZSk7CisJaWYgKHJldCA8IDAp
IHsKKwkJZXJyb3JfcmVwb3J0KCJ2aG9zdCBndWVzdCBub3RpZmllciBjbGVhbnVwIGZhaWxlZDog
JWQiLCByZXQpOworCQlyZXR1cm47CisJfQorCisJdmhvc3RfZGV2X2Rpc2FibGVfbm90aWZpZXJz
KCZyLT5kZXYsIHZkZXYpOworfQorCitzdGF0aWMgaW50IHZob3N0X3VzZXJfcmRtYV9oYW5kbGVf
Y29uZmlnX2NoYW5nZShzdHJ1Y3Qgdmhvc3RfZGV2ICpkZXYpCit7CisJaW50IHJldDsKKwlWSG9z
dFVzZXJSZG1hICpyID0gVkhPU1RfVVNFUl9SRE1BKGRldi0+dmRldik7CisJRXJyb3IgKmxvY2Fs
X2VyciA9IE5VTEw7CisKKwlyZXQgPSB2aG9zdF9kZXZfZ2V0X2NvbmZpZyhkZXYsICh1aW50OF90
ICopJnItPnJkbWFjZmcsCisJCQkJCQkJc2l6ZW9mKHN0cnVjdCB2aXJ0aW9fcmRtYV9jb25maWcp
LCAmbG9jYWxfZXJyKTsKKwlpZiAocmV0IDwgMCkgeworCQllcnJvcl9yZXBvcnQoImdldCBjb25m
aWcgc3BhY2UgZmFpbGVkIik7CisJCXJldHVybiAtMTsKKwl9CisKKwl2aXJ0aW9fbm90aWZ5X2Nv
bmZpZyhkZXYtPnZkZXYpOworCXJldHVybiAwOworfQorCitjb25zdCBWaG9zdERldkNvbmZpZ09w
cyByZG1hX29wcyA9IHsKKwkudmhvc3RfZGV2X2NvbmZpZ19ub3RpZmllciA9IHZob3N0X3VzZXJf
cmRtYV9oYW5kbGVfY29uZmlnX2NoYW5nZSwKK307CisKK3N0YXRpYyBpbnQgdmhvc3RfdXNlcl9y
ZG1hX2Nvbm5lY3QoRGV2aWNlU3RhdGUgKmRldikKK3sKKwlWaXJ0SU9EZXZpY2UgKnZkZXYgPSBW
SVJUSU9fREVWSUNFKGRldik7CisJVkhvc3RVc2VyUmRtYSAqciA9IFZIT1NUX1VTRVJfUkRNQSh2
ZGV2KTsKKwlpbnQgcmV0ID0gMDsKKwlFcnJvciAqbG9jYWxfZXJyID0gTlVMTDsKKworCWluZm9f
cmVwb3J0KCJ2aG9zdF91c2VyX3JkbWE6IHZob3N0IGNvbm5lY3QiKTsKKworCWlmIChyLT5jb25u
ZWN0ZWQpIHsKKwkJcmV0dXJuIDA7CisJfQorCXItPmNvbm5lY3RlZCA9IHRydWU7CisKKwlyLT5k
ZXYubnZxcyA9IHItPm51bV9xdWV1ZXM7CisJci0+ZGV2LnZxcyA9IHItPnZob3N0X3ZxczsKKwly
LT5kZXYudnFfaW5kZXggPSAwOworCXItPmRldi5iYWNrZW5kX2ZlYXR1cmVzID0gMDsKKworCXZo
b3N0X2Rldl9zZXRfY29uZmlnX25vdGlmaWVyKCZyLT5kZXYsICZyZG1hX29wcyk7CisKKwlyZXQg
PSB2aG9zdF9kZXZfaW5pdCgmci0+ZGV2LCAmci0+dmhvc3RfdXNlciwKKwkJCQkJCVZIT1NUX0JB
Q0tFTkRfVFlQRV9VU0VSLCAwLCAmbG9jYWxfZXJyKTsKKwlpZiAocmV0IDwgMCkgeworCQllcnJv
cl9yZXBvcnQoInZob3N0LXVzZXItcmRtYTogdmhvc3QgaW5pdGlhbGl6YXRpb24gZmFpbGVkOiAl
cyIsCisJCQkJCXN0cmVycm9yKC1yZXQpKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwkvKiByZXN0
b3JlIHZob3N0IHN0YXRlICovCisJaWYgKHZpcnRpb19kZXZpY2Vfc3RhcnRlZCh2ZGV2LCB2ZGV2
LT5zdGF0dXMpKSB7CisJCWluZm9fcmVwb3J0KCJ2aG9zdF91c2VyX3JkbWE6IHZob3N0IHNzPyIp
OworCQlyZXQgPSB2aG9zdF91c2VyX3JkbWFfc3RhcnQodmRldik7CisJCWlmIChyZXQgPCAwKSB7
CisJCQllcnJvcl9yZXBvcnQoInZob3N0LXVzZXItcmRtYTogdmhvc3Qgc3RhcnQgZmFpbGVkOiAl
cyIsCisJCQkJCQlzdHJlcnJvcigtcmV0KSk7CisJCQlyZXR1cm4gcmV0OworCQl9CisJfQorCWlu
Zm9fcmVwb3J0KCJ2aG9zdF91c2VyX3JkbWE6IHZob3N0IGNvbm5lY3Qgc3VjY2VzcyIpOworCXJl
dHVybiAwOworfQorCitzdGF0aWMgdm9pZCB2aG9zdF91c2VyX3JkbWFfZGlzY29ubmVjdChEZXZp
Y2VTdGF0ZSAqZGV2KQoreworCVZpcnRJT0RldmljZSAqdmRldiA9IFZJUlRJT19ERVZJQ0UoZGV2
KTsKKwlWSG9zdFVzZXJSZG1hICpzID0gVkhPU1RfVVNFUl9SRE1BKHZkZXYpOworCisJaWYgKCFz
LT5jb25uZWN0ZWQpIHsKKwkJcmV0dXJuOworCX0KKwlzLT5jb25uZWN0ZWQgPSBmYWxzZTsKKwor
CXZob3N0X3VzZXJfcmRtYV9zdG9wKHZkZXYpOworCisJdmhvc3RfZGV2X2NsZWFudXAoJnMtPmRl
dik7Cit9CisKK3N0YXRpYyB2b2lkIHZob3N0X3VzZXJfcmRtYV9jaHJfY2xvc2VkX2JoKHZvaWQg
Km9wYXF1ZSkKK3sKKwlEZXZpY2VTdGF0ZSAqZGV2ID0gb3BhcXVlOworCVZpcnRJT0RldmljZSAq
dmRldiA9IFZJUlRJT19ERVZJQ0UoZGV2KTsKKwlWSG9zdFVzZXJSZG1hICpyID0gVkhPU1RfVVNF
Ul9SRE1BKHZkZXYpOworCisJdmhvc3RfdXNlcl9yZG1hX2Rpc2Nvbm5lY3QoZGV2KTsKKwlxZW11
X2Nocl9mZV9zZXRfaGFuZGxlcnMoJnItPmNoYXJkZXYsIE5VTEwsIE5VTEwsIHZob3N0X3VzZXJf
cmRtYV9ldmVudCwKKwkJCU5VTEwsIG9wYXF1ZSwgTlVMTCwgdHJ1ZSk7Cit9CisKK3N0YXRpYyB2
b2lkIHZob3N0X3VzZXJfcmRtYV9ldmVudCh2b2lkICpvcGFxdWUsIFFFTVVDaHJFdmVudCBldmVu
dCkKK3sKKwlEZXZpY2VTdGF0ZSAqZGV2ID0gb3BhcXVlOworCVZpcnRJT0RldmljZSAqdmRldiA9
IFZJUlRJT19ERVZJQ0UoZGV2KTsKKwlWSG9zdFVzZXJSZG1hICpyID0gVkhPU1RfVVNFUl9SRE1B
KHZkZXYpOworCisJc3dpdGNoIChldmVudCkgeworCWNhc2UgQ0hSX0VWRU5UX09QRU5FRDoKKwkJ
aWYgKHZob3N0X3VzZXJfcmRtYV9jb25uZWN0KGRldikgPCAwKSB7CisJCQlxZW11X2Nocl9mZV9k
aXNjb25uZWN0KCZyLT5jaGFyZGV2KTsKKwkJCXJldHVybjsKKwkJfQorCQlicmVhazsKKwljYXNl
IENIUl9FVkVOVF9DTE9TRUQ6CisJCWlmIChydW5zdGF0ZV9pc19ydW5uaW5nKCkpIHsKKwkJCUFp
b0NvbnRleHQgKmN0eCA9IHFlbXVfZ2V0X2N1cnJlbnRfYWlvX2NvbnRleHQoKTsKKworCQkJcWVt
dV9jaHJfZmVfc2V0X2hhbmRsZXJzKCZyLT5jaGFyZGV2LCBOVUxMLCBOVUxMLCBOVUxMLCBOVUxM
LAorCQkJCQlOVUxMLCBOVUxMLCBmYWxzZSk7CisJCQlhaW9fYmhfc2NoZWR1bGVfb25lc2hvdChj
dHgsIHZob3N0X3VzZXJfcmRtYV9jaHJfY2xvc2VkX2JoLCBvcGFxdWUpOworCQl9CisKKwkJci0+
ZGV2LnN0YXJ0ZWQgPSBmYWxzZTsKKwkJYnJlYWs7CisJY2FzZSBDSFJfRVZFTlRfQlJFQUs6CisJ
Y2FzZSBDSFJfRVZFTlRfTVVYX0lOOgorCWNhc2UgQ0hSX0VWRU5UX01VWF9PVVQ6CisJCS8qIEln
bm9yZSAqLworCQlicmVhazsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIHZob3N0X3VzZXJfcmRtYV9o
YW5kbGVfb3V0cHV0KFZpcnRJT0RldmljZSAqdmRldiwgVmlydFF1ZXVlICp2cSkKK3sKKwlWSG9z
dFVzZXJSZG1hICpyID0gVkhPU1RfVVNFUl9SRE1BKHZkZXYpOworCWludCBpLCByZXQ7CisKKwlp
ZiAoIXZkZXYtPnN0YXJ0X29uX2tpY2spIHsKKwkJcmV0dXJuOworCX0KKworCWlmICghci0+Y29u
bmVjdGVkKSB7CisJCXJldHVybjsKKwl9CisKKwlpZiAoci0+ZGV2LnN0YXJ0ZWQpIHsKKwkJcmV0
dXJuOworCX0KKworCXJldCA9IHZob3N0X3VzZXJfcmRtYV9zdGFydCh2ZGV2KTsKKwlpZiAocmV0
IDwgMCkgeworCQlxZW11X2Nocl9mZV9kaXNjb25uZWN0KCZyLT5jaGFyZGV2KTsKKwkJcmV0dXJu
OworCX0KKworCWZvciAoaSA9IDA7IGkgPCByLT5kZXYubnZxczsgaSsrKSB7CisJCVZpcnRRdWV1
ZSAqa2lja192cSA9IHZpcnRpb19nZXRfcXVldWUodmRldiwgaSk7CisKKwkJaWYgKCF2aXJ0aW9f
cXVldWVfZ2V0X2Rlc2NfYWRkcih2ZGV2LCBpKSkgeworCQkJY29udGludWU7CisJCX0KKwkJZXZl
bnRfbm90aWZpZXJfc2V0KHZpcnRpb19xdWV1ZV9nZXRfaG9zdF9ub3RpZmllcihraWNrX3ZxKSk7
CisJfQorfQorCitzdGF0aWMgdm9pZCB2aG9zdF91c2VyX3JkbWFfdXBkYXRlX2NvbmZpZyhWaXJ0
SU9EZXZpY2UgKnZkZXYsIHVpbnQ4X3QgKmNvbmZpZykKK3sKKwlWSG9zdFVzZXJSZG1hICpyID0g
VkhPU1RfVVNFUl9SRE1BKHZkZXYpOworCisJbWVtY3B5KGNvbmZpZywgJnItPnJkbWFjZmcsIHNp
emVvZihzdHJ1Y3QgdmlydGlvX3JkbWFfY29uZmlnKSk7Cit9CisKK3N0YXRpYyB2b2lkIHZob3N0
X3VzZXJfcmRtYV9zZXRfY29uZmlnKFZpcnRJT0RldmljZSAqdmRldiwKKwkJCQkJCQkJCWNvbnN0
IHVpbnQ4X3QgKmNvbmZpZykKK3sKKwkvKiBub3RoaW5nIHRvIGRvICovCit9CisKK3N0YXRpYyB1
aW50NjRfdCB2aG9zdF91c2VyX3JkbWFfZ2V0X2ZlYXR1cmVzKFZpcnRJT0RldmljZSAqdmRldiwK
KwkJCQkJCQkJCQkJdWludDY0X3QgZmVhdHVyZXMsCisJCQkJCQkJCQkJCUVycm9yICoqZXJycCkK
K3sKKwlWSG9zdFVzZXJSZG1hICpzID0gVkhPU1RfVVNFUl9SRE1BKHZkZXYpOworCisJcmV0dXJu
IHZob3N0X2dldF9mZWF0dXJlcygmcy0+ZGV2LCB1c2VyX2ZlYXR1cmVfYml0cywgZmVhdHVyZXMp
OworfQorCitzdGF0aWMgdm9pZCB2aG9zdF91c2VyX3JkbWFfc2V0X3N0YXR1cyhWaXJ0SU9EZXZp
Y2UgKnZkZXYsIHVpbnQ4X3Qgc3RhdHVzKQoreworCVZIb3N0VXNlclJkbWEgKnIgPSBWSE9TVF9V
U0VSX1JETUEodmRldik7CisJYm9vbCBzaG91bGRfc3RhcnQgPSB2aXJ0aW9fZGV2aWNlX3N0YXJ0
ZWQodmRldiwgc3RhdHVzKTsKKwlpbnQgcmV0OworCisJaWYgKCF2ZGV2LT52bV9ydW5uaW5nKSB7
CisJCXNob3VsZF9zdGFydCA9IGZhbHNlOworCX0KKworCWlmICghci0+Y29ubmVjdGVkKSB7CisJ
CXJldHVybjsKKwl9CisKKwlpZiAoci0+ZGV2LnN0YXJ0ZWQgPT0gc2hvdWxkX3N0YXJ0KSB7CisJ
CXJldHVybjsKKwl9CisKKwlpZiAoc2hvdWxkX3N0YXJ0KSB7CisJCXJldCA9IHZob3N0X3VzZXJf
cmRtYV9zdGFydCh2ZGV2KTsKKwkJaWYgKHJldCA8IDApIHsKKwkJCWVycm9yX3JlcG9ydCgidmhv
c3QtdXNlci1yZG1hOiB2aG9zdCBzdGFydCBmYWlsZWQ6ICVzIiwKKwkJCQkJCXN0cmVycm9yKC1y
ZXQpKTsKKwkJCXFlbXVfY2hyX2ZlX2Rpc2Nvbm5lY3QoJnItPmNoYXJkZXYpOworCQl9CisJfSBl
bHNlIHsKKwkJdmhvc3RfdXNlcl9yZG1hX3N0b3AodmRldik7CisJfQorfQorCitzdGF0aWMgdm9p
ZCB2aG9zdF91c2VyX3JkbWFfZGV2aWNlX3JlYWxpemUoRGV2aWNlU3RhdGUgKmRldiwgRXJyb3Ig
KiplcnJwKQoreworCVZpcnRJT0RldmljZSAqdmRldiA9IFZJUlRJT19ERVZJQ0UoZGV2KTsKKwlW
SG9zdFVzZXJSZG1hICpyID0gVkhPU1RfVVNFUl9SRE1BKHZkZXYpOworCUVycm9yICplcnIgPSBO
VUxMOworCWludCBpLCByZXQ7CisKKwlpZiAoIXItPmNoYXJkZXYuY2hyKSB7CisJCWVycm9yX3Nl
dGcoZXJycCwgInZob3N0LXVzZXItcmRtYTogY2hhcmRldiBpcyBtYW5kYXRvcnkiKTsKKwkJcmV0
dXJuOworCX0KKworCXItPm51bV9xdWV1ZXMgPSBWSE9TVF9VU0VSX1JETUFfTlVNX1FVRVVFUzsK
KworCWlmIChyLT5udW1fcXVldWVzID4gVklSVElPX1FVRVVFX01BWCkgeworCQllcnJvcl9zZXRn
KGVycnAsICJ2aG9zdC11c2VyLXJkbWE6IGludmFsaWQgbnVtYmVyIG9mIElPIHF1ZXVlcyIpOwor
CQlyZXR1cm47CisJfQorCisJaWYgKCF2aG9zdF91c2VyX2luaXQoJnItPnZob3N0X3VzZXIsICZy
LT5jaGFyZGV2LCBlcnJwKSkgeworCQlyZXR1cm47CisJfQorCisJdmlydGlvX2luaXQodmRldiwg
VklSVElPX0lEX1JETUEsIHNpemVvZihzdHJ1Y3QgdmlydGlvX3JkbWFfY29uZmlnKSk7CisKKwly
LT52aXJ0cXMgPSBnX25ldyhWaXJ0UXVldWUgKiwgci0+bnVtX3F1ZXVlcyk7CisKKwlmb3IgKGkg
PSAwOyBpIDwgci0+bnVtX3F1ZXVlczsgaSsrKSB7CisJCXItPnZpcnRxc1tpXSA9IHZpcnRpb19h
ZGRfcXVldWUodmRldiwgVkhPU1RfVVNFUl9SRE1BX1FVRVVFX1NJWkUsCisJCQkJCQkJCQkJdmhv
c3RfdXNlcl9yZG1hX2hhbmRsZV9vdXRwdXQpOworCX0KKworCXItPnZob3N0X3ZxcyA9IGdfbmV3
MChzdHJ1Y3Qgdmhvc3RfdmlydHF1ZXVlLCByLT5udW1fcXVldWVzKTsKKwlyLT5jb25uZWN0ZWQg
PSBmYWxzZTsKKworCXFlbXVfY2hyX2ZlX3NldF9oYW5kbGVycygmci0+Y2hhcmRldiwgIE5VTEws
IE5VTEwsIHZob3N0X3VzZXJfcmRtYV9ldmVudCwKKwkJCQkJCQlOVUxMLCAodm9pZCAqKWRldiwg
TlVMTCwgdHJ1ZSk7CisKK3JlY29ubmVjdDoKKwlpZiAocWVtdV9jaHJfZmVfd2FpdF9jb25uZWN0
ZWQoJnItPmNoYXJkZXYsICZlcnIpIDwgMCkgeworCQllcnJvcl9yZXBvcnRfZXJyKGVycik7CisJ
CWdvdG8gdmlydGlvX2VycjsKKwl9CisKKwkvKiBjaGVjayB3aGV0aGVyIHZob3N0X3VzZXJfcmRt
YV9jb25uZWN0KCkgZmFpbGVkIG9yIG5vdCAqLworCWlmICghci0+Y29ubmVjdGVkKSB7CisJCWdv
dG8gcmVjb25uZWN0OworCX0KKworCXJldCA9IHZob3N0X2Rldl9nZXRfY29uZmlnKCZyLT5kZXYs
ICh1aW50OF90ICopJnItPnJkbWFjZmcsCisJCQkJCQkJc2l6ZW9mKHN0cnVjdCB2aXJ0aW9fcmRt
YV9jb25maWcpLCAmZXJyKTsKKwlpZiAocmV0IDwgMCkgeworCQllcnJvcl9yZXBvcnQoInZob3N0
LXVzZXItcmRtYTogZ2V0IHJkbWEgY29uZmlnIGZhaWxlZCIpOworCQlnb3RvIHJlY29ubmVjdDsK
Kwl9CisKKwlyZXR1cm47CisKK3ZpcnRpb19lcnI6CisJZ19mcmVlKHItPnZob3N0X3Zxcyk7CisJ
ci0+dmhvc3RfdnFzID0gTlVMTDsKKwlmb3IgKGkgPSAwOyBpIDwgci0+bnVtX3F1ZXVlczsgaSsr
KSB7CisJCXZpcnRpb19kZWxldGVfcXVldWUoci0+dmlydHFzW2ldKTsKKwl9CisJZ19mcmVlKHIt
PnZpcnRxcyk7CisJdmlydGlvX2NsZWFudXAodmRldik7CisJdmhvc3RfdXNlcl9jbGVhbnVwKCZy
LT52aG9zdF91c2VyKTsKK30KKworc3RhdGljIHZvaWQgdmhvc3RfdXNlcl9yZG1hX2RldmljZV91
bnJlYWxpemUoRGV2aWNlU3RhdGUgKmRldikKK3sKKwlWaXJ0SU9EZXZpY2UgKnZkZXYgPSBWSVJU
SU9fREVWSUNFKGRldik7CisJVkhvc3RVc2VyUmRtYSAqciA9IFZIT1NUX1VTRVJfUkRNQShkZXYp
OworCWludCBpOworCisJdmlydGlvX3NldF9zdGF0dXModmRldiwgMCk7CisJcWVtdV9jaHJfZmVf
c2V0X2hhbmRsZXJzKCZyLT5jaGFyZGV2LCAgTlVMTCwgTlVMTCwgTlVMTCwKKwkJCQkJCQlOVUxM
LCBOVUxMLCBOVUxMLCBmYWxzZSk7CisJdmhvc3RfZGV2X2NsZWFudXAoJnItPmRldik7CisJZ19m
cmVlKHItPnZob3N0X3Zxcyk7CisJci0+dmhvc3RfdnFzID0gTlVMTDsKKwlmb3IgKGkgPSAwOyBp
IDwgci0+bnVtX3F1ZXVlczsgaSsrKSB7CisJCXZpcnRpb19kZWxldGVfcXVldWUoci0+dmlydHFz
W2ldKTsKKwl9CisJZ19mcmVlKHItPnZpcnRxcyk7CisJdmlydGlvX2NsZWFudXAodmRldik7CisJ
dmhvc3RfdXNlcl9jbGVhbnVwKCZyLT52aG9zdF91c2VyKTsKK30KKworc3RhdGljIHZvaWQgdmhv
c3RfdXNlcl9yZG1hX2luc3RhbmNlX2luaXQoT2JqZWN0ICpvYmopCit7CisJVkhvc3RVc2VyUmRt
YSAqciA9IFZIT1NUX1VTRVJfUkRNQShvYmopOworCisJZGV2aWNlX2FkZF9ib290aW5kZXhfcHJv
cGVydHkob2JqLCAmci0+Ym9vdGluZGV4LCAiYm9vdGluZGV4IiwKKwkJCQkJCQkJImJvb3RpbmRl
eCIsIERFVklDRShvYmopKTsKK30KKworc3RhdGljIGNvbnN0IFZNU3RhdGVEZXNjcmlwdGlvbiB2
bXN0YXRlX3Zob3N0X3VzZXJfcmRtYSA9IHsKKwkubmFtZSA9ICJ2aG9zdC11c2VyLXJkbWEiLAor
CS5taW5pbXVtX3ZlcnNpb25faWQgPSAxLAorCS52ZXJzaW9uX2lkID0gMSwKKwkuZmllbGRzID0g
KFZNU3RhdGVGaWVsZFtdKSB7CisJCVZNU1RBVEVfVklSVElPX0RFVklDRSwKKwkJVk1TVEFURV9F
TkRfT0ZfTElTVCgpCisJfSwKK307CisKK3N0YXRpYyBQcm9wZXJ0eSB2aG9zdF91c2VyX3JkbWFf
cHJvcGVydGllc1tdID0geworCURFRklORV9QUk9QX0NIUigiY2hhcmRldiIsIFZIb3N0VXNlclJk
bWEsIGNoYXJkZXYpLAorCURFRklORV9QUk9QX0VORF9PRl9MSVNUKCksCit9OworCitzdGF0aWMg
dm9pZCB2aG9zdF91c2VyX3JkbWFfY2xhc3NfaW5pdChPYmplY3RDbGFzcyAqa2xhc3MsIHZvaWQg
KmRhdGEpCit7CisJRGV2aWNlQ2xhc3MgKmRjID0gREVWSUNFX0NMQVNTKGtsYXNzKTsKKwlWaXJ0
aW9EZXZpY2VDbGFzcyAqdmRjID0gVklSVElPX0RFVklDRV9DTEFTUyhrbGFzcyk7CisKKwlkZXZp
Y2VfY2xhc3Nfc2V0X3Byb3BzKGRjLCB2aG9zdF91c2VyX3JkbWFfcHJvcGVydGllcyk7CisJZGMt
PnZtc2QgPSAmdm1zdGF0ZV92aG9zdF91c2VyX3JkbWE7CisJc2V0X2JpdChERVZJQ0VfQ0FURUdP
UllfTkVUV09SSywgZGMtPmNhdGVnb3JpZXMpOworCisJdmRjLT5yZWFsaXplID0gdmhvc3RfdXNl
cl9yZG1hX2RldmljZV9yZWFsaXplOworCXZkYy0+dW5yZWFsaXplID0gdmhvc3RfdXNlcl9yZG1h
X2RldmljZV91bnJlYWxpemU7CisJdmRjLT5nZXRfY29uZmlnID0gdmhvc3RfdXNlcl9yZG1hX3Vw
ZGF0ZV9jb25maWc7CisJdmRjLT5zZXRfY29uZmlnID0gdmhvc3RfdXNlcl9yZG1hX3NldF9jb25m
aWc7CisJdmRjLT5nZXRfZmVhdHVyZXMgPSB2aG9zdF91c2VyX3JkbWFfZ2V0X2ZlYXR1cmVzOwor
CXZkYy0+c2V0X3N0YXR1cyA9IHZob3N0X3VzZXJfcmRtYV9zZXRfc3RhdHVzOworfQorCitzdGF0
aWMgY29uc3QgVHlwZUluZm8gdmhvc3RfdXNlcl9yZG1hX2luZm8gPSB7CisJLm5hbWUgPSBUWVBF
X1ZIT1NUX1VTRVJfUkRNQSwKKwkucGFyZW50ID0gVFlQRV9WSVJUSU9fREVWSUNFLAorCS5pbnN0
YW5jZV9zaXplID0gc2l6ZW9mKFZIb3N0VXNlclJkbWEpLAorCS5pbnN0YW5jZV9pbml0ID0gdmhv
c3RfdXNlcl9yZG1hX2luc3RhbmNlX2luaXQsCisJLmNsYXNzX2luaXQgPSB2aG9zdF91c2VyX3Jk
bWFfY2xhc3NfaW5pdCwKK307CisKK3N0YXRpYyB2b2lkIHZpcnRpb19yZWdpc3Rlcl90eXBlcyh2
b2lkKQoreworCXR5cGVfcmVnaXN0ZXJfc3RhdGljKCZ2aG9zdF91c2VyX3JkbWFfaW5mbyk7Cit9
CisKK3R5cGVfaW5pdCh2aXJ0aW9fcmVnaXN0ZXJfdHlwZXMpCmRpZmYgLS1naXQgYS9ody92aXJ0
aW8vbWVzb24uYnVpbGQgYi9ody92aXJ0aW8vbWVzb24uYnVpbGQKaW5kZXggZDdmMThjOTZlNi4u
M2YwYTdkYTkxMCAxMDA2NDQKLS0tIGEvaHcvdmlydGlvL21lc29uLmJ1aWxkCisrKyBiL2h3L3Zp
cnRpby9tZXNvbi5idWlsZApAQCAtNjMsNiArNjMsNyBAQCB2aXJ0aW9fcGNpX3NzLmFkZCh3aGVu
OiAnQ09ORklHX1ZIT1NUX1ZTT0NLJywgaWZfdHJ1ZTogZmlsZXMoJ3Zob3N0LXZzb2NrLXBjaS5j
JwogdmlydGlvX3BjaV9zcy5hZGQod2hlbjogJ0NPTkZJR19WSE9TVF9VU0VSX1ZTT0NLJywgaWZf
dHJ1ZTogZmlsZXMoJ3Zob3N0LXVzZXItdnNvY2stcGNpLmMnKSkKIHZpcnRpb19wY2lfc3MuYWRk
KHdoZW46ICdDT05GSUdfVkhPU1RfVVNFUl9CTEsnLCBpZl90cnVlOiBmaWxlcygndmhvc3QtdXNl
ci1ibGstcGNpLmMnKSkKIHZpcnRpb19wY2lfc3MuYWRkKHdoZW46ICdDT05GSUdfVkhPU1RfVVNF
Ul9TQ1NJJywgaWZfdHJ1ZTogZmlsZXMoJ3Zob3N0LXVzZXItc2NzaS1wY2kuYycpKQordmlydGlv
X3BjaV9zcy5hZGQod2hlbjogJ0NPTkZJR19WSE9TVF9VU0VSX1JETUEnLCBpZl90cnVlOiBmaWxl
cygndmhvc3QtdXNlci1yZG1hLXBjaS5jJykpCiB2aXJ0aW9fcGNpX3NzLmFkZCh3aGVuOiAnQ09O
RklHX1ZIT1NUX1NDU0knLCBpZl90cnVlOiBmaWxlcygndmhvc3Qtc2NzaS1wY2kuYycpKQogdmly
dGlvX3BjaV9zcy5hZGQod2hlbjogJ0NPTkZJR19WSE9TVF9VU0VSX0ZTJywgaWZfdHJ1ZTogZmls
ZXMoJ3Zob3N0LXVzZXItZnMtcGNpLmMnKSkKIApkaWZmIC0tZ2l0IGEvaHcvdmlydGlvL3Zob3N0
LXVzZXItcmRtYS1wY2kuYyBiL2h3L3ZpcnRpby92aG9zdC11c2VyLXJkbWEtcGNpLmMKbmV3IGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMC4uNmI5NTk0OWMwNwotLS0gL2Rldi9udWxs
CisrKyBiL2h3L3ZpcnRpby92aG9zdC11c2VyLXJkbWEtcGNpLmMKQEAgLTAsMCArMSw5MyBAQAor
LyoKKyAqIFRoaXMgd29yayBpcyBsaWNlbnNlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBH
UEwsIHZlcnNpb24gMiBvcgorICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4g
IFNlZSB0aGUgQ09QWUlORyBmaWxlIGluIHRoZQorICogdG9wLWxldmVsIGRpcmVjdG9yeS4KKyAq
LworCisjaW5jbHVkZSAicWVtdS9vc2RlcC5oIgorCisjaW5jbHVkZSAic3RhbmRhcmQtaGVhZGVy
cy9yZG1hL3ZpcnRpb19yZG1hLmgiCisjaW5jbHVkZSAiaHcvdmlydGlvL3ZpcnRpby5oIgorI2lu
Y2x1ZGUgImh3L3ZpcnRpby92aG9zdC11c2VyLXJkbWEuaCIKKyNpbmNsdWRlICJody9wY2kvcGNp
LmgiCisjaW5jbHVkZSAiaHcvcWRldi1wcm9wZXJ0aWVzLmgiCisjaW5jbHVkZSAicWFwaS9lcnJv
ci5oIgorI2luY2x1ZGUgInFlbXUvZXJyb3ItcmVwb3J0LmgiCisjaW5jbHVkZSAicWVtdS9tb2R1
bGUuaCIKKyNpbmNsdWRlICJody92aXJ0aW8vdmlydGlvLXBjaS5oIgorI2luY2x1ZGUgInFvbS9v
YmplY3QuaCIKKwordHlwZWRlZiBzdHJ1Y3QgVkhvc3RVc2VyUmRtYVBDSSBWSG9zdFVzZXJSZG1h
UENJOworCisjZGVmaW5lIFRZUEVfVkhPU1RfVVNFUl9SRE1BX1BDSSAidmhvc3QtdXNlci1yZG1h
LXBjaS1iYXNlIgorREVDTEFSRV9JTlNUQU5DRV9DSEVDS0VSKFZIb3N0VXNlclJkbWFQQ0ksIFZI
T1NUX1VTRVJfUkRNQV9QQ0ksCisJCQkJCQlUWVBFX1ZIT1NUX1VTRVJfUkRNQV9QQ0kpCisKK3N0
cnVjdCBWSG9zdFVzZXJSZG1hUENJIHsKKwlWaXJ0SU9QQ0lQcm94eSBwYXJlbnRfb2JqOworCVZI
b3N0VXNlclJkbWEgdmRldjsKK307CisKK3N0YXRpYyBQcm9wZXJ0eSB2aG9zdF91c2VyX3JkbWFf
cGNpX3Byb3BlcnRpZXNbXSA9IHsKKwlERUZJTkVfUFJPUF9VSU5UMzIoImNsYXNzIiwgVmlydElP
UENJUHJveHksIGNsYXNzX2NvZGUsIDApLAorCURFRklORV9QUk9QX1VJTlQzMigidmVjdG9ycyIs
IFZpcnRJT1BDSVByb3h5LCBudmVjdG9ycywKKwkJCQkJCURFVl9OVkVDVE9SU19VTlNQRUNJRklF
RCksCisJREVGSU5FX1BST1BfRU5EX09GX0xJU1QoKSwKK307CisKK3N0YXRpYyB2b2lkIHZob3N0
X3VzZXJfcmRtYV9wY2lfcmVhbGl6ZShWaXJ0SU9QQ0lQcm94eSAqdnBjaV9kZXYsIEVycm9yICoq
ZXJycCkKK3sKKwlWSG9zdFVzZXJSZG1hUENJICpkZXYgPSBWSE9TVF9VU0VSX1JETUFfUENJKHZw
Y2lfZGV2KTsKKwlEZXZpY2VTdGF0ZSAqdmRldiA9IERFVklDRSgmZGV2LT52ZGV2KTsKKworCWlm
ICh2cGNpX2Rldi0+bnZlY3RvcnMgPT0gREVWX05WRUNUT1JTX1VOU1BFQ0lGSUVEKSB7CisJCXZw
Y2lfZGV2LT5udmVjdG9ycyA9IGRldi0+dmRldi5udW1fcXVldWVzICsgMTsKKwl9CisKKwl2aXJ0
aW9fcGNpX2ZvcmNlX3ZpcnRpb18xKHZwY2lfZGV2KTsKKworCXFkZXZfcmVhbGl6ZSh2ZGV2LCBC
VVMoJnZwY2lfZGV2LT5idXMpLCBlcnJwKTsKK30KKworc3RhdGljIHZvaWQgdmhvc3RfdXNlcl9y
ZG1hX3BjaV9jbGFzc19pbml0KE9iamVjdENsYXNzICprbGFzcywgdm9pZCAqZGF0YSkKK3sKKwlE
ZXZpY2VDbGFzcyAqZGMgPSBERVZJQ0VfQ0xBU1Moa2xhc3MpOworCVZpcnRpb1BDSUNsYXNzICpr
ID0gVklSVElPX1BDSV9DTEFTUyhrbGFzcyk7CisJUENJRGV2aWNlQ2xhc3MgKnBjaWRldl9rID0g
UENJX0RFVklDRV9DTEFTUyhrbGFzcyk7CisKKwlzZXRfYml0KERFVklDRV9DQVRFR09SWV9ORVRX
T1JLLCBkYy0+Y2F0ZWdvcmllcyk7CisJZGV2aWNlX2NsYXNzX3NldF9wcm9wcyhkYywgdmhvc3Rf
dXNlcl9yZG1hX3BjaV9wcm9wZXJ0aWVzKTsKKwlrLT5yZWFsaXplID0gdmhvc3RfdXNlcl9yZG1h
X3BjaV9yZWFsaXplOworCXBjaWRldl9rLT52ZW5kb3JfaWQgPSBQQ0lfVkVORE9SX0lEX1JFREhB
VF9RVU1SQU5FVDsKKwlwY2lkZXZfay0+ZGV2aWNlX2lkID0gUENJX0RFVklDRV9JRF9WSVJUSU9f
UkRNQTsKKwlwY2lkZXZfay0+cmV2aXNpb24gPSBWSVJUSU9fUENJX0FCSV9WRVJTSU9OOworCXBj
aWRldl9rLT5jbGFzc19pZCA9IFBDSV9DTEFTU19ORVRXT1JLX09USEVSOworfQorCitzdGF0aWMg
dm9pZCB2aG9zdF91c2VyX3JkbWFfcGNpX2luc3RhbmNlX2luaXQoT2JqZWN0ICpvYmopCit7CisJ
Vkhvc3RVc2VyUmRtYVBDSSAqZGV2ID0gVkhPU1RfVVNFUl9SRE1BX1BDSShvYmopOworCisJdmly
dGlvX2luc3RhbmNlX2luaXRfY29tbW9uKG9iaiwgJmRldi0+dmRldiwgc2l6ZW9mKGRldi0+dmRl
diksCisJCQkJCQkJVFlQRV9WSE9TVF9VU0VSX1JETUEpOworCisJb2JqZWN0X3Byb3BlcnR5X2Fk
ZF9hbGlhcyhvYmosICJib290aW5kZXgiLCBPQkpFQ1QoJmRldi0+dmRldiksCisJCQkJCQkJImJv
b3RpbmRleCIpOworfQorCitzdGF0aWMgY29uc3QgVmlydGlvUENJRGV2aWNlVHlwZUluZm8gdmhv
c3RfdXNlcl9yZG1hX3BjaV9pbmZvID0geworCS5iYXNlX25hbWUJCQkJPSBUWVBFX1ZIT1NUX1VT
RVJfUkRNQV9QQ0ksCisJLmdlbmVyaWNfbmFtZQkJCT0gInZob3N0LXVzZXItcmRtYS1wY2kiLAor
CS50cmFuc2l0aW9uYWxfbmFtZQkJPSAidmhvc3QtdXNlci1yZG1hLXBjaS10cmFuc2l0aW9uYWwi
LAorCS5ub25fdHJhbnNpdGlvbmFsX25hbWUJPSAidmhvc3QtdXNlci1yZG1hLXBjaS1ub24tdHJh
bnNpdGlvbmFsIiwKKwkuaW5zdGFuY2Vfc2l6ZQkJCT0gc2l6ZW9mKFZIb3N0VXNlclJkbWFQQ0kp
LAorCS5pbnN0YW5jZV9pbml0CQkJPSB2aG9zdF91c2VyX3JkbWFfcGNpX2luc3RhbmNlX2luaXQs
CisJLmNsYXNzX2luaXQJCQkJPSB2aG9zdF91c2VyX3JkbWFfcGNpX2NsYXNzX2luaXQsCit9Owor
CitzdGF0aWMgdm9pZCB2aG9zdF91c2VyX3JkbWFfcGNpX3JlZ2lzdGVyKHZvaWQpCit7CisJdmly
dGlvX3BjaV90eXBlc19yZWdpc3Rlcigmdmhvc3RfdXNlcl9yZG1hX3BjaV9pbmZvKTsKK30KKwor
dHlwZV9pbml0KHZob3N0X3VzZXJfcmRtYV9wY2lfcmVnaXN0ZXIpCmRpZmYgLS1naXQgYS9ody92
aXJ0aW8vdmhvc3QtdXNlci5jIGIvaHcvdmlydGlvL3Zob3N0LXVzZXIuYwppbmRleCBjZGY5YWY0
YTRiLi5lYjA4MTNiZGRkIDEwMDY0NAotLS0gYS9ody92aXJ0aW8vdmhvc3QtdXNlci5jCisrKyBi
L2h3L3ZpcnRpby92aG9zdC11c2VyLmMKQEAgLTQ2MCw2ICs0NjAsNyBAQCBzdGF0aWMgaW50IHZo
b3N0X3VzZXJfc2V0X2xvZ19iYXNlKHN0cnVjdCB2aG9zdF9kZXYgKmRldiwgdWludDY0X3QgYmFz
ZSwKICAgICB9CiAKICAgICBpZiAoc2htZmQpIHsKKyAgICAgICAgZXJyb3JfcmVwb3J0KCJ2aG9z
dF91c2VyX3JlYWQ6IHZob3N0X3VzZXJfc2V0X2xvZ19iYXNlIik7CiAgICAgICAgIG1zZy5oZHIu
c2l6ZSA9IDA7CiAgICAgICAgIHJldCA9IHZob3N0X3VzZXJfcmVhZChkZXYsICZtc2cpOwogICAg
ICAgICBpZiAocmV0IDwgMCkgewpAQCAtNzUzLDYgKzc1NCw3IEBAIHN0YXRpYyBpbnQgc2VuZF9h
ZGRfcmVnaW9ucyhzdHJ1Y3Qgdmhvc3RfZGV2ICpkZXYsCiAgICAgICAgICAgICBpZiAodHJhY2tf
cmFtYmxvY2tzKSB7CiAgICAgICAgICAgICAgICAgdWludDY0X3QgcmVwbHlfZ3BhOwogCisgICAg
ICAgICAgICAgICAgZXJyb3JfcmVwb3J0KCJ2aG9zdF91c2VyX3JlYWQ6IHNlbmRfYWRkX3JlZ2lv
bnMiKTsKICAgICAgICAgICAgICAgICByZXQgPSB2aG9zdF91c2VyX3JlYWQoZGV2LCAmbXNnX3Jl
cGx5KTsKICAgICAgICAgICAgICAgICBpZiAocmV0IDwgMCkgewogICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gcmV0OwpAQCAtOTMwLDYgKzkzMiw3IEBAIHN0YXRpYyBpbnQgdmhvc3RfdXNlcl9z
ZXRfbWVtX3RhYmxlX3Bvc3Rjb3B5KHN0cnVjdCB2aG9zdF9kZXYgKmRldiwKICAgICAgICAgICAg
IHJldHVybiByZXQ7CiAgICAgICAgIH0KIAorICAgICAgICBlcnJvcl9yZXBvcnQoInZob3N0X3Vz
ZXJfcmVhZDogdmhvc3RfdXNlcl9zZXRfbWVtX3RhYmxlX3Bvc3Rjb3B5Iik7CiAgICAgICAgIHJl
dCA9IHZob3N0X3VzZXJfcmVhZChkZXYsICZtc2dfcmVwbHkpOwogICAgICAgICBpZiAocmV0IDwg
MCkgewogICAgICAgICAgICAgcmV0dXJuIHJldDsKQEAgLTEyODcsNiArMTI5MCw3IEBAIHN0YXRp
YyBpbnQgdmhvc3RfdXNlcl9nZXRfdnJpbmdfYmFzZShzdHJ1Y3Qgdmhvc3RfZGV2ICpkZXYsCiAg
ICAgICAgIHJldHVybiByZXQ7CiAgICAgfQogCisgICAgZXJyb3JfcmVwb3J0KCJ2aG9zdF91c2Vy
X3JlYWQ6IHZob3N0X3VzZXJfZ2V0X3ZyaW5nX2Jhc2UiKTsKICAgICByZXQgPSB2aG9zdF91c2Vy
X3JlYWQoZGV2LCAmbXNnKTsKICAgICBpZiAocmV0IDwgMCkgewogICAgICAgICByZXR1cm4gcmV0
OwpAQCAtMTQzMyw2ICsxNDM3LDcgQEAgc3RhdGljIGludCB2aG9zdF91c2VyX3NldF9mZWF0dXJl
cyhzdHJ1Y3Qgdmhvc3RfZGV2ICpkZXYsCiAgICAgICogVkhPU1RfVVNFUl9GX1BST1RPQ09MX0ZF
QVRVUkVTIGJpdCBmb3IgZW5hYmxpbmcgcHJvdG9jb2wKICAgICAgKiBmZWF0dXJlcy4KICAgICAg
Ki8KKwogICAgIHJldCA9IHZob3N0X3VzZXJfc2V0X3U2NChkZXYsIFZIT1NUX1VTRVJfU0VUX0ZF
QVRVUkVTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMgfCBkZXYtPmJh
Y2tlbmRfZmVhdHVyZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dfZW5hYmxl
ZCk7CkBAIC0xNjczLDYgKzE2NzgsNyBAQCBpbnQgdmhvc3RfdXNlcl9nZXRfc2hhcmVkX29iamVj
dChzdHJ1Y3Qgdmhvc3RfZGV2ICpkZXYsIHVuc2lnbmVkIGNoYXIgKnV1aWQsCiAgICAgICAgIHJl
dHVybiByZXQ7CiAgICAgfQogCisgICAgZXJyb3JfcmVwb3J0KCJ2aG9zdF91c2VyX3JlYWQ6IHZo
b3N0X3VzZXJfZ2V0X3NoYXJlZF9vYmplY3QiKTsKICAgICByZXQgPSB2aG9zdF91c2VyX3JlYWQo
ZGV2LCAmbXNnKTsKICAgICBpZiAocmV0IDwgMCkgewogICAgICAgICByZXR1cm4gcmV0OwpAQCAt
MTk5OCw2ICsyMDA0LDcgQEAgc3RhdGljIGludCB2aG9zdF91c2VyX3Bvc3Rjb3B5X2FkdmlzZShz
dHJ1Y3Qgdmhvc3RfZGV2ICpkZXYsIEVycm9yICoqZXJycCkKICAgICAgICAgcmV0dXJuIHJldDsK
ICAgICB9CiAKKyAgICBlcnJvcl9yZXBvcnQoInZob3N0X3VzZXJfcmVhZDogdmhvc3RfdXNlcl9w
b3N0Y29weV9hZHZpc2UiKTsKICAgICByZXQgPSB2aG9zdF91c2VyX3JlYWQoZGV2LCAmbXNnKTsK
ICAgICBpZiAocmV0IDwgMCkgewogICAgICAgICBlcnJvcl9zZXRnKGVycnAsICJGYWlsZWQgdG8g
Z2V0IHBvc3Rjb3B5X2FkdmlzZSByZXBseSBmcm9tIHZob3N0Iik7CkBAIC0yNDM1LDYgKzI0NDIs
NyBAQCBzdGF0aWMgaW50IHZob3N0X3VzZXJfZ2V0X2NvbmZpZyhzdHJ1Y3Qgdmhvc3RfZGV2ICpk
ZXYsIHVpbnQ4X3QgKmNvbmZpZywKICAgICAgICAgcmV0dXJuIHJldDsKICAgICB9CiAKKyAgICBl
cnJvcl9yZXBvcnQoInZob3N0X3VzZXJfcmVhZDogdmhvc3RfdXNlcl9nZXRfY29uZmlnIik7CiAg
ICAgcmV0ID0gdmhvc3RfdXNlcl9yZWFkKGRldiwgJm1zZyk7CiAgICAgaWYgKHJldCA8IDApIHsK
ICAgICAgICAgZXJyb3Jfc2V0Z19lcnJubyhlcnJwLCAtcmV0LCAidmhvc3RfZ2V0X2NvbmZpZyBm
YWlsZWQiKTsKQEAgLTI1NzgsNiArMjU4Niw3IEBAIHN0YXRpYyBpbnQgdmhvc3RfdXNlcl9jcnlw
dG9fY3JlYXRlX3Nlc3Npb24oc3RydWN0IHZob3N0X2RldiAqZGV2LAogICAgICAgICByZXR1cm4g
cmV0OwogICAgIH0KIAorICAgIGVycm9yX3JlcG9ydCgidmhvc3RfdXNlcl9yZWFkOiB2aG9zdF91
c2VyX2NyeXB0b19jcmVhdGVfc2Vzc2lvbiIpOwogICAgIHJldCA9IHZob3N0X3VzZXJfcmVhZChk
ZXYsICZtc2cpOwogICAgIGlmIChyZXQgPCAwKSB7CiAgICAgICAgIGVycm9yX3JlcG9ydCgidmhv
c3RfdXNlcl9yZWFkKCkgcmV0dXJuICVkLCBjcmVhdGUgc2Vzc2lvbiBmYWlsZWQiLApAQCAtMjky
Myw2ICsyOTMyLDcgQEAgc3RhdGljIGludCB2aG9zdF91c2VyX3NldF9kZXZpY2Vfc3RhdGVfZmQo
c3RydWN0IHZob3N0X2RldiAqZGV2LAogICAgICAgICByZXR1cm4gcmV0OwogICAgIH0KIAorICAg
IGVycm9yX3JlcG9ydCgidmhvc3RfdXNlcl9yZWFkOiB2aG9zdF91c2VyX3NldF9kZXZpY2Vfc3Rh
dGVfZmQiKTsKICAgICByZXQgPSB2aG9zdF91c2VyX3JlYWQoZGV2LCAmbXNnKTsKICAgICBpZiAo
cmV0IDwgMCkgewogICAgICAgICBlcnJvcl9zZXRnX2Vycm5vKGVycnAsIC1yZXQsCkBAIC0yOTg1
LDYgKzI5OTUsNyBAQCBzdGF0aWMgaW50IHZob3N0X3VzZXJfY2hlY2tfZGV2aWNlX3N0YXRlKHN0
cnVjdCB2aG9zdF9kZXYgKmRldiwgRXJyb3IgKiplcnJwKQogICAgICAgICByZXR1cm4gcmV0Owog
ICAgIH0KIAorICAgIGVycm9yX3JlcG9ydCgidmhvc3RfdXNlcl9yZWFkOiB2aG9zdF91c2VyX2No
ZWNrX2RldmljZV9zdGF0ZSIpOwogICAgIHJldCA9IHZob3N0X3VzZXJfcmVhZChkZXYsICZtc2cp
OwogICAgIGlmIChyZXQgPCAwKSB7CiAgICAgICAgIGVycm9yX3NldGdfZXJybm8oZXJycCwgLXJl
dCwKZGlmZiAtLWdpdCBhL2h3L3ZpcnRpby92aG9zdC5jIGIvaHcvdmlydGlvL3Zob3N0LmMKaW5k
ZXggZjUwMTgwZTYwZS4uODdjZWMzNjgyOCAxMDA2NDQKLS0tIGEvaHcvdmlydGlvL3Zob3N0LmMK
KysrIGIvaHcvdmlydGlvL3Zob3N0LmMKQEAgLTkzNCw2ICs5MzQsNyBAQCBzdGF0aWMgaW50IHZo
b3N0X2Rldl9zZXRfZmVhdHVyZXMoc3RydWN0IHZob3N0X2RldiAqZGV2LAogICAgICAgICAgICAg
ZmVhdHVyZXMgfD0gMHgxVUxMIDw8IFZJUlRJT19GX0lPTU1VX1BMQVRGT1JNOwogICAgICAgIH0K
ICAgICB9CisKICAgICByID0gZGV2LT52aG9zdF9vcHMtPnZob3N0X3NldF9mZWF0dXJlcyhkZXYs
IGZlYXR1cmVzKTsKICAgICBpZiAociA8IDApIHsKICAgICAgICAgVkhPU1RfT1BTX0RFQlVHKHIs
ICJ2aG9zdF9zZXRfZmVhdHVyZXMgZmFpbGVkIik7CkBAIC0xODA0LDYgKzE4MDUsNyBAQCB2b2lk
IHZob3N0X2Fja19mZWF0dXJlcyhzdHJ1Y3Qgdmhvc3RfZGV2ICpoZGV2LCBjb25zdCBpbnQgKmZl
YXR1cmVfYml0cywKICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ2NF90IGZlYXR1cmVzKQog
ewogICAgIGNvbnN0IGludCAqYml0ID0gZmVhdHVyZV9iaXRzOworICAgIGluZm9fcmVwb3J0KCJ2
aG9zdF9hY2tfZmVhdHVyZXMiKTsKICAgICB3aGlsZSAoKmJpdCAhPSBWSE9TVF9JTlZBTElEX0ZF
QVRVUkVfQklUKSB7CiAgICAgICAgIHVpbnQ2NF90IGJpdF9tYXNrID0gKDFVTEwgPDwgKmJpdCk7
CiAgICAgICAgIGlmIChmZWF0dXJlcyAmIGJpdF9tYXNrKSB7CmRpZmYgLS1naXQgYS9ody92aXJ0
aW8vdmlydGlvLmMgYi9ody92aXJ0aW8vdmlydGlvLmMKaW5kZXggZmQyZGZlM2E2Yi4uYmVlNzE1
NmU2ZCAxMDA2NDQKLS0tIGEvaHcvdmlydGlvL3ZpcnRpby5jCisrKyBiL2h3L3ZpcnRpby92aXJ0
aW8uYwpAQCAtMTgxLDYgKzE4MSw3IEBAIGNvbnN0IGNoYXIgKnZpcnRpb19kZXZpY2VfbmFtZXNb
XSA9IHsKICAgICBbVklSVElPX0lEX0ZTXSA9ICJ2aXJ0aW8tdXNlci1mcyIsCiAgICAgW1ZJUlRJ
T19JRF9QTUVNXSA9ICJ2aXJ0aW8tcG1lbSIsCiAgICAgW1ZJUlRJT19JRF9SUE1CXSA9ICJ2aXJ0
aW8tcnBtYiIsCisgICAgW1ZJUlRJT19JRF9SRE1BXSA9ICJ2aXJ0aW8tcmRtYSIsCiAgICAgW1ZJ
UlRJT19JRF9NQUM4MDIxMV9IV1NJTV0gPSAidmlydGlvLW1hYy1od3NpbSIsCiAgICAgW1ZJUlRJ
T19JRF9WSURFT19FTkNPREVSXSA9ICJ2aXJ0aW8tdmlkLWVuY29kZXIiLAogICAgIFtWSVJUSU9f
SURfVklERU9fREVDT0RFUl0gPSAidmlydGlvLXZpZC1kZWNvZGVyIiwKZGlmZiAtLWdpdCBhL2lu
Y2x1ZGUvaHcvcGNpL3BjaS5oIGIvaW5jbHVkZS9ody9wY2kvcGNpLmgKaW5kZXggZWFhM2ZjOTlk
OC4uYTFlY2NmYjc4YiAxMDA2NDQKLS0tIGEvaW5jbHVkZS9ody9wY2kvcGNpLmgKKysrIGIvaW5j
bHVkZS9ody9wY2kvcGNpLmgKQEAgLTg1LDYgKzg1LDcgQEAgZXh0ZXJuIGJvb2wgcGNpX2F2YWls
YWJsZTsKICNkZWZpbmUgUENJX0RFVklDRV9JRF9WSVJUSU9fUk5HICAgICAgICAgMHgxMDA1CiAj
ZGVmaW5lIFBDSV9ERVZJQ0VfSURfVklSVElPXzlQICAgICAgICAgIDB4MTAwOQogI2RlZmluZSBQ
Q0lfREVWSUNFX0lEX1ZJUlRJT19WU09DSyAgICAgICAweDEwMTIKKyNkZWZpbmUgUENJX0RFVklD
RV9JRF9WSVJUSU9fUkRNQSAgICAgICAgMHgxMDE2CiAKIC8qCiAgKiBtb2Rlcm4gdmlydGlvLXBj
aSBkZXZpY2VzIGdldCB0aGVpciBpZCBhc3NpZ25lZCBhdXRvbWF0aWNhbGx5LApkaWZmIC0tZ2l0
IGEvaW5jbHVkZS9ody92aXJ0aW8vdmhvc3QtdXNlci1yZG1hLmggYi9pbmNsdWRlL2h3L3ZpcnRp
by92aG9zdC11c2VyLXJkbWEuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAw
Li4yZDUyMmNkNjc2Ci0tLSAvZGV2L251bGwKKysrIGIvaW5jbHVkZS9ody92aXJ0aW8vdmhvc3Qt
dXNlci1yZG1hLmgKQEAgLTAsMCArMSw0MyBAQAorLyoKKyAqIHZob3N0LXVzZXItcmRtYSBob3N0
IGRldmljZQorICogQ29weXJpZ2h0KEMpIDIwMjEgQnl0ZWRhbmNlIEluYy4gQWxsIHJpZ2h0cyBy
ZXNlcnZlZC4KKyAqCisgKiBBdXRob3JzOgorICogIEp1bmppIFdlaSA8d2VpanVuamlAYnl0ZWRh
bmNlLmNvbT4KKyAqCisgKiBUaGlzIHdvcmsgaXMgbGljZW5zZWQgdW5kZXIgdGhlIHRlcm1zIG9m
IHRoZSBHTlUgTEdQTCwgdmVyc2lvbiAyIG9yIGxhdGVyLgorICogU2VlIHRoZSBDT1BZSU5HLkxJ
QiBmaWxlIGluIHRoZSB0b3AtbGV2ZWwgZGlyZWN0b3J5LgorICoKKyAqLworCisjaWZuZGVmIFZI
T1NUX1VTRVJfUkRNQV9ICisjZGVmaW5lIFZIT1NUX1VTRVJfUkRNQV9ICisKKyNpbmNsdWRlICJz
dGFuZGFyZC1oZWFkZXJzL3JkbWEvdmlydGlvX3JkbWEuaCIKKyNpbmNsdWRlICJjaGFyZGV2L2No
YXItZmUuaCIKKyNpbmNsdWRlICJody92aXJ0aW8vdmhvc3QuaCIKKyNpbmNsdWRlICJody92aXJ0
aW8vdmhvc3QtdXNlci5oIgorI2luY2x1ZGUgInFvbS9vYmplY3QuaCIKKworI2RlZmluZSBUWVBF
X1ZIT1NUX1VTRVJfUkRNQSAidmhvc3QtdXNlci1yZG1hIgorT0JKRUNUX0RFQ0xBUkVfU0lNUExF
X1RZUEUoVkhvc3RVc2VyUmRtYSwgVkhPU1RfVVNFUl9SRE1BKQorCitzdHJ1Y3QgVkhvc3RVc2Vy
UmRtYSB7CisgICAgVmlydElPRGV2aWNlIHBhcmVudF9vYmo7CisgICAgQ2hhckJhY2tlbmQgY2hh
cmRldjsKKyAgICBpbnQzMl90IGJvb3RpbmRleDsKKyAgICBzdHJ1Y3QgdmlydGlvX3JkbWFfY29u
ZmlnIHJkbWFjZmc7CisgICAgc3RydWN0IHZob3N0X2RldiBkZXY7CisgICAgVmhvc3RVc2VyU3Rh
dGUgdmhvc3RfdXNlcjsKKyAgICBzdHJ1Y3Qgdmhvc3RfdmlydHF1ZXVlICp2aG9zdF92cXM7Cisg
ICAgVmlydFF1ZXVlICoqdmlydHFzOworCisgICAgaW50IG51bV9xdWV1ZXM7CisKKyAgICAvKiB2
aG9zdF91c2VyX3JkbWFfY29ubmVjdC92aG9zdF91c2VyX3JkbWFfZGlzY29ubmVjdCAqLworICAg
IGJvb2wgY29ubmVjdGVkOworICAgIC8qIHZob3N0X3VzZXJfcmRtYV9zdGFydC92aG9zdF91c2Vy
X3JkbWFfc3RvcCAqLworICAgIGJvb2wgc3RhcnRlZF92dTsKK307CisKKyNlbmRpZgpkaWZmIC0t
Z2l0IGEvaW5jbHVkZS9ody92aXJ0aW8vdmlydGlvLmggYi9pbmNsdWRlL2h3L3ZpcnRpby92aXJ0
aW8uaAppbmRleCA3ZDVmZmRjMTQ1Li5mNzRkYTYxNDc3IDEwMDY0NAotLS0gYS9pbmNsdWRlL2h3
L3ZpcnRpby92aXJ0aW8uaAorKysgYi9pbmNsdWRlL2h3L3ZpcnRpby92aXJ0aW8uaApAQCAtMzY5
LDcgKzM2OSw3IEBAIHR5cGVkZWYgc3RydWN0IFZpcnRJT1JOR0NvbmYgVmlydElPUk5HQ29uZjsK
ICAgICBERUZJTkVfUFJPUF9CSVQ2NCgicGFja2VkIiwgX3N0YXRlLCBfZmllbGQsIFwKICAgICAg
ICAgICAgICAgICAgICAgICBWSVJUSU9fRl9SSU5HX1BBQ0tFRCwgZmFsc2UpLCBcCiAgICAgREVG
SU5FX1BST1BfQklUNjQoInF1ZXVlX3Jlc2V0IiwgX3N0YXRlLCBfZmllbGQsIFwKLSAgICAgICAg
ICAgICAgICAgICAgICBWSVJUSU9fRl9SSU5HX1JFU0VULCB0cnVlKQorICAgICAgICAgICAgICAg
ICAgICAgIFZJUlRJT19GX1JJTkdfUkVTRVQsIGZhbHNlKQogCiBod2FkZHIgdmlydGlvX3F1ZXVl
X2dldF9kZXNjX2FkZHIoVmlydElPRGV2aWNlICp2ZGV2LCBpbnQgbik7CiBib29sIHZpcnRpb19x
dWV1ZV9lbmFibGVkX2xlZ2FjeShWaXJ0SU9EZXZpY2UgKnZkZXYsIGludCBuKTsKZGlmZiAtLWdp
dCBhL2luY2x1ZGUvc3RhbmRhcmQtaGVhZGVycy9saW51eC92aXJ0aW9faWRzLmggYi9pbmNsdWRl
L3N0YW5kYXJkLWhlYWRlcnMvbGludXgvdmlydGlvX2lkcy5oCmluZGV4IDdhYTJlYjc2NjIuLmZm
MmQwYjAxYjQgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvc3RhbmRhcmQtaGVhZGVycy9saW51eC92aXJ0
aW9faWRzLmgKKysrIGIvaW5jbHVkZS9zdGFuZGFyZC1oZWFkZXJzL2xpbnV4L3ZpcnRpb19pZHMu
aApAQCAtNjgsNiArNjgsNyBAQAogI2RlZmluZSBWSVJUSU9fSURfQVVESU9fUE9MSUNZCQkzOSAv
KiB2aXJ0aW8gYXVkaW8gcG9saWN5ICovCiAjZGVmaW5lIFZJUlRJT19JRF9CVAkJCTQwIC8qIHZp
cnRpbyBibHVldG9vdGggKi8KICNkZWZpbmUgVklSVElPX0lEX0dQSU8JCQk0MSAvKiB2aXJ0aW8g
Z3BpbyAqLworI2RlZmluZSBWSVJUSU9fSURfUkRNQSAgICAgICAgICA0MiAvKiB2aXJ0aW8gcmRt
YSAqLwogCiAvKgogICogVmlydGlvIFRyYW5zaXRpb25hbCBJRHMKZGlmZiAtLWdpdCBhL2luY2x1
ZGUvc3RhbmRhcmQtaGVhZGVycy9yZG1hL3ZpcnRpb19yZG1hLmggYi9pbmNsdWRlL3N0YW5kYXJk
LWhlYWRlcnMvcmRtYS92aXJ0aW9fcmRtYS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAw
MDAwMDAwMDAuLmI0OTNmOTczZDgKLS0tIC9kZXYvbnVsbAorKysgYi9pbmNsdWRlL3N0YW5kYXJk
LWhlYWRlcnMvcmRtYS92aXJ0aW9fcmRtYS5oCkBAIC0wLDAgKzEsNjAgQEAKKy8qCisgKiBWaXJ0
aW8gUkRNQSBEZXZpY2UKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMjEgQnl0ZWRhbmNlIEluYy4K
KyAqCisgKiBBdXRob3JzOgorICogIEp1bmppIFdlaSA8d2VpanVuamlAYnl0ZWRhbmNlLmNvbT4K
KyAqCisgKiBUaGlzIHdvcmsgaXMgbGljZW5zZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUg
R1BMLCB2ZXJzaW9uIDIuICBTZWUKKyAqIHRoZSBDT1BZSU5HIGZpbGUgaW4gdGhlIHRvcC1sZXZl
bCBkaXJlY3RvcnkuCisgKgorICovCisKKyNpZm5kZWYgX0xJTlVYX1ZJUlRJT19SRE1BX0gKKyNk
ZWZpbmUgX0xJTlVYX1ZJUlRJT19SRE1BX0gKKworI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cisj
aW5jbHVkZSA8aW5maW5pYmFuZC92ZXJicy5oPgorCisjaW5jbHVkZSAic3RhbmRhcmQtaGVhZGVy
cy9saW51eC92aXJ0aW9faWRzLmgiCisjaW5jbHVkZSAic3RhbmRhcmQtaGVhZGVycy9saW51eC92
aXJ0aW9fY29uZmlnLmgiCisjaW5jbHVkZSAic3RhbmRhcmQtaGVhZGVycy9saW51eC92aXJ0aW9f
dHlwZXMuaCIKKworc3RydWN0IHZpcnRpb19yZG1hX2NvbmZpZyB7CisgICAgX19sZTMyICAgICAg
ICAgcGh5c19wb3J0X2NudDsKKworICAgIF9fbGU2NCAgICAgICAgIHN5c19pbWFnZV9ndWlkOwor
ICAgIF9fbGUzMiAgICAgICAgIHZlbmRvcl9pZDsKKyAgICBfX2xlMzIgICAgICAgICB2ZW5kb3Jf
cGFydF9pZDsKKyAgICBfX2xlMzIgICAgICAgICBod192ZXI7CisgICAgX19sZTY0ICAgICAgICAg
bWF4X21yX3NpemU7CisgICAgX19sZTY0ICAgICAgICAgcGFnZV9zaXplX2NhcDsKKyAgICBfX2xl
MzIgICAgICAgICBtYXhfcXA7CisgICAgX19sZTMyICAgICAgICAgbWF4X3FwX3dyOworICAgIF9f
bGU2NCAgICAgICAgIGRldmljZV9jYXBfZmxhZ3M7CisgICAgX19sZTMyICAgICAgICAgbWF4X3Nl
bmRfc2dlOworICAgIF9fbGUzMiAgICAgICAgIG1heF9yZWN2X3NnZTsKKyAgICBfX2xlMzIgICAg
ICAgICBtYXhfc2dlX3JkOworICAgIF9fbGUzMiAgICAgICAgIG1heF9jcTsKKyAgICBfX2xlMzIg
ICAgICAgICBtYXhfY3FlOworICAgIF9fbGUzMiAgICAgICAgIG1heF9tcjsKKyAgICBfX2xlMzIg
ICAgICAgICBtYXhfcGQ7CisgICAgX19sZTMyICAgICAgICAgbWF4X3FwX3JkX2F0b207CisgICAg
X19sZTMyICAgICAgICAgbWF4X3Jlc19yZF9hdG9tOworICAgIF9fbGUzMiAgICAgICAgIG1heF9x
cF9pbml0X3JkX2F0b207CisgICAgX19sZTMyICAgICAgICAgYXRvbWljX2NhcDsKKyAgICBfX2xl
MzIgICAgICAgICBtYXhfbXc7CisgICAgX19sZTMyICAgICAgICAgbWF4X21jYXN0X2dycDsKKyAg
ICBfX2xlMzIgICAgICAgICBtYXhfbWNhc3RfcXBfYXR0YWNoOworICAgIF9fbGUzMiAgICAgICAg
IG1heF90b3RhbF9tY2FzdF9xcF9hdHRhY2g7CisgICAgX19sZTMyICAgICAgICAgbWF4X2FoOwor
ICAgIF9fbGUzMiAgICAgICAgIG1heF9mYXN0X3JlZ19wYWdlX2xpc3RfbGVuOworICAgIF9fbGUz
MiAgICAgICAgIG1heF9waV9mYXN0X3JlZ19wYWdlX2xpc3RfbGVuOworICAgIF9fbGUxNiAgICAg
ICAgIG1heF9wa2V5czsKKyAgICB1aW50OF90ICAgICAgICBsb2NhbF9jYV9hY2tfZGVsYXk7CisK
KyAgICB1aW50OF90ICAgICAgICAgICByZXNlcnZlZFs2NF07Cit9IFFFTVVfUEFDS0VEOworCisj
ZW5kaWYKLS0gCjIuNDMuMAoK


