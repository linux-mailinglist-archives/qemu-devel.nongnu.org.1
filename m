Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id E741C8AD14E
	for <lists+qemu-devel@lfdr.de>; Mon, 22 Apr 2024 17:54:20 +0200 (CEST)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1ryvyh-0007Gc-Au; Mon, 22 Apr 2024 11:53:11 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <clement.mathieu--drif@eviden.com>)
 id 1ryvyc-0007Eo-KR
 for qemu-devel@nongnu.org; Mon, 22 Apr 2024 11:53:07 -0400
Received: from smarthost4.eviden.com ([80.78.11.85])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <clement.mathieu--drif@eviden.com>)
 id 1ryvyZ-0007c1-14
 for qemu-devel@nongnu.org; Mon, 22 Apr 2024 11:53:05 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=eviden.com; i=@eviden.com; q=dns/txt; s=mail;
 t=1713801183; x=1745337183;
 h=from:to:cc:subject:date:message-id:references:
 in-reply-to:content-id:content-transfer-encoding: mime-version;
 bh=A//6ZkMyDQVH+O5DOpFjHEE8sA2/YPKnd/qwbDTuIZ4=;
 b=mjlOAiZRzeemq/D7wicXmj1Vi6KIWI9SRULYvXy6dhcClUWbCyd1uXRs
 Xb+eKEiMcUw/G4BpbL0ltlLprxH0AwHCwxUvmjY5E5zcInu4euKIdAZVA
 0VBd7ACxsgpdHQ/4rUzEwLyxQ2fKYWlWRiFmVfNUAWIWFmjc1WKE18M4m
 vy+xFwDcxqXJBTTwNrFPjtHpUAx0qxMZMq8iC5IvwqcmVVPc8eVLDivnP
 /tOLQ/1wI43G7RNKctUL3/nODZEKW1o7oPMpx/rHHcczT32vsjrOZtYrA
 IZRJkKh6loRJqP5bCY7nXXPFrNp9ahlNOSL2MTXuJcbUUcJnb4w1ZuXab w==;
X-IronPort-AV: E=Sophos;i="6.07,220,1708383600"; d="scan'208";a="11027673"
X-MGA-submission: =?us-ascii?q?MDE2w0TDNpiD8qfN4OSreQ0o9Xf9QP4shRuEVX?=
 =?us-ascii?q?hdcX4Fw2ZFgB2lpunDlB3Ij+w+jYsM7/LpwVl+vtoHMSIvwDfu26Gf5i?=
 =?us-ascii?q?MLUYMSKzwV7JIqVIC/AwLcwdAmpr1BmM/fmzC9Rq5/psCTkhCY0xHwQw?=
 =?us-ascii?q?vKOM6in8BGhaMG1DL4mgFarg=3D=3D?=
Received: from mail-am0eur02lp2233.outbound.protection.outlook.com (HELO
 EUR02-AM0-obe.outbound.protection.outlook.com) ([104.47.11.233])
 by smarthost4.eviden.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 22 Apr 2024 17:52:57 +0200
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=Ogqn2IWFzIdVt27toFb8pGSjqflmcjztDm4JKpX0NrKVQl1lPqwmxt9cgES1xl05Y18fxxtOtVn3H6uLck0dHDgB6HyywjzBPMqWuTX9QcK6cOJJg6jySF7greKbiS+bFIDIffkxyB+AE3uY3ol6aXomTAfey2eMDETFoOTIzjf/UOxdw5f2Difd5lPKP7Vg6qYyf/kL//5HStcJYP2WkpjBOvmv1jWV8p/HS/y6uxkXSLjNTRAGKKXorvX1+/p6qO4URMKnwYyycdKTgrpzdNx+h/VHziB8n0NvNIO6EsHj3ke/ZGPl7Sj4IvkFfpdahHJA9joaGtIazL3LOWZW2g==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=A//6ZkMyDQVH+O5DOpFjHEE8sA2/YPKnd/qwbDTuIZ4=;
 b=M7fSYPNAo9I+shPTIX/mZS7IrZINK1qjF3wsKed/f3wylIi8eOw7Gv4lRXqZPvG1vAjtofmMtKrjw5/RwwDK8vC33+k8hQmhk9+0NnlqlXUhZHUVTA8zPkdXJaoFlkeMKNdhBWhv5AqNOQ4oswMUEbnknf0OTVvXvkbn/p7KM6Rfta2+iu6wPF2w8l3cNeWsObNLUxqkPhQa6Wzwb0YUcTze/wW7xl5Ez6E5n070CqiaIpwgm1g7jS9Lkyki4FI56OnL7UIPfD5f6mJaQw6hrePZghpEmAL4cQlCIV0pYZFESiCA+5J8epPbWx7uO45/a5hdr+y+/ilO6U1VpRKJ1g==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=eviden.com; dmarc=pass action=none header.from=eviden.com;
 dkim=pass header.d=eviden.com; arc=none
Received: from AM8PR07MB7602.eurprd07.prod.outlook.com (2603:10a6:20b:24b::7)
 by DU0PR07MB9626.eurprd07.prod.outlook.com (2603:10a6:10:31e::21)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.7472.44; Mon, 22 Apr
 2024 15:52:54 +0000
Received: from AM8PR07MB7602.eurprd07.prod.outlook.com
 ([fe80::fbd7:ca71:b636:6f9d]) by AM8PR07MB7602.eurprd07.prod.outlook.com
 ([fe80::fbd7:ca71:b636:6f9d%5]) with mapi id 15.20.7472.044; Mon, 22 Apr 2024
 15:52:54 +0000
From: CLEMENT MATHIEU--DRIF <clement.mathieu--drif@eviden.com>
To: "qemu-devel@nongnu.org" <qemu-devel@nongnu.org>
CC: "jasowang@redhat.com" <jasowang@redhat.com>, CLEMENT MATHIEU--DRIF
 <clement.mathieu--drif@eviden.com>
Subject: [PATCH intel_iommu 4/7] intel_iommu: add support for first-stage
 translation
Thread-Topic: [PATCH intel_iommu 4/7] intel_iommu: add support for first-stage
 translation
Thread-Index: AQHalM0il2RzFQqe1USu5Fe1IhjH8A==
Date: Mon, 22 Apr 2024 15:52:53 +0000
Message-ID: <20240422155236.129179-5-clement.mathieu--drif@eviden.com>
References: <20240422155236.129179-1-clement.mathieu--drif@eviden.com>
In-Reply-To: <20240422155236.129179-1-clement.mathieu--drif@eviden.com>
Accept-Language: en-GB, fr-FR, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
authentication-results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=eviden.com;
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: AM8PR07MB7602:EE_|DU0PR07MB9626:EE_
x-ms-office365-filtering-correlation-id: 7cd75ea8-5305-411a-4d10-08dc62e44618
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: =?utf-8?B?NzNqZUJOSWsrN2c0MisrdzJHK3F4QUYrWkMrdEgvWkI4UTJTekxROWR2YVh4?=
 =?utf-8?B?blh2T3lZREtNK1NrOTFjeUo5V21WNTFYQmM4dUIrZHFUS0VQT3dqTjZnN0RV?=
 =?utf-8?B?RVRyRWtsaDRwS0F2RG53Z2V3Und2M3RpMzZzSGxuZWhzK1B4RVZPaDJBVlFG?=
 =?utf-8?B?eklVb3J3OXdGNXFYWERMVktZVVRUdWc2VGs1Q1ZLMmlzOHo5VGNlcTJYQ3lk?=
 =?utf-8?B?bUtydXRieVlZb2tVWFRIL3ZZTnNPdXhyYWE3Z0FHbFFmVkZQRUFNdHhuVkFH?=
 =?utf-8?B?YW9Kc2V1bmZ0NzhCTTNIR3JjNG5heHlJeDZaL0VOcHVqT2xndVphclliNC9p?=
 =?utf-8?B?UWFTMTZsRHNQWkEvbDRHdDlZVmZvU3BTWjFReFZ3VndpZ0NZQ3lTblZpQUlz?=
 =?utf-8?B?NDdJV3RidkNNZFYrc1ZUWkltbkFwOTVFWk9Rc09nSENXOWlYQkRDc0pyYXBi?=
 =?utf-8?B?eGtSL1FWSzJqTmp0cmN0ZjQ5SWxLemMwdjZtbDdENDJFR2RVZTNmTmE2Vk0r?=
 =?utf-8?B?SmdwMFJHTy9NV3lZOUcraXozeXlTMG5zWjVBVTViZ3Y2WldFNzlYRUVhZE8r?=
 =?utf-8?B?aWZhV3lmNWlFT3labys2TTZ4RTdnaENYeFo0YkN3LzU5ekx6MkFLaW9PMTNU?=
 =?utf-8?B?Rlp0UUVQNFJOZEFyNytxYndyK2V4NmN0bUhCcGY5SlZZQ0plSG1kci9OTGdJ?=
 =?utf-8?B?K3B1TmhJZG8yck1LSk8xa2JLQXZQa1FOTG4xdS9ZZXB1VWF4MDRVZmRUcEJj?=
 =?utf-8?B?OFNxNk54U3VmSUhidCt0UHVlRXVscnpqMVBkOHRBOW5wNFg4eXB5TVVHRHhu?=
 =?utf-8?B?T285OWhMVFY1RmlMclRrU09yakVxNmhzNnhWS3ZVUVdwd05icFNodHdGZTFh?=
 =?utf-8?B?WmR1TFplTy9QeHUrWUxzb2pQSFJQajkvNm5ZY0FUczJTZC93OGpwRGJycm1k?=
 =?utf-8?B?d25zOVNKNkQra0NTUUtJMVdEY0dlcGdLTDh2d1BiSFgrY21XSjdBalNSRG9B?=
 =?utf-8?B?dEo4VHdLRXR5dGU3NGNqbzljTE1oeUEvd01iLzhBczNsbkJRRzRnTVNqUHJw?=
 =?utf-8?B?OUhteDRqcVFpdCtnMURsRHpTaGRNb3lUSmR4TW14ZVE3ZVZUTEgwRk9UdkpS?=
 =?utf-8?B?RVhpZTJCYlFMdVBPU1EvMzBydWNTMWN2UjhRdGJXaFR2R05sNWhTdlJaS3JU?=
 =?utf-8?B?K3BKQkJ2TUhwbE9lRXg4QWRTZGdVTWlWQnRFNHRtVGxLaVBoTzJGRW5RRHQy?=
 =?utf-8?B?b3RWaWxraWh0YUNmYk9icVEzZXJlMkRKSHpzTGo2aVk4Vkc1ZU9Jc0pkMWRN?=
 =?utf-8?B?Mm1VdzF1YUNtRHprWEVQaG9uY2xUMlhLc3lVMEtiSGlJRXV6N0d4U0VuRk1w?=
 =?utf-8?B?MDNNSU5LbVZlUHRoN21mYW5ZZ2xaaEIxd29UMzhZemlvMUJqeHB3cGlaS0R2?=
 =?utf-8?B?cDhPaDNGQ0RNOVlSNDRSaHo0R3RVTm9UMXZ6WW8xb2NVSHJMTlBhYkhwZ3ow?=
 =?utf-8?B?MkdNZVgyQzIzWXB6L2IxUlBrc0tOUGEvYncrS0JJdW9XRUp6MGJnVzBqbmp5?=
 =?utf-8?B?ZjdjQVArTnJVTnpJdnBhYTFuUXRGcjF5NVFaTzc4Q2sxd05YY0duVmUwd0tR?=
 =?utf-8?B?YUxTTDJ1d0w2RUhnRitJMmFHamZQaWk0YlFlSTdQWVpEazN2blNuZkJ1VS9t?=
 =?utf-8?B?L3N1cG4reVNOeFh0ZUtsbldjZzN6RmpTWWxVNCs1blRKaTJPM2pySGdQYnpt?=
 =?utf-8?Q?0brLrbf6rVmMxiNH0WuIDWcuYRqbwRl2bH4ReLu?=
x-forefront-antispam-report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:AM8PR07MB7602.eurprd07.prod.outlook.com; PTR:; CAT:NONE;
 SFS:(13230031)(1800799015)(366007)(376005)(38070700009); DIR:OUT; SFP:1101; 
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?MlhPUXBvS0cxcTlpZ3F6OHRKd00yTWYxblBzRXhyZWx5Mm0xcjFhVnZXNU1r?=
 =?utf-8?B?VFdteEoyRlkxWisvS085UGl3UnYzWnlGak1sYVBhSFBLUE1Jb25OVEdBV09N?=
 =?utf-8?B?UDgrckt3ZWhkbE9rdXZ5c216TUZBWndwR0NEY1h1eGFiTGlBcWRFWWdCOUll?=
 =?utf-8?B?QWN0aWc0WXlwaXVnazlaeUthKzM1VGE0WWdWczc0NndiK2JGbVp5OWdKdnVB?=
 =?utf-8?B?ZTdWUFVqUXVERjJGc25rVjM2Qm9PYlBuanlRRUk4U0ppcnJYdkZqb0czVzBi?=
 =?utf-8?B?dnRkaWY3QmJPUHBpZGh1czJ6bWdadm1BRUkvSHpDMzdRUlFSSkNicCtzcG52?=
 =?utf-8?B?RkJMN2E4aHlFeGJyM0Z1TC9la0FYUTNJZC82Rzk2bnRKeXdUaTRUTzNqdEVP?=
 =?utf-8?B?b0VBSnFhRzhMUXF6bVAwM1F3aUw4MjU3K08vcnJ4TTFPcFFjNktsVnl2aFZz?=
 =?utf-8?B?YnFyUmJsM2NRVGpaRWZYeWNPYWVTbDI1M1NMYkdEelVONTRHNDBWMGdLTXJs?=
 =?utf-8?B?cmJDRFpwVkQ3dGp0UWR4bXhlUzRoYlJCNGpHYnFpeTdwWmFxeHhrYnJXWCtV?=
 =?utf-8?B?V2t1M0Q5TUFnZ0NKKy96d2VXWGk3czNOT21mbHEyZ0JNZmdDM2s2clY4Sng5?=
 =?utf-8?B?YnRQQSsxVGhVRjZJT2xXNGx6TU9uWE5rN1VsekVPTE1VS1dzM3plMlRTR21n?=
 =?utf-8?B?ZGVJTFhBbUhNcExiSDRkaVlqSnhBUWx3Vm5mVUE4VEp1YWQyb2k5S2lzQ2dT?=
 =?utf-8?B?REZrblFQWGJZMkFlWXJmbnBkTnJIWXFNb3NFZnlrb1FtLzAyWCs3dExITEdm?=
 =?utf-8?B?NUJZZzhWaVJUSmo1YUd5WXVsT1hpdlgyRGIzZkRaOVp1VGdqcEJYRythenlI?=
 =?utf-8?B?M3RMT2lSaExoZW0weVpLSTQyOVFBN1p3R0RQd1FUdm5TM05tZjE0VW14NDIy?=
 =?utf-8?B?ZkdYNFFUTnN5cldZVWpiTUh1MnhRa2RZTU5kb1ZUNENBTTNSVG03TWo5aGps?=
 =?utf-8?B?MU9RaFRTQk1BT01kK2VFQjB6SFJST1paSHlaSkpDT3BLNkQ4ZDM3QThtVEdC?=
 =?utf-8?B?TFVNdzdUaks4UVdzbWJHSlZSM1dYdlRIc21jVEtwZGlwc0Z2YmErV3VQY3o5?=
 =?utf-8?B?aElqditCVVZNeVl0clhxeFIzMUEzTzkxNU5vbEc3WDVtYWxyaHlTVUZCcUs4?=
 =?utf-8?B?ejF4WEdvVHRtTUhqQmZBT0N2ZEtuVXJlZGxVaURuQ0FWK2cyRGxVZ1pPM2sy?=
 =?utf-8?B?KzZDRmxrYnRuNUpPaCs4NFhnVUVXa24zNDNyeEV2MkZuaFNaZ2hmMmVGUk5E?=
 =?utf-8?B?MzJ0RjAzNkh4cnlwY0xHOE1POUdwdUc4bURDUTZlZzFWak1xbnovWTNFRXBJ?=
 =?utf-8?B?d0xuTmRWL3IycUdidEYwRDBDWUtVSkdxeWxiNnpxY2F1VmZVMDY3QTEvMDlI?=
 =?utf-8?B?TDIxUFdaRXRYMFp2WS9yV1pzVmJabUU1UmYxb0xmV2ordTdYdEptSDBDbG5N?=
 =?utf-8?B?S1FhMEFqaTdERXI5US9xTnBpVG1qekhEQWtyU2syTDRleC8xUHo4Y3VkRnZV?=
 =?utf-8?B?bDNMQ0tZb0htQVh2a2hiQWlkc0MzdFMyeDVwS3NQMkhMZG9TalFxMHdzcklX?=
 =?utf-8?B?NzJSc2FjNVdGNW16S2pBOTgzVHlpZWdkZ24wblB0NlpxT09EQ29rRDlFZnpz?=
 =?utf-8?B?a3hyNnBSOUl5T0llby9zZ1FSZkU0eFk2ai8yamVOSlVkaUEwU1IzbWt6cWZU?=
 =?utf-8?B?cEtQZDRpdXV0N0JtY05iNElpOVNOemdLakMxTjdibkU5dzRIWldKZ1I2em5k?=
 =?utf-8?B?L1RSTW5ZbEVIV1dqQm84V1p5Rkh3bmpDeHN2SzlrNzFXN01VUFlEUFR5MSsz?=
 =?utf-8?B?RnVNdDlDRmtmTDc2dXZidGc4WVpWODFwU3F5TmpLc21wRzFWRjFxc240T3Fj?=
 =?utf-8?B?ZzBYVlZVQ3VtbC9YRmxZNmdCZVpURXVGN3VoT0RPcC9aOTNhUVhXRDk4b29n?=
 =?utf-8?B?L3NxMnZ6a1VsV21KK3dSL3pqV3VEajdGVkNSSUNQajVhMWh1Vlk1WTJ1OFdq?=
 =?utf-8?B?NzdwTGp3WnE4c09YeS9JQTEySGVoNzJoSThFaDVoc1ZzV3h6TjV1dHBCUy9G?=
 =?utf-8?B?bGxVZE11NWwxSkhLbEZMOEJ2SkVaNGtoYi9uSHZqVGN5YkRGWGdVQk13ZDBv?=
 =?utf-8?Q?QNXU90moq4/6CGn/1Cynmm4=3D?=
Content-Type: text/plain; charset="utf-8"
Content-ID: <717C8F90C9DBAB4DAE6921D2483745CC@eurprd07.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: eviden.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: AM8PR07MB7602.eurprd07.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 7cd75ea8-5305-411a-4d10-08dc62e44618
X-MS-Exchange-CrossTenant-originalarrivaltime: 22 Apr 2024 15:52:53.3583 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 7d1c7785-2d8a-437d-b842-1ed5d8fbe00a
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: TSFiVvwbIrYVfzSeAJRYfPdEdOU9YmACt0vlr1t8CtqCsM6Szrt5+BUSC7R6JrObkhJSXJjBXUCnUiScYOyIB4ZksV9Grjq4uLJ+UR+7OH7GKkZ/M7/nQ59fBRTPF79r
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DU0PR07MB9626
Received-SPF: pass client-ip=80.78.11.85;
 envelope-from=clement.mathieu--drif@eviden.com; helo=smarthost4.eviden.com
X-Spam_score_int: -20
X-Spam_score: -2.1
X-Spam_bar: --
X-Spam_report: (-2.1 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, DKIM_VALID_EF=-0.1, SPF_HELO_PASS=-0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

VGhpcyB0cmFuc2xhdGlvbiBtb2RlIHdpbGwgb25seSBiZSBtYWRlIGF2YWlsYWJsZSBpbiBzY2Fs
YWJsZSBtb2RlDQoNClNpZ25lZC1vZmYtYnk6IENsw6ltZW50IE1hdGhpZXUtLURyaWYgPGNsZW1l
bnQubWF0aGlldS0tZHJpZkBldmlkZW4uY29tPg0KLS0tDQogaHcvaTM4Ni9pbnRlbF9pb21tdS5j
ICAgICAgICAgIHwgMzY0ICsrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLQ0KIGh3L2kz
ODYvaW50ZWxfaW9tbXVfaW50ZXJuYWwuaCB8ICA1MSArKysrLQ0KIDIgZmlsZXMgY2hhbmdlZCwg
MzYyIGluc2VydGlvbnMoKyksIDUzIGRlbGV0aW9ucygtKQ0KDQpkaWZmIC0tZ2l0IGEvaHcvaTM4
Ni9pbnRlbF9pb21tdS5jIGIvaHcvaTM4Ni9pbnRlbF9pb21tdS5jDQppbmRleCBiYTU0NTU5MGIx
Li4zYjlmMTIwZGVjIDEwMDY0NA0KLS0tIGEvaHcvaTM4Ni9pbnRlbF9pb21tdS5jDQorKysgYi9o
dy9pMzg2L2ludGVsX2lvbW11LmMNCkBAIC03MTMsNiArNzEzLDIxIEBAIHN0YXRpYyB1aW50NjRf
dCB2dGRfZ2V0X3B0ZShkbWFfYWRkcl90IGJhc2VfYWRkciwgdWludDMyX3QgaW5kZXgpDQogICAg
IHJldHVybiBwdGU7DQogfQ0KIA0KK3N0YXRpYyBNZW1UeFJlc3VsdCB2dGRfc2V0X2ZsYWdfaW5f
cHRlKGRtYV9hZGRyX3QgYmFzZV9hZGRyLCB1aW50MzJfdCBpbmRleCwNCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCBwdGUsIHVpbnQ2NF90IGZsYWcpDQor
ew0KKyAgICBhc3NlcnQoaW5kZXggPCBWVERfUFRfRU5UUllfTlIpOw0KKyAgICBpZiAocHRlICYg
ZmxhZykgew0KKyAgICAgICAgcmV0dXJuIE1FTVRYX09LOw0KKyAgICB9DQorICAgIHB0ZSB8PSBm
bGFnOw0KKyAgICBwdGUgPSBjcHVfdG9fbGU2NChwdGUpOw0KKyAgICByZXR1cm4gZG1hX21lbW9y
eV93cml0ZSgmYWRkcmVzc19zcGFjZV9tZW1vcnksDQorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGJhc2VfYWRkciArIGluZGV4ICogc2l6ZW9mKHB0ZSksDQorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICZwdGUsIHNpemVvZihwdGUpLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVEKTsNCit9DQorDQogLyogR2l2ZW4gYW4gaW92YSBhbmQg
dGhlIGxldmVsIG9mIHBhZ2luZyBzdHJ1Y3R1cmUsIHJldHVybiB0aGUgb2Zmc2V0DQogICogb2Yg
Y3VycmVudCBsZXZlbC4NCiAgKi8NCkBAIC03MzAsMTEgKzc0NSwxNyBAQCBzdGF0aWMgaW5saW5l
IGJvb2wgdnRkX2lzX2xldmVsX3N1cHBvcnRlZChJbnRlbElPTU1VU3RhdGUgKnMsIHVpbnQzMl90
IGxldmVsKQ0KIH0NCiANCiAvKiBSZXR1cm4gdHJ1ZSBpZiBjaGVjayBwYXNzZWQsIG90aGVyd2lz
ZSBmYWxzZSAqLw0KLXN0YXRpYyBpbmxpbmUgYm9vbCB2dGRfcGVfdHlwZV9jaGVjayhYODZJT01N
VVN0YXRlICp4ODZfaW9tbXUsDQorc3RhdGljIGlubGluZSBib29sIHZ0ZF9wZV90eXBlX2NoZWNr
KEludGVsSU9NTVVTdGF0ZSAqcywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgVlREUEFTSURFbnRyeSAqcGUpDQogew0KKyAgICBYODZJT01NVVN0YXRlICp4ODZfaW9tbXUg
PSBYODZfSU9NTVVfREVWSUNFKHMpOw0KKw0KICAgICBzd2l0Y2ggKFZURF9QRV9HRVRfVFlQRShw
ZSkpIHsNCiAgICAgY2FzZSBWVERfU01fUEFTSURfRU5UUllfRkxUOg0KKyAgICAgICAgaWYgKCEo
cy0+ZWNhcCAmIFZURF9FQ0FQX0ZMVFMpKSB7DQorICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0K
KyAgICAgICAgfQ0KKyAgICAgICAgYnJlYWs7DQogICAgIGNhc2UgVlREX1NNX1BBU0lEX0VOVFJZ
X1NMVDoNCiAgICAgY2FzZSBWVERfU01fUEFTSURfRU5UUllfTkVTVEVEOg0KICAgICAgICAgYnJl
YWs7DQpAQCAtNzg0LDYgKzgwNSwxMSBAQCBzdGF0aWMgaW5saW5lIGJvb2wgdnRkX3BlX3ByZXNl
bnQoVlREUEFTSURFbnRyeSAqcGUpDQogICAgIHJldHVybiBwZS0+dmFsWzBdICYgVlREX1BBU0lE
X0VOVFJZX1A7DQogfQ0KIA0KK3N0YXRpYyBpbmxpbmUgYm9vbCB2dGRfZmxfcHRlX3ByZXNlbnQo
dWludDY0X3QgcHRlKQ0KK3sNCisgICAgcmV0dXJuIHB0ZSAmIFZURF9GTF9QVEVfUDsNCit9DQor
DQogc3RhdGljIGludCB2dGRfZ2V0X3BlX2luX3Bhc2lkX2xlYWZfdGFibGUoSW50ZWxJT01NVVN0
YXRlICpzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQz
Ml90IHBhc2lkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRt
YV9hZGRyX3QgYWRkciwNCkBAIC03OTEsNyArODE3LDYgQEAgc3RhdGljIGludCB2dGRfZ2V0X3Bl
X2luX3Bhc2lkX2xlYWZfdGFibGUoSW50ZWxJT01NVVN0YXRlICpzLA0KIHsNCiAgICAgdWludDMy
X3QgaW5kZXg7DQogICAgIGRtYV9hZGRyX3QgZW50cnlfc2l6ZTsNCi0gICAgWDg2SU9NTVVTdGF0
ZSAqeDg2X2lvbW11ID0gWDg2X0lPTU1VX0RFVklDRShzKTsNCiANCiAgICAgaW5kZXggPSBWVERf
UEFTSURfVEFCTEVfSU5ERVgocGFzaWQpOw0KICAgICBlbnRyeV9zaXplID0gVlREX1BBU0lEX0VO
VFJZX1NJWkU7DQpAQCAtODA1LDcgKzgzMCw3IEBAIHN0YXRpYyBpbnQgdnRkX2dldF9wZV9pbl9w
YXNpZF9sZWFmX3RhYmxlKEludGVsSU9NTVVTdGF0ZSAqcywNCiAgICAgfQ0KIA0KICAgICAvKiBE
byB0cmFuc2xhdGlvbiB0eXBlIGNoZWNrICovDQotICAgIGlmICghdnRkX3BlX3R5cGVfY2hlY2so
eDg2X2lvbW11LCBwZSkpIHsNCisgICAgaWYgKCF2dGRfcGVfdHlwZV9jaGVjayhzLCBwZSkpIHsN
CiAgICAgICAgIHJldHVybiAtVlREX0ZSX1BBU0lEX1RBQkxFX0lOVjsNCiAgICAgfQ0KIA0KQEAg
LTEwMjcsNiArMTA1MiwzNCBAQCBzdGF0aWMgaW5saW5lIGJvb2wgdnRkX2lvdmFfc2xfcmFuZ2Vf
Y2hlY2soSW50ZWxJT01NVVN0YXRlICpzLA0KICAgICByZXR1cm4gIShpb3ZhICYgfih2dGRfaW92
YV9saW1pdChzLCBjZSwgYXcsIHBhc2lkKSAtIDEpKTsNCiB9DQogDQorLyogUmV0dXJuIHRydWUg
aWYgSU9WQSBpcyBjYW5vbmljYWwsIG90aGVyd2lzZSBmYWxzZS4gKi8NCitzdGF0aWMgYm9vbCB2
dGRfaW92YV9mbF9jaGVja19jYW5vbmljYWwoSW50ZWxJT01NVVN0YXRlICpzLA0KKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCBpb3ZhLCBWVERDb250ZXh0
RW50cnkgKmNlLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50
OF90IGF3LCB1aW50MzJfdCBwYXNpZCkNCit7DQorICAgIHVpbnQ2NF90IGlvdmFfbGltaXQgPSB2
dGRfaW92YV9saW1pdChzLCBjZSwgYXcsIHBhc2lkKTsNCisgICAgdWludDY0X3QgdXBwZXJfYml0
c19tYXNrID0gfihpb3ZhX2xpbWl0IC0gMSk7DQorICAgIHVpbnQ2NF90IHVwcGVyX2JpdHMgPSBp
b3ZhICYgdXBwZXJfYml0c19tYXNrOw0KKyAgICBib29sIG1zYiA9ICgoaW92YSAmIChpb3ZhX2xp
bWl0ID4+IDEpKSAhPSAwKTsNCisgICAgcmV0dXJuICEoDQorICAgICAgICAgICAgICghbXNiICYm
ICh1cHBlcl9iaXRzICE9IDApKSB8fA0KKyAgICAgICAgICAgICAobXNiICYmICh1cHBlcl9iaXRz
ICE9IHVwcGVyX2JpdHNfbWFzaykpDQorICAgICAgICAgICAgKTsNCit9DQorDQorLyogUmV0dXJu
IHRoZSBwYWdlIHRhYmxlIGJhc2UgYWRkcmVzcyBjb3JyZXNwb25kaW5nIHRvIHRoZSB0cmFuc2xh
dGlvbiB0eXBlLiAqLw0KK3N0YXRpYyBkbWFfYWRkcl90IHZ0ZF9wZV9nZXRfcGd0YmxfYmFzZShW
VERQQVNJREVudHJ5ICpwZSkNCit7DQorICAgIHVpbnQxNl90IHBndHQgPSBWVERfUEVfR0VUX1RZ
UEUocGUpOw0KKyAgICBpZiAocGd0dCA9PSBWVERfU01fUEFTSURfRU5UUllfRkxUKSB7DQorICAg
ICAgICByZXR1cm4gcGUtPnZhbFsyXSAmIFZURF9TTV9QQVNJRF9FTlRSWV9QVFBUUjsNCisgICAg
fSBlbHNlIGlmIChwZ3R0ID09IFZURF9TTV9QQVNJRF9FTlRSWV9TTFQpIHsNCisgICAgICAgIHJl
dHVybiBwZS0+dmFsWzBdICYgVlREX1NNX1BBU0lEX0VOVFJZX1BUUFRSOw0KKyAgICB9DQorDQor
ICAgIHJldHVybiAwOyAvKiBOb3Qgc3VwcG9ydGVkICovDQorfQ0KKw0KIHN0YXRpYyBkbWFfYWRk
cl90IHZ0ZF9nZXRfaW92YV9wZ3RibF9iYXNlKEludGVsSU9NTVVTdGF0ZSAqcywNCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWVERDb250ZXh0RW50cnkgKmNlLA0K
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHBhc2lk
KQ0KQEAgLTEwMzUsNyArMTA4OCw3IEBAIHN0YXRpYyBkbWFfYWRkcl90IHZ0ZF9nZXRfaW92YV9w
Z3RibF9iYXNlKEludGVsSU9NTVVTdGF0ZSAqcywNCiANCiAgICAgaWYgKHMtPnJvb3Rfc2NhbGFi
bGUpIHsNCiAgICAgICAgIHZ0ZF9jZV9nZXRfcmlkMnBhc2lkX2VudHJ5KHMsIGNlLCAmcGUsIHBh
c2lkKTsNCi0gICAgICAgIHJldHVybiBwZS52YWxbMF0gJiBWVERfU01fUEFTSURfRU5UUllfU0xQ
VFBUUjsNCisgICAgICAgIHJldHVybiB2dGRfcGVfZ2V0X3BndGJsX2Jhc2UoJnBlKTsNCiAgICAg
fQ0KIA0KICAgICByZXR1cm4gdnRkX2NlX2dldF9zbHB0X2Jhc2UoY2UpOw0KQEAgLTEwNTMsNiAr
MTEwNiwxMCBAQCBzdGF0aWMgZG1hX2FkZHJfdCB2dGRfZ2V0X2lvdmFfcGd0YmxfYmFzZShJbnRl
bElPTU1VU3RhdGUgKnMsDQogc3RhdGljIHVpbnQ2NF90IHZ0ZF9zcHRlX3JzdmRbVlREX1NQVEVf
UlNWRF9MRU5dOw0KIHN0YXRpYyB1aW50NjRfdCB2dGRfc3B0ZV9yc3ZkX2xhcmdlW1ZURF9TUFRF
X1JTVkRfTEVOXTsNCiANCisjZGVmaW5lIFZURF9GUFRFX1JTVkRfTEVOIDUNCitzdGF0aWMgdWlu
dDY0X3QgdnRkX2ZwdGVfcnN2ZFtWVERfRlBURV9SU1ZEX0xFTl07DQorc3RhdGljIHVpbnQ2NF90
IHZ0ZF9mcHRlX3JzdmRfbGFyZ2VbVlREX0ZQVEVfUlNWRF9MRU5dOw0KKw0KIHN0YXRpYyBib29s
IHZ0ZF9zbHB0ZV9ub256ZXJvX3JzdmQodWludDY0X3Qgc2xwdGUsIHVpbnQzMl90IGxldmVsKQ0K
IHsNCiAgICAgdWludDY0X3QgcnN2ZF9tYXNrOw0KQEAgLTEwNzksMjEgKzExMzYsMTQwIEBAIHN0
YXRpYyBib29sIHZ0ZF9zbHB0ZV9ub256ZXJvX3JzdmQodWludDY0X3Qgc2xwdGUsIHVpbnQzMl90
IGxldmVsKQ0KICAgICByZXR1cm4gc2xwdGUgJiByc3ZkX21hc2s7DQogfQ0KIA0KLS8qIEdpdmVu
IHRoZSBAaW92YSwgZ2V0IHJlbGV2YW50IEBzbHB0ZXAuIEBzbHB0ZV9sZXZlbCB3aWxsIGJlIHRo
ZSBsYXN0IGxldmVsDQotICogb2YgdGhlIHRyYW5zbGF0aW9uLCBjYW4gYmUgdXNlZCBmb3IgZGVj
aWRpbmcgdGhlIHNpemUgb2YgbGFyZ2UgcGFnZS4NCi0gKi8NCi1zdGF0aWMgaW50IHZ0ZF9pb3Zh
X3RvX3NscHRlKEludGVsSU9NTVVTdGF0ZSAqcywgVlREQ29udGV4dEVudHJ5ICpjZSwNCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ2NF90IGlvdmEsIGJvb2wgaXNfd3JpdGUsDQot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCAqc2xwdGVwLCB1aW50MzJfdCAq
c2xwdGVfbGV2ZWwsDQotICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sICpyZWFkcywg
Ym9vbCAqd3JpdGVzLCB1aW50OF90IGF3X2JpdHMsDQotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1aW50MzJfdCBwYXNpZCkNCitzdGF0aWMgYm9vbCB2dGRfZmxwdGVfbm9uemVyb19yc3Zk
KHVpbnQ2NF90IGZscHRlLCB1aW50MzJfdCBsZXZlbCkNCit7DQorICAgIHVpbnQ2NF90IHJzdmRf
bWFzazsNCisgICAgYXNzZXJ0KGxldmVsIDwgVlREX0ZQVEVfUlNWRF9MRU4pOw0KKyAgICBhc3Nl
cnQobGV2ZWwpOw0KKw0KKyAgICBpZiAoKGxldmVsID09IFZURF9GTF9QRF9MRVZFTCB8fCBsZXZl
bCA9PSBWVERfRkxfUERQX0xFVkVMKSAmJg0KKyAgICAgICAgKGZscHRlICYgVlREX1BUX1BBR0Vf
U0laRV9NQVNLKSkgew0KKyAgICAgICAgLyogbGFyZ2UgcGFnZSAqLw0KKyAgICAgICAgcnN2ZF9t
YXNrID0gdnRkX2ZwdGVfcnN2ZF9sYXJnZVtsZXZlbF07DQorICAgIH0gZWxzZSB7DQorICAgICAg
ICByc3ZkX21hc2sgPSB2dGRfZnB0ZV9yc3ZkW2xldmVsXTsNCisgICAgfQ0KKw0KKyAgICByZXR1
cm4gZmxwdGUgJiByc3ZkX21hc2s7DQorfQ0KKw0KK3N0YXRpYyBpbnQgdnRkX2lvdmFfdG9fcHRl
X2NoZWNrX3JlYWRfZXJyb3IoSW50ZWxJT01NVVN0YXRlICpzLA0KKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgVlREQ29udGV4dEVudHJ5ICpjZSwgdWludDY0X3Qg
aW92YSwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ2
NF90IHB0ZSwgdWludDMyX3QgcGFzaWQsDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1aW50MzJfdCBsZXZlbCwgdWludDE2X3QgcGd0dCkNCit7DQorICAgIGlm
IChwdGUgPT0gKHVpbnQ2NF90KS0xKSB7DQorICAgICAgICBlcnJvcl9yZXBvcnRfb25jZSgiJXM6
IGRldGVjdGVkIHJlYWQgZXJyb3Igb24gRE1BUiBwdGUgIg0KKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAiKGlvdmE9MHglIiBQUkl4NjQgIiwgcGFzaWQ9MHglIiBQUkl4MzIgIikiLA0KKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBfX2Z1bmNfXywgaW92YSwgcGFzaWQpOw0KKyAgICAg
ICAgaWYgKGxldmVsID09IHZ0ZF9nZXRfaW92YV9sZXZlbChzLCBjZSwgcGFzaWQpKSB7DQorICAg
ICAgICAgICAgLyogSW52YWxpZCBwcm9ncmFtbWluZyBvZiBjb250ZXh0LWVudHJ5ICovDQorICAg
ICAgICAgICAgaWYgKHMtPnJvb3Rfc2NhbGFibGUpIHsNCisgICAgICAgICAgICAgICAgcmV0dXJu
IHBndHQgPT0gVlREX1NNX1BBU0lEX0VOVFJZX0ZMVCA/DQorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgLVZURF9GUl9GSVJTVF9GU1BFX0FDQ0VTUyA6DQorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgLVZURF9GUl9GSVJTVF9TU1BFX0FDQ0VTUzsNCisgICAg
ICAgICAgICB9IGVsc2Ugew0KKyAgICAgICAgICAgICAgICByZXR1cm4gLVZURF9GUl9DT05URVhU
X0VOVFJZX0lOVjsNCisgICAgICAgICAgICB9DQorICAgICAgICB9IGVsc2Ugew0KKyAgICAgICAg
ICAgIGlmIChzLT5yb290X3NjYWxhYmxlKSB7DQorICAgICAgICAgICAgICAgIHJldHVybiBwZ3R0
ID09IFZURF9TTV9QQVNJRF9FTlRSWV9GTFQgPw0KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIC1WVERfRlJfRlNQRV9BQ0NFU1MgOg0KKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIC1WVERfRlJfU1NQRV9BQ0NFU1M7DQorICAgICAgICAgICAgfSBlbHNlIHsN
CisgICAgICAgICAgICAgICAgcmV0dXJuIC1WVERfRlJfUEFHSU5HX0VOVFJZX0lOVjsNCisgICAg
ICAgICAgICB9DQorICAgICAgICB9DQorICAgIH0NCisNCisgICAgcmV0dXJuIDA7DQorfQ0KKw0K
K3N0YXRpYyBpbmxpbmUgYm9vbCB2dGRfYWRkcl9pbl9pbnRlcnJ1cF9yYW5nZShod2FkZHIgYWRk
ciwgdWludDY0X3Qgc2l6ZSkNCit7DQorICAgIHJldHVybiAhKChhZGRyID4gVlREX0lOVEVSUlVQ
VF9BRERSX0xBU1QpIHx8DQorICAgICAgICAgICAgIChhZGRyICsgc2l6ZSAtIDEgPCBWVERfSU5U
RVJSVVBUX0FERFJfRklSU1QpKTsNCit9DQorDQorc3RhdGljIGludCB2dGRfaW92YV90b19wdGVf
ZmwoSW50ZWxJT01NVVN0YXRlICpzLCAgVlREQ29udGV4dEVudHJ5ICpjZSwNCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCBpb3ZhLCBib29sIGlzX3dyaXRlLCB1aW50NjRf
dCAqcHRlcCwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCAqcHRlX2xl
dmVsLCBib29sICpyZWFkcywgYm9vbCAqd3JpdGVzLA0KKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVpbnQ4X3QgYXdfYml0cywgdWludDMyX3QgcGFzaWQsIGRtYV9hZGRyX3QgYWRkcikN
Cit7DQorICAgIHVpbnQzMl90IG9mZnNldDsNCisgICAgdWludDY0X3QgcHRlOw0KKyAgICB1aW50
NjRfdCBhY2Nlc3NfcmlnaHRfY2hlY2sgPSBpc193cml0ZSA/IFZURF9GTF9XIDogMDsNCisgICAg
aW50IHJldDsNCisNCisgICAgaWYgKCF2dGRfaW92YV9mbF9jaGVja19jYW5vbmljYWwocywgaW92
YSwgY2UsIGF3X2JpdHMsIHBhc2lkKSkgew0KKyAgICAgICAgZXJyb3JfcmVwb3J0X29uY2UoIiVz
OiBkZXRlY3RlZCBub24gY2Fub25pY2FsIElPVkEgKGlvdmE9MHglIiBQUkl4NjQgIiwiDQorICAg
ICAgICAgICAgICAgICAgICAgICAgICAicGFzaWQ9MHglIiBQUkl4MzIgIikiLCBfX2Z1bmNfXywg
aW92YSwgcGFzaWQpOw0KKyAgICAgICAgcmV0dXJuIC1WVERfRlJfRlNfTk9OX0NBTk9OSUNBTDsN
CisgICAgfQ0KKw0KKyAgICB3aGlsZSAodHJ1ZSkgew0KKyAgICAgICAgb2Zmc2V0ID0gdnRkX2lv
dmFfbGV2ZWxfb2Zmc2V0KGlvdmEsICpwdGVfbGV2ZWwpOw0KKyAgICAgICAgcHRlID0gdnRkX2dl
dF9wdGUoYWRkciwgb2Zmc2V0KTsNCisNCisgICAgICAgIHJldCA9IHZ0ZF9pb3ZhX3RvX3B0ZV9j
aGVja19yZWFkX2Vycm9yKHMsIGNlLCBpb3ZhLCBwdGUsDQorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNpZCwgKnB0ZV9sZXZlbCwNCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZURF9TTV9QQVNJRF9FTlRSWV9G
TFQpOw0KKyAgICAgICAgaWYgKHJldCAhPSAwKSB7DQorICAgICAgICAgICAgcmV0dXJuIHJldDsN
CisgICAgICAgIH0NCisNCisgICAgICAgIGlmICghdnRkX2ZsX3B0ZV9wcmVzZW50KHB0ZSkpIHsN
CisgICAgICAgICAgICByZXR1cm4gLVZURF9GUl9GU1BFX05PVF9QUkVTRU5UOw0KKyAgICAgICAg
fQ0KKw0KKyAgICAgICAgKnJlYWRzID0gdHJ1ZTsNCisgICAgICAgICp3cml0ZXMgPSAoKndyaXRl
cykgJiYgKHB0ZSAmIFZURF9GTF9XKTsNCisNCisgICAgICAgIGlmICh2dGRfc2V0X2ZsYWdfaW5f
cHRlKGFkZHIsIG9mZnNldCwgcHRlLCBWVERfRkxfUFRFX0EpICE9IE1FTVRYX09LKSB7DQorICAg
ICAgICAgICAgcmV0dXJuIC1WVERfRlJfRlNfQklUX1VQREFURV9GQUlMRUQ7DQorICAgICAgICB9
DQorDQorICAgICAgICBpZiAoKHB0ZSAmIGFjY2Vzc19yaWdodF9jaGVjaykgIT0gYWNjZXNzX3Jp
Z2h0X2NoZWNrKSB7DQorICAgICAgICAgICAgZXJyb3JfcmVwb3J0X29uY2UoIiVzOiBkZXRlY3Rl
ZCBwdGUgcGVybWlzc2lvbiBlcnJvciAiDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Iihpb3ZhPTB4JSIgUFJJeDY0ICIsIGxldmVsPTB4JSIgUFJJeDMyICIsICINCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAicHRlPTB4JSIgUFJJeDY0ICIsIHdyaXRlPSVkLCBwYXNpZD0w
eCUiDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJeDMyICIpIiwgX19mdW5jX18s
IGlvdmEsICpwdGVfbGV2ZWwsDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHRlLCBp
c193cml0ZSwgcGFzaWQpOw0KKyAgICAgICAgICAgIHJldHVybiBpc193cml0ZSA/IC1WVERfRlJf
U01fV1JJVEUgOiAtVlREX0ZSX1NNX1JFQUQ7DQorICAgICAgICB9DQorICAgICAgICBpZiAodnRk
X2ZscHRlX25vbnplcm9fcnN2ZChwdGUsICpwdGVfbGV2ZWwpKSB7DQorICAgICAgICAgICAgZXJy
b3JfcmVwb3J0X29uY2UoIiVzOiBkZXRlY3RlZCBmbHB0ZSByZXNlcnZlZCBub24temVybyAiDQor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImlvdmE9MHglIiBQUkl4NjQgIiwgbGV2ZWw9
MHglIiBQUkl4MzINCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicHRlPTB4JSIgUFJJ
eDY0ICIsIHBhc2lkPTB4JSIgUFJJWDMyICIpIiwNCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBfX2Z1bmNfXywgaW92YSwgKnB0ZV9sZXZlbCwgcHRlLCBwYXNpZCk7DQorICAgICAgICAg
ICAgcmV0dXJuIC1WVERfRlJfUEFHSU5HX0VOVFJZX1JTVkQ7DQorICAgICAgICB9DQorDQorICAg
ICAgICBpZiAodnRkX2lzX2xhc3RfcHRlKHB0ZSwgKnB0ZV9sZXZlbCkpIHsNCisgICAgICAgICAg
ICAqcHRlcCA9IHB0ZTsNCisgICAgICAgICAgICBicmVhazsNCisgICAgICAgIH0NCisgICAgICAg
IGFkZHIgPSB2dGRfZ2V0X3B0ZV9hZGRyKHB0ZSwgYXdfYml0cyk7DQorICAgICAgICAoKnB0ZV9s
ZXZlbCktLTsNCisgICAgfQ0KKw0KKyAgICBpZiAoaXNfd3JpdGUgJiYNCisgICAgICAgICh2dGRf
c2V0X2ZsYWdfaW5fcHRlKGFkZHIsIG9mZnNldCwgcHRlLCBWVERfRkxfUFRFX0QpICE9IE1FTVRY
X09LKSkgew0KKyAgICAgICAgICAgIHJldHVybiAtVlREX0ZSX0ZTX0JJVF9VUERBVEVfRkFJTEVE
Ow0KKyAgICB9DQorDQorICAgIHJldHVybiAwOw0KK30NCisNCitzdGF0aWMgaW50IHZ0ZF9pb3Zh
X3RvX3B0ZV9zbChJbnRlbElPTU1VU3RhdGUgKnMsICBWVERDb250ZXh0RW50cnkgKmNlLA0KKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ2NF90IGlvdmEsIGJvb2wgaXNfd3JpdGUs
IHVpbnQ2NF90ICpzbHB0ZXAsDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMy
X3QgKnB0ZV9sZXZlbCwgYm9vbCAqcmVhZHMsIGJvb2wgKndyaXRlcywNCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1aW50OF90IGF3X2JpdHMsIHVpbnQzMl90IHBhc2lkLCBkbWFfYWRk
cl90IGFkZHIpDQogew0KLSAgICBkbWFfYWRkcl90IGFkZHIgPSB2dGRfZ2V0X2lvdmFfcGd0Ymxf
YmFzZShzLCBjZSwgcGFzaWQpOw0KLSAgICB1aW50MzJfdCBsZXZlbCA9IHZ0ZF9nZXRfaW92YV9s
ZXZlbChzLCBjZSwgcGFzaWQpOw0KICAgICB1aW50MzJfdCBvZmZzZXQ7DQogICAgIHVpbnQ2NF90
IHNscHRlOw0KLSAgICB1aW50NjRfdCBhY2Nlc3NfcmlnaHRfY2hlY2s7DQotICAgIHVpbnQ2NF90
IHhsYXQsIHNpemU7DQorICAgIHVpbnQ2NF90IGFjY2Vzc19yaWdodF9jaGVjayA9IGlzX3dyaXRl
ID8gVlREX1NMX1cgOiBWVERfU0xfUjsNCisgICAgaW50IHJldDsNCiANCiAgICAgaWYgKCF2dGRf
aW92YV9zbF9yYW5nZV9jaGVjayhzLCBpb3ZhLCBjZSwgYXdfYml0cywgcGFzaWQpKSB7DQogICAg
ICAgICBlcnJvcl9yZXBvcnRfb25jZSgiJXM6IGRldGVjdGVkIElPVkEgb3ZlcmZsb3cgKGlvdmE9
MHglIiBQUkl4NjQgIiwiDQpAQCAtMTEwMSw3MiArMTI3NywxMjggQEAgc3RhdGljIGludCB2dGRf
aW92YV90b19zbHB0ZShJbnRlbElPTU1VU3RhdGUgKnMsIFZURENvbnRleHRFbnRyeSAqY2UsDQog
ICAgICAgICByZXR1cm4gLVZURF9GUl9BRERSX0JFWU9ORF9NR0FXOw0KICAgICB9DQogDQotICAg
IC8qIEZJWE1FOiB3aGF0IGlzIHRoZSBBdG9taWNzIHJlcXVlc3QgaGVyZT8gKi8NCi0gICAgYWNj
ZXNzX3JpZ2h0X2NoZWNrID0gaXNfd3JpdGUgPyBWVERfU0xfVyA6IFZURF9TTF9SOw0KLQ0KICAg
ICB3aGlsZSAodHJ1ZSkgew0KLSAgICAgICAgb2Zmc2V0ID0gdnRkX2lvdmFfbGV2ZWxfb2Zmc2V0
KGlvdmEsIGxldmVsKTsNCisgICAgICAgIG9mZnNldCA9IHZ0ZF9pb3ZhX2xldmVsX29mZnNldChp
b3ZhLCAqcHRlX2xldmVsKTsNCiAgICAgICAgIHNscHRlID0gdnRkX2dldF9wdGUoYWRkciwgb2Zm
c2V0KTsNCiANCi0gICAgICAgIGlmIChzbHB0ZSA9PSAodWludDY0X3QpLTEpIHsNCi0gICAgICAg
ICAgICBlcnJvcl9yZXBvcnRfb25jZSgiJXM6IGRldGVjdGVkIHJlYWQgZXJyb3Igb24gRE1BUiBz
bHB0ZSAiDQotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIihpb3ZhPTB4JSIgUFJJeDY0
ICIsIHBhc2lkPTB4JSIgUFJJeDMyICIpIiwNCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBfX2Z1bmNfXywgaW92YSwgcGFzaWQpOw0KLSAgICAgICAgICAgIGlmIChsZXZlbCA9PSB2dGRf
Z2V0X2lvdmFfbGV2ZWwocywgY2UsIHBhc2lkKSkgew0KLSAgICAgICAgICAgICAgICAvKiBJbnZh
bGlkIHByb2dyYW1taW5nIG9mIGNvbnRleHQtZW50cnkgKi8NCi0gICAgICAgICAgICAgICAgcmV0
dXJuIC1WVERfRlJfQ09OVEVYVF9FTlRSWV9JTlY7DQotICAgICAgICAgICAgfSBlbHNlIHsNCi0g
ICAgICAgICAgICAgICAgcmV0dXJuIC1WVERfRlJfUEFHSU5HX0VOVFJZX0lOVjsNCi0gICAgICAg
ICAgICB9DQorICAgICAgICByZXQgPSB2dGRfaW92YV90b19wdGVfY2hlY2tfcmVhZF9lcnJvcihz
LCBjZSwgaW92YSwgc2xwdGUsDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBwYXNpZCwgKnB0ZV9sZXZlbCwNCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFZURF9TTV9QQVNJRF9FTlRSWV9TTFQpOw0KKyAgICAgICAg
aWYgKHJldCAhPSAwKSB7DQorICAgICAgICAgICAgcmV0dXJuIHJldDsNCiAgICAgICAgIH0NCiAg
ICAgICAgICpyZWFkcyA9ICgqcmVhZHMpICYmIChzbHB0ZSAmIFZURF9TTF9SKTsNCiAgICAgICAg
ICp3cml0ZXMgPSAoKndyaXRlcykgJiYgKHNscHRlICYgVlREX1NMX1cpOw0KLSAgICAgICAgaWYg
KCEoc2xwdGUgJiBhY2Nlc3NfcmlnaHRfY2hlY2spKSB7DQorICAgICAgICBpZiAoKHNscHRlICYg
YWNjZXNzX3JpZ2h0X2NoZWNrKSAhPSBhY2Nlc3NfcmlnaHRfY2hlY2spIHsNCiAgICAgICAgICAg
ICBlcnJvcl9yZXBvcnRfb25jZSgiJXM6IGRldGVjdGVkIHNscHRlIHBlcm1pc3Npb24gZXJyb3Ig
Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIoaW92YT0weCUiIFBSSXg2NCAiLCBs
ZXZlbD0weCUiIFBSSXgzMiAiLCAiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNs
cHRlPTB4JSIgUFJJeDY0ICIsIHdyaXRlPSVkLCBwYXNpZD0weCUiDQotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgUFJJeDMyICIpIiwgX19mdW5jX18sIGlvdmEsIGxldmVsLA0KKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFBSSXgzMiAiKSIsIF9fZnVuY19fLCBpb3ZhLCAqcHRl
X2xldmVsLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNscHRlLCBpc193cml0ZSwg
cGFzaWQpOw0KLSAgICAgICAgICAgIHJldHVybiBpc193cml0ZSA/IC1WVERfRlJfV1JJVEUgOiAt
VlREX0ZSX1JFQUQ7DQorICAgICAgICAgICAgaWYgKHMtPnJvb3Rfc2NhbGFibGUpIHsNCisgICAg
ICAgICAgICAgICAgcmV0dXJuIGlzX3dyaXRlID8gLVZURF9GUl9TTV9XUklURSA6IC1WVERfRlJf
U01fUkVBRDsNCisgICAgICAgICAgICB9IGVsc2Ugew0KKyAgICAgICAgICAgICAgICByZXR1cm4g
aXNfd3JpdGUgPyAtVlREX0ZSX1dSSVRFIDogLVZURF9GUl9SRUFEOw0KKyAgICAgICAgICAgIH0N
CiAgICAgICAgIH0NCi0gICAgICAgIGlmICh2dGRfc2xwdGVfbm9uemVyb19yc3ZkKHNscHRlLCBs
ZXZlbCkpIHsNCisgICAgICAgIGlmICh2dGRfc2xwdGVfbm9uemVyb19yc3ZkKHNscHRlLCAqcHRl
X2xldmVsKSkgew0KICAgICAgICAgICAgIGVycm9yX3JlcG9ydF9vbmNlKCIlczogZGV0ZWN0ZWQg
c3BsdGUgcmVzZXJ2ZSBub24temVybyAiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ImlvdmE9MHglIiBQUkl4NjQgIiwgbGV2ZWw9MHglIiBQUkl4MzINCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAic2xwdGU9MHglIiBQUkl4NjQgIiwgcGFzaWQ9MHglIiBQUklYMzIgIiki
LA0KLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fZnVuY19fLCBpb3ZhLCBsZXZlbCwg
c2xwdGUsIHBhc2lkKTsNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2Z1bmNfXywg
aW92YSwgKnB0ZV9sZXZlbCwgc2xwdGUsIHBhc2lkKTsNCiAgICAgICAgICAgICByZXR1cm4gLVZU
RF9GUl9QQUdJTkdfRU5UUllfUlNWRDsNCiAgICAgICAgIH0NCiANCi0gICAgICAgIGlmICh2dGRf
aXNfbGFzdF9wdGUoc2xwdGUsIGxldmVsKSkgew0KKyAgICAgICAgaWYgKHZ0ZF9pc19sYXN0X3B0
ZShzbHB0ZSwgKnB0ZV9sZXZlbCkpIHsNCiAgICAgICAgICAgICAqc2xwdGVwID0gc2xwdGU7DQot
ICAgICAgICAgICAgKnNscHRlX2xldmVsID0gbGV2ZWw7DQogICAgICAgICAgICAgYnJlYWs7DQog
ICAgICAgICB9DQogICAgICAgICBhZGRyID0gdnRkX2dldF9wdGVfYWRkcihzbHB0ZSwgYXdfYml0
cyk7DQotICAgICAgICBsZXZlbC0tOw0KKyAgICAgICAgKCpwdGVfbGV2ZWwpLS07DQorICAgIH0N
CisNCisgICAgcmV0dXJuIDA7DQorfQ0KKw0KKy8qDQorICogR2l2ZW4gdGhlIEBpb3ZhLCBnZXQg
cmVsZXZhbnQgQHB0ZXAuIEBwdGVfbGV2ZWwgd2lsbCBiZSB0aGUgbGFzdCBsZXZlbA0KKyAqIG9m
IHRoZSB0cmFuc2xhdGlvbiwgY2FuIGJlIHVzZWQgZm9yIGRlY2lkaW5nIHRoZSBzaXplIG9mIGxh
cmdlIHBhZ2UuDQorICovDQorc3RhdGljIGludCB2dGRfaW92YV90b19wdGUoSW50ZWxJT01NVVN0
YXRlICpzLCBWVERDb250ZXh0RW50cnkgKmNlLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdWludDY0X3QgaW92YSwgYm9vbCBpc193cml0ZSwNCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVpbnQ2NF90ICpwdGVwLCB1aW50MzJfdCAqcHRlX2xldmVsLA0KKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgYm9vbCAqcmVhZHMsIGJvb2wgKndyaXRlcywgdWludDhfdCBhd19i
aXRzLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgcGFzaWQpDQorew0K
KyAgICBkbWFfYWRkcl90IGFkZHI7DQorICAgIHVpbnQxNl90IHBndHQ7DQorICAgIHVpbnQ2NF90
IHhsYXQsIHNpemU7DQorICAgIFZURFBBU0lERW50cnkgcGU7DQorICAgIGludCByZXQ7DQorDQor
ICAgIC8qIEZJWE1FOiB3aGF0IGlzIHRoZSBBdG9taWNzIHJlcXVlc3QgaW4gYWNjZXNzIHJpZ2h0
cz8gKi8NCisNCisgICAgaWYgKHMtPnJvb3Rfc2NhbGFibGUpIHsNCisgICAgICAgIHZ0ZF9jZV9n
ZXRfcmlkMnBhc2lkX2VudHJ5KHMsIGNlLCAmcGUsIHBhc2lkKTsNCisgICAgICAgIHBndHQgPSBW
VERfUEVfR0VUX1RZUEUoJnBlKTsNCisgICAgICAgICpwdGVfbGV2ZWwgPSBWVERfUEVfR0VUX0xF
VkVMKCZwZSk7DQorICAgICAgICBhZGRyID0gdnRkX3BlX2dldF9wZ3RibF9iYXNlKCZwZSk7DQor
ICAgICAgICBzd2l0Y2ggKHBndHQpIHsNCisgICAgICAgIGNhc2UgVlREX1NNX1BBU0lEX0VOVFJZ
X0ZMVDoNCisgICAgICAgICAgICBpZiAocy0+ZWNhcCAmIFZURF9FQ0FQX0ZMVFMpIHsNCisgICAg
ICAgICAgICAgICAgcmV0ID0gdnRkX2lvdmFfdG9fcHRlX2ZsKHMsIGNlLCBpb3ZhLCBpc193cml0
ZSwgcHRlcCwgcHRlX2xldmVsLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcmVhZHMsIHdyaXRlcywgYXdfYml0cywgcGFzaWQsIGFkZHIpOw0KKyAgICAgICAgICAg
IH0gZWxzZSB7DQorICAgICAgICAgICAgICAgIGVycm9yX3JlcG9ydF9vbmNlKCJGaXJzdC1zdGFn
ZSB0cmFuc2xhdGlvbiBub3Qgc3VwcG9ydGVkIDogJWQiLA0KKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBwZ3R0KTsNCisgICAgICAgICAgICAgICAgcmV0dXJuIC1WVERfRlJfSU5W
QUxJRF9QR1RUOw0KKyAgICAgICAgICAgIH0NCisgICAgICAgICAgICBicmVhazsNCisgICAgICAg
IGNhc2UgVlREX1NNX1BBU0lEX0VOVFJZX1NMVDoNCisgICAgICAgICAgICBpZiAocy0+ZWNhcCAm
IFZURF9FQ0FQX1NMVFMpIHsNCisgICAgICAgICAgICAgICAgcmV0ID0gdnRkX2lvdmFfdG9fcHRl
X3NsKHMsIGNlLCBpb3ZhLCBpc193cml0ZSwgcHRlcCwgcHRlX2xldmVsLA0KKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZHMsIHdyaXRlcywgYXdfYml0cywgcGFz
aWQsIGFkZHIpOw0KKyAgICAgICAgICAgIH0gZWxzZSB7DQorICAgICAgICAgICAgICAgIGVycm9y
X3JlcG9ydF9vbmNlKCJTZWNvbmQtc3RhZ2UgdHJhbnNsYXRpb24gbm90IHN1cHBvcnRlZCA6ICVk
IiwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGd0dCk7DQorICAgICAgICAg
ICAgICAgIHJldHVybiAtVlREX0ZSX0lOVkFMSURfUEdUVDsNCisgICAgICAgICAgICB9DQorICAg
ICAgICAgICAgYnJlYWs7DQorICAgICAgICBkZWZhdWx0Og0KKyAgICAgICAgICAgIGVycm9yX3Jl
cG9ydF9vbmNlKCJVbnN1cHBvcnRlZCBQR1RUIDogJWQiLCBwZ3R0KTsNCisgICAgICAgICAgICBy
ZXQgPSAtVlREX0ZSX0lOVkFMSURfUEdUVDsNCisgICAgICAgICAgICBicmVhazsNCisgICAgICAg
IH0NCisgICAgfSBlbHNlIHsNCisgICAgICAgICpwdGVfbGV2ZWwgPSB2dGRfY2VfZ2V0X2xldmVs
KGNlKTsNCisgICAgICAgIGFkZHIgPSB2dGRfY2VfZ2V0X3NscHRfYmFzZShjZSk7DQorICAgICAg
ICByZXQgPSB2dGRfaW92YV90b19wdGVfc2wocywgY2UsIGlvdmEsIGlzX3dyaXRlLCBwdGVwLCBw
dGVfbGV2ZWwsDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZHMsIHdyaXRl
cywgYXdfYml0cywgcGFzaWQsIGFkZHIpOw0KICAgICB9DQogDQotICAgIHhsYXQgPSB2dGRfZ2V0
X3B0ZV9hZGRyKCpzbHB0ZXAsIGF3X2JpdHMpOw0KLSAgICBzaXplID0gfnZ0ZF9wdF9sZXZlbF9w
YWdlX21hc2sobGV2ZWwpICsgMTsNCisgICAgaWYgKHJldCAhPSAwKSB7DQorICAgICAgICByZXR1
cm4gcmV0Ow0KKyAgICB9DQorDQorICAgIHhsYXQgPSB2dGRfZ2V0X3B0ZV9hZGRyKCpwdGVwLCBh
d19iaXRzKTsNCisgICAgc2l6ZSA9IH52dGRfcHRfbGV2ZWxfcGFnZV9tYXNrKCpwdGVfbGV2ZWwp
ICsgMTsNCiANCiAgICAgLyoNCiAgICAgICogRnJvbSBWVC1kIHNwZWMgMy4xNDogVW50cmFuc2xh
dGVkIHJlcXVlc3RzIGFuZCB0cmFuc2xhdGlvbg0KICAgICAgKiByZXF1ZXN0cyB0aGF0IHJlc3Vs
dCBpbiBhbiBhZGRyZXNzIGluIHRoZSBpbnRlcnJ1cHQgcmFuZ2Ugd2lsbCBiZQ0KICAgICAgKiBi
bG9ja2VkIHdpdGggY29uZGl0aW9uIGNvZGUgTEdOLjQgb3IgU0dOLjguDQogICAgICAqLw0KLSAg
ICBpZiAoKHhsYXQgPiBWVERfSU5URVJSVVBUX0FERFJfTEFTVCB8fA0KLSAgICAgICAgIHhsYXQg
KyBzaXplIC0gMSA8IFZURF9JTlRFUlJVUFRfQUREUl9GSVJTVCkpIHsNCisgICAgaWYgKCF2dGRf
YWRkcl9pbl9pbnRlcnJ1cF9yYW5nZSh4bGF0LCBzaXplKSkgew0KICAgICAgICAgcmV0dXJuIDA7
DQogICAgIH0gZWxzZSB7DQogICAgICAgICBlcnJvcl9yZXBvcnRfb25jZSgiJXM6IHhsYXQgYWRk
cmVzcyBpcyBpbiBpbnRlcnJ1cHQgcmFuZ2UgIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAg
Iihpb3ZhPTB4JSIgUFJJeDY0ICIsIGxldmVsPTB4JSIgUFJJeDMyICIsICINCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICJzbHB0ZT0weCUiIFBSSXg2NCAiLCB3cml0ZT0lZCwgIg0KKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgInB0ZT0weCUiIFBSSXg2NCAiLCB3cml0ZT0lZCwgIg0KICAg
ICAgICAgICAgICAgICAgICAgICAgICAgInhsYXQ9MHglIiBQUkl4NjQgIiwgc2l6ZT0weCUiIFBS
SXg2NCAiLCAiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAicGFzaWQ9MHglIiBQUkl4MzIg
IikiLA0KLSAgICAgICAgICAgICAgICAgICAgICAgICAgX19mdW5jX18sIGlvdmEsIGxldmVsLCBz
bHB0ZSwgaXNfd3JpdGUsDQorICAgICAgICAgICAgICAgICAgICAgICAgICBfX2Z1bmNfXywgaW92
YSwgKnB0ZV9sZXZlbCwgKnB0ZXAsIGlzX3dyaXRlLA0KICAgICAgICAgICAgICAgICAgICAgICAg
ICAgeGxhdCwgc2l6ZSwgcGFzaWQpOw0KLSAgICAgICAgcmV0dXJuIHMtPnNjYWxhYmxlX21vZGUg
PyAtVlREX0ZSX1NNX0lOVEVSUlVQVF9BRERSIDoNCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgLVZURF9GUl9JTlRFUlJVUFRfQUREUjsNCisgICAgICAgIHJldHVybiAtVlREX0lO
VEVSUlVQVF9SQU5HRV9FUlJPUihzKTsNCiAgICAgfQ0KIH0NCiANCkBAIC0xNzcyLDYgKzIwMDQs
MTYgQEAgc3RhdGljIGNvbnN0IGJvb2wgdnRkX3F1YWxpZmllZF9mYXVsdHNbXSA9IHsNCiAgICAg
W1ZURF9GUl9DT05URVhUX0VOVFJZX1RUXSA9IHRydWUsDQogICAgIFtWVERfRlJfUEFTSURfVEFC
TEVfSU5WXSA9IGZhbHNlLA0KICAgICBbVlREX0ZSX1NNX0lOVEVSUlVQVF9BRERSXSA9IHRydWUs
DQorICAgIFtWVERfRlJfSU5WQUxJRF9QR1RUXSA9IHRydWUsDQorICAgIFtWVERfRlJfRlNQRV9B
Q0NFU1NdID0gdHJ1ZSwNCisgICAgW1ZURF9GUl9GU1BFX05PVF9QUkVTRU5UXSA9IHRydWUsDQor
ICAgIFtWVERfRlJfRklSU1RfRlNQRV9BQ0NFU1NdID0gdHJ1ZSwNCisgICAgW1ZURF9GUl9TU1BF
X0FDQ0VTU10gPSB0cnVlLA0KKyAgICBbVlREX0ZSX0ZJUlNUX1NTUEVfQUNDRVNTXSA9IHRydWUs
DQorICAgIFtWVERfRlJfRlNfTk9OX0NBTk9OSUNBTF0gPSB0cnVlLA0KKyAgICBbVlREX0ZSX1NN
X1dSSVRFXSA9IHRydWUsDQorICAgIFtWVERfRlJfU01fUkVBRF0gPSB0cnVlLA0KKyAgICBbVlRE
X0ZSX0ZTX0JJVF9VUERBVEVfRkFJTEVEXSA9IHRydWUsDQogICAgIFtWVERfRlJfTUFYXSA9IGZh
bHNlLA0KIH07DQogDQpAQCAtMTg3MCw3ICsyMTEyLDggQEAgc3RhdGljIGJvb2wgdnRkX2RvX2lv
bW11X3RyYW5zbGF0ZShWVERBZGRyZXNzU3BhY2UgKnZ0ZF9hcywgUENJQnVzICpidXMsDQogICAg
IHVpbnQ4X3QgYnVzX251bSA9IHBjaV9idXNfbnVtKGJ1cyk7DQogICAgIFZURENvbnRleHRDYWNo
ZUVudHJ5ICpjY19lbnRyeTsNCiAgICAgdWludDY0X3QgcHRlLCBwYWdlX21hc2s7DQotICAgIHVp
bnQzMl90IGxldmVsLCBwYXNpZCA9IHZ0ZF9hcy0+cGFzaWQ7DQorICAgIHVpbnQzMl90IGxldmVs
ID0gVUlOVDMyX01BWDsNCisgICAgdWludDMyX3QgcGFzaWQgPSB2dGRfYXMtPnBhc2lkOw0KICAg
ICB1aW50MTZfdCBzb3VyY2VfaWQgPSBQQ0lfQlVJTERfQkRGKGJ1c19udW0sIGRldmZuKTsNCiAg
ICAgaW50IHJldF9mcjsNCiAgICAgYm9vbCBpc19mcGRfc2V0ID0gZmFsc2U7DQpAQCAtMTk4MSw3
ICsyMjI0LDcgQEAgc3RhdGljIGJvb2wgdnRkX2RvX2lvbW11X3RyYW5zbGF0ZShWVERBZGRyZXNz
U3BhY2UgKnZ0ZF9hcywgUENJQnVzICpidXMsDQogICAgICAgICB9DQogICAgIH0NCiANCi0gICAg
cmV0X2ZyID0gdnRkX2lvdmFfdG9fc2xwdGUocywgJmNlLCBhZGRyLCBpc193cml0ZSwgJnB0ZSwg
JmxldmVsLA0KKyAgICByZXRfZnIgPSB2dGRfaW92YV90b19wdGUocywgJmNlLCBhZGRyLCBpc193
cml0ZSwgJnB0ZSwgJmxldmVsLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmcmVh
ZHMsICZ3cml0ZXMsIHMtPmF3X2JpdHMsIHBhc2lkKTsNCiAgICAgaWYgKHJldF9mcikgew0KICAg
ICAgICAgdnRkX3JlcG9ydF9mYXVsdChzLCAtcmV0X2ZyLCBpc19mcGRfc2V0LCBzb3VyY2VfaWQs
DQpAQCAtMTk5MCw2ICsyMjMzLDcgQEAgc3RhdGljIGJvb2wgdnRkX2RvX2lvbW11X3RyYW5zbGF0
ZShWVERBZGRyZXNzU3BhY2UgKnZ0ZF9hcywgUENJQnVzICpidXMsDQogICAgIH0NCiANCiAgICAg
cGFnZV9tYXNrID0gdnRkX3B0X2xldmVsX3BhZ2VfbWFzayhsZXZlbCk7DQorICAgIC8qIEV4ZSBp
cyBhbHdheXMgc2V0IHRvIDAgaW4gdGhlIHNwZWMgKi8NCiAgICAgYWNjZXNzX2ZsYWdzID0gSU9N
TVVfQUNDRVNTX0ZMQUcocmVhZHMsIHdyaXRlcyk7DQogICAgIHZ0ZF91cGRhdGVfaW90bGIocywg
c291cmNlX2lkLCB2dGRfZ2V0X2RvbWFpbl9pZChzLCAmY2UsIHBhc2lkKSwNCiAgICAgICAgICAg
ICAgICAgICAgICBhZGRyLCBwdGUsIGFjY2Vzc19mbGFncywgbGV2ZWwsIHBhc2lkKTsNCkBAIC0y
MDA1LDcgKzIyNDksMTIgQEAgZXJyb3I6DQogICAgIHZ0ZF9pb21tdV91bmxvY2socyk7DQogICAg
IGVudHJ5LT5pb3ZhID0gMDsNCiAgICAgZW50cnktPnRyYW5zbGF0ZWRfYWRkciA9IDA7DQotICAg
IGVudHJ5LT5hZGRyX21hc2sgPSAwOw0KKyAgICAvKg0KKyAgICAgKiBTZXQgdGhlIG1hc2sgZm9y
IEFUUyAodGhlIHJhbmdlIG11c3QgYmUgcHJlc2VudCBldmVuIHdoZW4gdGhlDQorICAgICAqIHRy
YW5zbGF0aW9uIGZhaWxzIDogUENJZSByZXYgNSAxMC4yLjMuNSkNCisgICAgICovDQorICAgIGVu
dHJ5LT5hZGRyX21hc2sgPSAobGV2ZWwgIT0gVUlOVDMyX01BWCkgPw0KKyAgICAgICAgICAgICAg
ICAgICAgICAgICh+dnRkX3B0X2xldmVsX3BhZ2VfbWFzayhsZXZlbCkpIDogKH5WVERfUEFHRV9N
QVNLXzRLKTsNCiAgICAgZW50cnktPnBlcm0gPSBJT01NVV9OT05FOw0KICAgICByZXR1cm4gZmFs
c2U7DQogfQ0KQEAgLTMxODcsNiArMzQzNiw4IEBAIHN0YXRpYyBJT01NVVRMQkVudHJ5IHZ0ZF9p
b21tdV90cmFuc2xhdGUoSU9NTVVNZW1vcnlSZWdpb24gKmlvbW11LCBod2FkZHIgYWRkciwNCiAg
ICAgfTsNCiAgICAgYm9vbCBzdWNjZXNzOw0KIA0KKyAgICAvKiBJT01NVUFjY2Vzc0ZsYWdzIDog
SU9NTVVfRVhFQyBhbmQgSU9NTVVfUFJJViBub3Qgc3VwcG9ydGVkICovDQorDQogICAgIGlmIChs
aWtlbHkocy0+ZG1hcl9lbmFibGVkKSkgew0KICAgICAgICAgc3VjY2VzcyA9IHZ0ZF9kb19pb21t
dV90cmFuc2xhdGUodnRkX2FzLCB2dGRfYXMtPmJ1cywgdnRkX2FzLT5kZXZmbiwNCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHIsIGZsYWcgJiBJT01NVV9XTywg
JmlvdGxiKTsNCkBAIC0zOTg5LDYgKzQyNDAsMjEgQEAgc3RhdGljIHZvaWQgdnRkX2luaXQoSW50
ZWxJT01NVVN0YXRlICpzKQ0KICAgICB2dGRfc3B0ZV9yc3ZkX2xhcmdlWzNdID0gVlREX1NQVEVf
TFBBR0VfTDNfUlNWRF9NQVNLKHMtPmF3X2JpdHMsDQogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeDg2X2lvbW11LT5kdF9zdXBwb3J0ZWQp
Ow0KIA0KKyAgICAvKg0KKyAgICAgKiBSc3ZkIGZpZWxkIG1hc2tzIGZvciBmcHRlDQorICAgICAq
Lw0KKyAgICB2dGRfZnB0ZV9yc3ZkWzBdID0gfjBVTEw7DQorICAgIHZ0ZF9mcHRlX3JzdmRbMV0g
PSBWVERfRlBURV9QQUdFX0wxX1JTVkRfTUFTSyhzLT5hd19iaXRzKTsNCisgICAgdnRkX2ZwdGVf
cnN2ZFsyXSA9IFZURF9GUFRFX1BBR0VfTDJfUlNWRF9NQVNLKHMtPmF3X2JpdHMpOw0KKyAgICB2
dGRfZnB0ZV9yc3ZkWzNdID0gVlREX0ZQVEVfUEFHRV9MM19SU1ZEX01BU0socy0+YXdfYml0cyk7
DQorICAgIHZ0ZF9mcHRlX3JzdmRbNF0gPSBWVERfRlBURV9QQUdFX0w0X1JTVkRfTUFTSyhzLT5h
d19iaXRzKTsNCisNCisgICAgdnRkX2ZwdGVfcnN2ZF9sYXJnZVswXSA9IH4wVUxMOw0KKyAgICB2
dGRfZnB0ZV9yc3ZkX2xhcmdlWzFdID0gfjBVTEw7DQorICAgIHZ0ZF9mcHRlX3JzdmRfbGFyZ2Vb
Ml0gPSBWVERfRlBURV9QQUdFX0wyX0ZTMk1QX1JTVkRfTUFTSyhzLT5hd19iaXRzKTsNCisgICAg
dnRkX2ZwdGVfcnN2ZF9sYXJnZVszXSA9IFZURF9GUFRFX1BBR0VfTDNfRlMxR1BfUlNWRF9NQVNL
KHMtPmF3X2JpdHMpOw0KKyAgICB2dGRfZnB0ZV9yc3ZkX2xhcmdlWzRdID0gfjBVTEw7DQorDQog
ICAgIGlmIChzLT5zY2FsYWJsZV9tb2RlIHx8IHMtPnNub29wX2NvbnRyb2wpIHsNCiAgICAgICAg
IHZ0ZF9zcHRlX3JzdmRbMV0gJj0gflZURF9TUFRFX1NOUDsNCiAgICAgICAgIHZ0ZF9zcHRlX3Jz
dmRfbGFyZ2VbMl0gJj0gflZURF9TUFRFX1NOUDsNCmRpZmYgLS1naXQgYS9ody9pMzg2L2ludGVs
X2lvbW11X2ludGVybmFsLmggYi9ody9pMzg2L2ludGVsX2lvbW11X2ludGVybmFsLmgNCmluZGV4
IDhkMjdiMWMxNWIuLmVkNjE5Nzk5MzQgMTAwNjQ0DQotLS0gYS9ody9pMzg2L2ludGVsX2lvbW11
X2ludGVybmFsLmgNCisrKyBiL2h3L2kzODYvaW50ZWxfaW9tbXVfaW50ZXJuYWwuaA0KQEAgLTE5
NSw2ICsxOTUsNyBAQA0KICNkZWZpbmUgVlREX0VDQVBfUEFTSUQgICAgICAgICAgICAgICgxVUxM
IDw8IDQwKQ0KICNkZWZpbmUgVlREX0VDQVBfU01UUyAgICAgICAgICAgICAgICgxVUxMIDw8IDQz
KQ0KICNkZWZpbmUgVlREX0VDQVBfU0xUUyAgICAgICAgICAgICAgICgxVUxMIDw8IDQ2KQ0KKyNk
ZWZpbmUgVlREX0VDQVBfRkxUUyAgICAgICAgICAgICAgICgxVUxMIDw8IDQ3KQ0KIA0KIC8qIENB
UF9SRUcgKi8NCiAvKiAob2Zmc2V0ID4+IDQpIDw8IDI0ICovDQpAQCAtMjE1LDYgKzIxNiw3IEBA
DQogI2RlZmluZSBWVERfQ0FQX0NNICAgICAgICAgICAgICAgICAgKDFVTEwgPDwgNykNCiAjZGVm
aW5lIFZURF9QQVNJRF9JRF9TSElGVCAgICAgICAgICAyMA0KICNkZWZpbmUgVlREX1BBU0lEX0lE
X01BU0sgICAgICAgICAgICgoMVVMTCA8PCBWVERfUEFTSURfSURfU0hJRlQpIC0gMSkNCisjZGVm
aW5lIFZURF9DQVBfRlMxR1AgICAgICAgICAgICAgICAoMVVMTCA8PCA1NikNCiANCiAvKiBTdXBw
b3J0ZWQgQWRqdXN0ZWQgR3Vlc3QgQWRkcmVzcyBXaWR0aHMgKi8NCiAjZGVmaW5lIFZURF9DQVBf
U0FHQVdfU0hJRlQgICAgICAgICA4DQpAQCAtMjcwLDYgKzI3MiwxMCBAQA0KICNkZWZpbmUgVlRE
X0ZSQ0RfUFAodmFsKSAgICAgICAgKCgodmFsKSAmIDB4MVVMTCkgPDwgMzEpDQogI2RlZmluZSBW
VERfRlJDRF9JUl9JRFgodmFsKSAgICAoKCh2YWwpICYgMHhmZmZmVUxMKSA8PCA0OCkNCiANCisj
ZGVmaW5lIFZURF9JTlRFUlJVUFRfUkFOR0VfRVJST1IocykgKChzKS0+c2NhbGFibGVfbW9kZSA/
IFwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZURF9GUl9TTV9JTlRF
UlJVUFRfQUREUiA6IFwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZU
RF9GUl9JTlRFUlJVUFRfQUREUikNCisNCiAvKiBETUEgUmVtYXBwaW5nIEZhdWx0IENvbmRpdGlv
bnMgKi8NCiB0eXBlZGVmIGVudW0gVlRERmF1bHRSZWFzb24gew0KICAgICBWVERfRlJfUkVTRVJW
RUQgPSAwLCAgICAgICAgLyogUmVzZXJ2ZWQgZm9yIEFkdmFuY2VkIEZhdWx0IGxvZ2dpbmcgKi8N
CkBAIC0zMTIsOSArMzE4LDIxIEBAIHR5cGVkZWYgZW51bSBWVERGYXVsdFJlYXNvbiB7DQogICAg
IFZURF9GUl9JUl9TSURfRVJSID0gMHgyNiwgICAvKiBJbnZhbGlkIFNvdXJjZS1JRCAqLw0KIA0K
ICAgICBWVERfRlJfUEFTSURfVEFCTEVfSU5WID0gMHg1OCwgIC8qSW52YWxpZCBQQVNJRCB0YWJs
ZSBlbnRyeSAqLw0KKyAgICBWVERfRlJfSU5WQUxJRF9QR1RUID0gMHg1YiwgIC8qIFNQVC40LjIg
SW52YWxpZCBQR1RUICovDQorDQorICAgIFZURF9GUl9GU1BFX0FDQ0VTUyA9IDB4NzAsIC8qIFNG
Uy4xICovDQorICAgIFZURF9GUl9GU1BFX05PVF9QUkVTRU5UID0gMHg3MSwgLyogU0ZTLjIgOiBQ
cmVzZW50IChQKSBmaWVsZCBpcyAwLiovDQorICAgIFZURF9GUl9GSVJTVF9GU1BFX0FDQ0VTUyA9
IDB4NzMsIC8qIFNGUy40ICovDQorICAgIFZURF9GUl9TU1BFX0FDQ0VTUyA9IDB4NzgsIC8qIFNT
Uy4xICovDQorICAgIFZURF9GUl9GSVJTVF9TU1BFX0FDQ0VTUyA9IDB4N2IsIC8qIFNTUy40ICov
DQorICAgIFZURF9GUl9GU19OT05fQ0FOT05JQ0FMID0gMHg4MCwgLyogU05HLjEgOiBBZGRyZXNz
IGZvciBGUyBub3QgY2Fub25pY2FsLiovDQorDQorICAgIFZURF9GUl9TTV9XUklURSA9IDB4ODUs
IC8qIFNHTi42ICovDQorICAgIFZURF9GUl9TTV9SRUFEID0gMHg4NiwgLyogU0dOLjcgKi8NCiAN
CiAgICAgLyogT3V0cHV0IGFkZHJlc3MgaW4gdGhlIGludGVycnVwdCBhZGRyZXNzIHJhbmdlIGZv
ciBzY2FsYWJsZSBtb2RlICovDQotICAgIFZURF9GUl9TTV9JTlRFUlJVUFRfQUREUiA9IDB4ODcs
DQorICAgIFZURF9GUl9TTV9JTlRFUlJVUFRfQUREUiA9IDB4ODcsIC8qIFNHTi44ICovDQorICAg
IFZURF9GUl9GU19CSVRfVVBEQVRFX0ZBSUxFRCA9IDB4OTEsIC8qIFNGUy4xMCAqLw0KICAgICBW
VERfRlJfTUFYLCAgICAgICAgICAgICAgICAgLyogR3VhcmQgKi8NCiB9IFZUREZhdWx0UmVhc29u
Ow0KIA0KQEAgLTQzMSw2ICs0NDksMjMgQEAgdHlwZWRlZiB1bmlvbiBWVERJbnZEZXNjIFZURElu
dkRlc2M7DQogICAgICAgICAoMHgzZmZmZjgwMFVMTCB8IH4oVlREX0hBV19NQVNLKGF3KSB8IFZU
RF9TTF9JR05fQ09NIHwgVlREX1NMX1RNKSkgOiBcDQogICAgICAgICAoMHgzZmZmZjgwMFVMTCB8
IH4oVlREX0hBV19NQVNLKGF3KSB8IFZURF9TTF9JR05fQ09NKSkNCiANCisjZGVmaW5lIFZURF9G
U19VUFBFUl9JR05PUkVEIDB4ZmZmMDAwMDAwMDAwMDAwMFVMTA0KKyNkZWZpbmUgVlREX0ZQVEVf
UEFHRV9MMV9SU1ZEX01BU0soYXcpICh+KFZURF9IQVdfTUFTSyhhdykpICYgXA0KKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh+VlREX0ZTX1VQUEVSX0lHTk9SRUQpKQ0K
KyNkZWZpbmUgVlREX0ZQVEVfUEFHRV9MMl9SU1ZEX01BU0soYXcpICh+KFZURF9IQVdfTUFTSyhh
dykpICYgXA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh+VlREX0ZT
X1VQUEVSX0lHTk9SRUQpKQ0KKyNkZWZpbmUgVlREX0ZQVEVfUEFHRV9MM19SU1ZEX01BU0soYXcp
ICh+KFZURF9IQVdfTUFTSyhhdykpICYgXA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICh+VlREX0ZTX1VQUEVSX0lHTk9SRUQpKQ0KKyNkZWZpbmUgVlREX0ZQVEVfUEFH
RV9MM19GUzFHUF9SU1ZEX01BU0soYXcpICgoMHgzZmZmZTAwMFVMTCB8IFwNCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB+KFZURF9IQVdfTUFTSyhhdykp
KSBcDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYgKH5W
VERfRlNfVVBQRVJfSUdOT1JFRCkpDQorI2RlZmluZSBWVERfRlBURV9QQUdFX0wyX0ZTMk1QX1JT
VkRfTUFTSyhhdykgKCgweDFmZTAwMFVMTCB8IFwNCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB+KFZURF9IQVdfTUFTSyhhdykpKSBcDQorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYgKH5WVERfRlNfVVBQRVJfSUdO
T1JFRCkpDQorI2RlZmluZSBWVERfRlBURV9QQUdFX0w0X1JTVkRfTUFTSyhhdykgKCgweDgwVUxM
IHwgXA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfihWVERf
SEFXX01BU0soYXcpKSkgXA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAmICh+VlREX0ZTX1VQUEVSX0lHTk9SRUQpKQ0KKw0KIC8qIEluZm9ybWF0aW9uIGFib3V0IHBh
Z2Utc2VsZWN0aXZlIElPVExCIGludmFsaWRhdGUgKi8NCiBzdHJ1Y3QgVlRESU9UTEJQYWdlSW52
SW5mbyB7DQogICAgIHVpbnQxNl90IGRvbWFpbl9pZDsNCkBAIC01MTQsOSArNTQ5LDYgQEAgdHlw
ZWRlZiBzdHJ1Y3QgVlREUm9vdEVudHJ5IFZURFJvb3RFbnRyeTsNCiAjZGVmaW5lIFZURF9TTV9Q
QVNJRF9FTlRSWV9BVyAgICAgICAgICA3VUxMIC8qIEFkanVzdGVkIGd1ZXN0LWFkZHJlc3Mtd2lk
dGggKi8NCiAjZGVmaW5lIFZURF9TTV9QQVNJRF9FTlRSWV9ESUQodmFsKSAgICAoKHZhbCkgJiBW
VERfRE9NQUlOX0lEX01BU0spDQogDQotLyogU2Vjb25kIExldmVsIFBhZ2UgVHJhbnNsYXRpb24g
UG9pbnRlciovDQotI2RlZmluZSBWVERfU01fUEFTSURfRU5UUllfU0xQVFBUUiAgICAgKH4weGZm
ZlVMTCkNCi0NCiAvKiBQYWdpbmcgU3RydWN0dXJlIGNvbW1vbiAqLw0KICNkZWZpbmUgVlREX1NN
X1BBU0lEX0VOVFJZX1BUUFRSICAgICh+MHhmZmZVTEwpDQogI2RlZmluZSBWVERfUFRfUEFHRV9T
SVpFX01BU0sgICAgICAgKDFVTEwgPDwgNykNCkBAIC01MzIsNiArNTY0LDE0IEBAIHR5cGVkZWYg
c3RydWN0IFZURFJvb3RFbnRyeSBWVERSb290RW50cnk7DQogI2RlZmluZSBWVERfU0xfUERfTEVW
RUwgICAgICAgICAgICAgMg0KICNkZWZpbmUgVlREX1NMX1BUX0xFVkVMICAgICAgICAgICAgIDEN
CiANCisvKiBGaXJzdCBMZXZlbCBQYWdpbmcgU3RydWN0dXJlICovDQorI2RlZmluZSBWVERfRkxf
UERQX0xFVkVMICAgICAgICAgICAgMw0KKyNkZWZpbmUgVlREX0ZMX1BEX0xFVkVMICAgICAgICAg
ICAgIDINCisjZGVmaW5lIFZURF9GTF9QVEVfUCAgICAgICAgICAgICAgICAweDENCisjZGVmaW5l
IFZURF9GTF9QVEVfQSAgICAgICAgICAgICAgICAweDIwDQorI2RlZmluZSBWVERfRkxfUFRFX0Qg
ICAgICAgICAgICAgICAgMHg0MA0KKyNkZWZpbmUgVlREX0ZMX1BURV9FQSAgICAgICAgICAgICAg
IDB4NDAwDQorDQogLyogTWFza3MgZm9yIFNlY29uZCBMZXZlbCBQYWdpbmcgRW50cnkgKi8NCiAj
ZGVmaW5lIFZURF9TTF9SV19NQVNLICAgICAgICAgICAgICAzVUxMDQogI2RlZmluZSBWVERfU0xf
UiAgICAgICAgICAgICAgICAgICAgMVVMTA0KQEAgLTUzOSw0ICs1NzksNyBAQCB0eXBlZGVmIHN0
cnVjdCBWVERSb290RW50cnkgVlREUm9vdEVudHJ5Ow0KICNkZWZpbmUgVlREX1NMX0lHTl9DT00g
ICAgICAgICAgICAgIDB4YmZmMDAwMDAwMDAwMDAwMFVMTA0KICNkZWZpbmUgVlREX1NMX1RNICAg
ICAgICAgICAgICAgICAgICgxVUxMIDw8IDYyKQ0KIA0KKy8qIE1hc2tzIGZvciBGaXJzdCBMZXZl
bCBQYWdpbmcgRW50cnkgKi8NCisjZGVmaW5lIFZURF9GTF9XICAgICAgICAgICAgICAgICAgICAo
MVVMTCA8PCAxKQ0KKw0KICNlbmRpZg0KLS0gDQoyLjQ0LjANCg==

