Return-Path: <qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org>
X-Original-To: lists+qemu-devel@lfdr.de
Delivered-To: lists+qemu-devel@lfdr.de
Received: from lists.gnu.org (lists.gnu.org [209.51.188.17])
	by mail.lfdr.de (Postfix) with ESMTPS id 19A3A8B9D74
	for <lists+qemu-devel@lfdr.de>; Thu,  2 May 2024 17:32:11 +0200 (CEST)
Received: from localhost ([::1] helo=lists1p.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.90_1)
	(envelope-from <qemu-devel-bounces@nongnu.org>)
	id 1s2YNp-0003vs-Ul; Thu, 02 May 2024 11:30:07 -0400
Received: from eggs.gnu.org ([2001:470:142:3::10])
 by lists.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <clement.mathieu--drif@eviden.com>)
 id 1s2YNb-0003pf-S1
 for qemu-devel@nongnu.org; Thu, 02 May 2024 11:29:51 -0400
Received: from smarthost3.eviden.com ([80.78.11.84])
 by eggs.gnu.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.90_1) (envelope-from <clement.mathieu--drif@eviden.com>)
 id 1s2YNJ-0005zE-IP
 for qemu-devel@nongnu.org; Thu, 02 May 2024 11:29:51 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=eviden.com; i=@eviden.com; q=dns/txt; s=mail;
 t=1714663773; x=1746199773;
 h=from:to:cc:subject:date:message-id:references:
 in-reply-to:content-id:content-transfer-encoding: mime-version;
 bh=UM2oKYwJZ/PFCyVhG3rBpAgMLxmzRSRdT/0ePXifSdo=;
 b=RUSDFaGlBNv0InvFShfQBQa6Ag24FC1M1xDx8acoO3O5qa63bIgbCeZ/
 g/WmS7h+dHQ1dBhfeQgZNhoZnU+XbPbKvP5PVamfSAXV1IVYT6d2DWJQE
 rw9ajC6yrT2gkf8Bz6a+Yk79p5qQQFIga2H1th/saqgBQlNP8OCQJJeBt
 dsCksPfbPaaCII2zA+H827aDdYsNQffpTK2GQ43u03edh1JNQdSz6WzvM
 4THOm7iWicjqchVqHbMCfaPnWTY8WDVsPOfdpnKhpX+wDaDXadFQguvWj
 kaSp1B6sTJ1/4WfgnsTpm12jPbiNkyVJQRT+SOFQRhAYq7kAXf/prCPki A==;
X-IronPort-AV: E=Sophos;i="6.07,247,1708383600"; d="scan'208";a="11730624"
X-MGA-submission: =?us-ascii?q?MDGBOW60AbjKHZcGtBbmMTOWRYeEI/3NL1PpJ3?=
 =?us-ascii?q?4PK7CB9abmHUXHRdu935Byd/hdcDWzNaZr1O11USRCEhLEG7Lbzv4727?=
 =?us-ascii?q?h8y46dQC4QqWSZKB/nveJy4Wi8/ck+spUEcOAS3X7rpP68LpzNyXmcmp?=
 =?us-ascii?q?hltNm2ZFTI8PdLafUha3mrQQ=3D=3D?=
Received: from mail-am6eur05lp2105.outbound.protection.outlook.com (HELO
 EUR05-AM6-obe.outbound.protection.outlook.com) ([104.47.18.105])
 by smarthost3.eviden.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 02 May 2024 17:29:23 +0200
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=NLp1qHviByVLChC0B6PFHPdtJ47W7EtQbndNJ0qHHyVzmRZNNaXCEuGfwODcmFviplgis6uVOIJ7/CF5EefXLqT6pZrsTbbK+bbKh+Xdc8D/SmdLX6TdnjfRP0oZ6SAMwDmUTOxGN0tZOA76WpeJJMMSmKZ954+vJ+oCg6OvN++daRRtO10Alsuw2IHEHtzjJAl501JUWJwgfFpSs1qpNFBdHiNARAwBC0pFCiXaKBC76VOEikU/WIH53A8+6tWZfkad8QwdjCIV2v2eBUOAaO9r6vq+VrdH8tS0vIw+J5py/HneKn1yr+RyxJe5lHq721RG+fUhlmLtfAYDzWObQw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=UM2oKYwJZ/PFCyVhG3rBpAgMLxmzRSRdT/0ePXifSdo=;
 b=J3Gugyghl/1lQRj7vSI6G1YAKbfgbvEzm8F6pzUeEveZbW1r0beLq/DcXq0YsZKCPhXTIsQcMnohtZz8Vqjw1+rKDtw9P/tDrIZRalbFQCglSx+NXDJF8JSFdu+3l6k7TwV6Q+9Oj+FxRYMu3MoS5IVMHtHzOXd5xu+xTr4pggwli7B+yWS3avnmxfPGpba8G/mSyQnSpa6t8ZjTlhUirRUC6yZp5R9guSbt2sE1szjIMYDpwR8F3L0YqouJRNm+VBIbRZxb5tQWkEMwQvM4vjQolXSG6b5+UvMq0F49LdjRnndjy2X4YuvEkXkX3v/LC9D3u13lazCUSW30MiAyVg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=eviden.com; dmarc=pass action=none header.from=eviden.com;
 dkim=pass header.d=eviden.com; arc=none
Received: from AM8PR07MB7602.eurprd07.prod.outlook.com (2603:10a6:20b:24b::7)
 by AS8PR07MB7768.eurprd07.prod.outlook.com (2603:10a6:20b:351::13)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.7544.29; Thu, 2 May
 2024 15:29:21 +0000
Received: from AM8PR07MB7602.eurprd07.prod.outlook.com
 ([fe80::fbd7:ca71:b636:6f9d]) by AM8PR07MB7602.eurprd07.prod.outlook.com
 ([fe80::fbd7:ca71:b636:6f9d%4]) with mapi id 15.20.7519.035; Thu, 2 May 2024
 15:29:21 +0000
From: CLEMENT MATHIEU--DRIF <clement.mathieu--drif@eviden.com>
To: "qemu-devel@nongnu.org" <qemu-devel@nongnu.org>
CC: "jasowang@redhat.com" <jasowang@redhat.com>, "zhenzhong.duan@intel.com"
 <zhenzhong.duan@intel.com>, "kevin.tian@intel.com" <kevin.tian@intel.com>,
 "yi.l.liu@intel.com" <yi.l.liu@intel.com>, "joao.m.martins@oracle.com"
 <joao.m.martins@oracle.com>, "peterx@redhat.com" <peterx@redhat.com>, CLEMENT
 MATHIEU--DRIF <clement.mathieu--drif@eviden.com>
Subject: [PATCH ats_vtd v1 20/24] atc: generic ATC that can be used by PCIe
 devices that support SVM
Thread-Topic: [PATCH ats_vtd v1 20/24] atc: generic ATC that can be used by
 PCIe devices that support SVM
Thread-Index: AQHanKWByKvYDmYBd02klTL221t3Bg==
Date: Thu, 2 May 2024 15:29:21 +0000
Message-ID: <20240502152810.187492-21-clement.mathieu--drif@eviden.com>
References: <20240502152810.187492-1-clement.mathieu--drif@eviden.com>
In-Reply-To: <20240502152810.187492-1-clement.mathieu--drif@eviden.com>
Accept-Language: en-GB, fr-FR, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
authentication-results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=eviden.com;
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: AM8PR07MB7602:EE_|AS8PR07MB7768:EE_
x-ms-office365-filtering-correlation-id: ec7ed4a8-e661-4cd5-b22e-08dc6abca3cf
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0; ARA:13230031|1800799015|366007|376005|38070700009;
x-microsoft-antispam-message-info: =?utf-8?B?c0w3Rm1TZk9OUS9NV2UweWNHVzAxTmZTNXF0ZUhvTUNoeWYvT01zWC91cklO?=
 =?utf-8?B?TU54ZXowRi82NGxNOTNVUlNLZWZqS2dZTXpwVXV5Z1A4S09LMy9IUUxRRnp6?=
 =?utf-8?B?TkpjZm0xcHpvVVR2RFNwclJrSjY3anFHdW15K0tadlMwVFhsZm81bHNuNVZr?=
 =?utf-8?B?UFBJeUVHaitGN0dHSXNqUFZqa2JOSjdrSWlrN1hzaTJ1RjdKVTBpMHk1MUlz?=
 =?utf-8?B?UWJOY05aamx0QURKTFdUK1o1NjZ3RDlMZFJyczhBVzZaMkVWRGQyeHJ0b0l2?=
 =?utf-8?B?VDQ1YVVRSDBPeitlNVlFV3pybDZOeU0zU2hRc0NoNzJPU0llQzU2aXdFZEJO?=
 =?utf-8?B?dnlJMWxTVWtXYTBURGowSDFwY0dYNTcyTlFaOGtmY2l0NW1xbjBMOFFiWm1y?=
 =?utf-8?B?RWlSTUY3dW14cXEzQzRMWlBTWWdDdW96bnNQdmFJNytxR3k1TDZnMFR0VDVx?=
 =?utf-8?B?Vml6dUgxRjc0elpnL2hNVTZHSGEzWWx0QW5yNzJTWjFaMkdTd213WHBCSHk3?=
 =?utf-8?B?WFhpZGJ5Tjd4clNWck1mclZYZ296RWRTWWtQS0VwZXN3ZEJtbEpMQXBmaHFa?=
 =?utf-8?B?d0UybDNEdGhvWUErdlliSTlJWXQxc0QwTTc5YUpZVnZadkdSWk9lZ2FhZUJE?=
 =?utf-8?B?dHVWbjVoSzVTdVBwQmhUcGFQWVVqbUpaS2FCY25CMlFFSFRZdEZwL0hJcnRP?=
 =?utf-8?B?dEdBTlpGR3pSOXRNdHcyTUpmbVVzR3REdDdoUEhQVUp2Mk4xcGdTV1NpUXg1?=
 =?utf-8?B?bzZST1NCTkJ1eDZJMDhJQnpoSUhIRStQMVFocmdyMEVjamFiYndiS3BqV1hT?=
 =?utf-8?B?bDFNZXJTR0txOUN3ME8rR1JjZ08vVlBZQ1VmUm9LR0ZIWmVlUGk2VHlpcDFW?=
 =?utf-8?B?Mkx5NmlDK2RRYzNqbjd6UjJYYnpsajRXQUFENXV6Nkg5bU5wQTJBZ2tWVHBq?=
 =?utf-8?B?M0NnRXVsejlMd2R6cjB6d1FKKzJRTFZwd3pwREtWQzY3enVoK3VGb3lYU1d0?=
 =?utf-8?B?UjFEeXF0MW43WloxODI2QlJKcFJVd1BDTDhjUHVRZXNDZUlldElOS2lEQXNL?=
 =?utf-8?B?cHZnQVgyblJMaGdWOWJqRm9WNEZWcU0wZlhsV1NOaXk5OExwTnJCYWpyeGZX?=
 =?utf-8?B?MlN1SmVYNi9RQXNTaUVGT3hjY09jOUtaL0dGaTl1cXd3bGdVUkt0N1JKS09Q?=
 =?utf-8?B?SnVkYnJxdmR0UThIenVrUTd1ZWJyMjAzM1E2S1d0aUF2MDdVWWxJdS9TcGJF?=
 =?utf-8?B?V1RBSXlWQXpob3ZOeVV2QWFvdDUycXg5YmNHVXUzQlZ5ZS9xWWN4emlIOVM3?=
 =?utf-8?B?Zk9nSDhYYnFwVUR1a2lXd2EwcFpoT0d6TXJLaXFVSWlWdWFhT1VCSEZEZDJ2?=
 =?utf-8?B?WjNKUFFLUGVXWDYvM1kzckNiaU5uL3JadWdONlIzRzY0RnJLbzVWK1BQT1E0?=
 =?utf-8?B?c3dsRitjQ3Ruc3VMNTlIaXJEa1VoTERMenNIanRsK0hPbjE5L21zUVV3MXkz?=
 =?utf-8?B?cWdBNmx1amJJRVIyalVRWC9jczErOU5aU3F6ZzZTN3Z3TkQ0RmRmaDlVNTNH?=
 =?utf-8?B?OWp6cWlrRFdWYlhlUnUvV0J5Y1prS0swc2RkUmx2ZkMrR2J2TFRZYW9GYmZ0?=
 =?utf-8?B?bjdERllVSXJnZW43Vm9IRER0MHhuQ09RUURlamtDSnA4UnBSSVQrZkV0bXBI?=
 =?utf-8?B?bG96UUpEQzFwQ2ZWU3pKWU1TQThoVmRVVWluTXNHNUJnWWp4aFE2c2tRPT0=?=
x-forefront-antispam-report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:AM8PR07MB7602.eurprd07.prod.outlook.com; PTR:; CAT:NONE;
 SFS:(13230031)(1800799015)(366007)(376005)(38070700009); DIR:OUT; SFP:1101; 
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?a0Q2dzJ2S3M4Z3puVkVKUlorRUpMTGlEVXQ5TEJxWGIrNlM2UlczM3VhelNx?=
 =?utf-8?B?aldnVzBKSm94dTVIejJMN1dmYzdtd2svMG91dUlIVGJlZUd3V1VYUGJyMG5i?=
 =?utf-8?B?S2ZMRWd5eFl2WUU3Z0pCZ1duWUZJc3VBWG0zZ2NVM0lMYzRmenkzV09Jb3dy?=
 =?utf-8?B?T1E1d2hDMHVHVkZFczQ3bVdjc3dNNnpZWEFmSzN6ZXJjUmlQVmlmMkthSEw0?=
 =?utf-8?B?bEJaUGVxcFRyMFIvUWlRVTJxN3dtN2JCb0NnbmFaamJ2ajVGbU91K3lRcUlV?=
 =?utf-8?B?aFNRYm1aRmhlLzFDN2UyVFJ3Sng3NWk3dUFxZUgwMkd1blkwT3loRE11eUZs?=
 =?utf-8?B?MzlCdWhWMkdLVnR1ZzM5S0hhMmllRmJZUHB1Z3h4ejQ2bEpXazM3RVJLSnV5?=
 =?utf-8?B?dCsveTNTR2ZCajJoYmtxOWdBSXR4SFRaMEVTQmpBTWRQbzZqblVsM2svQzNq?=
 =?utf-8?B?dE9lRmtXd3F6dUd0WThld0JJUG8yS2NQd3pFU2hsNGNHRG1kYXBMcTJXZ1Np?=
 =?utf-8?B?VUtIcFJETHI2aGl6dEtxKzFBSEt0L2QvSXRUbGkvdGpqSm5jS3V3bC8rUklI?=
 =?utf-8?B?T2xydVVDeHozajFCVHZ2OUZJSCsxUnJTSmt6ZmlLMVgwRUNLckdlK2JybEVJ?=
 =?utf-8?B?RFZNM1N5ejM4djYvdmhiSWRlRTd4dHJzeHF3RUxRNzhPVmo1Tnh3NC9jaHNJ?=
 =?utf-8?B?ZkFCcGxHMmxTc1lYNEVkWlBPWFV6ck9rUW5scnh4MFh1VnVJZVBhNUY1Zjlo?=
 =?utf-8?B?dEUwaEZldDBWVFdadXNKOVJaVFJhUnAzWURmcWUrT3h3Y2ZrbXJaKzlDajQr?=
 =?utf-8?B?Y21LZ3pjenArcXZpRG9QZnBCVVNNanM5aWpDWGE2dkpCVGFYQmdXNlFkZFFm?=
 =?utf-8?B?RU0zMzJnd1dPaTc1NDgrYnE3RjJ4RTJ6cVNFYUhXT1M0TWtxcVRTTnBXWTRF?=
 =?utf-8?B?Ry8rTHNnY2p2OUs3L0I0TGJHL1dDTzJWMGsrcVc0RndRbENzVzg0SmppaDRY?=
 =?utf-8?B?QXp0NHJmS2Z1TkdOTW4rS0FCWWJEZktXTHFGNUxaejgvVlkySU4yWFk4dVAx?=
 =?utf-8?B?bVNCbFREbGsvVVVldGdMalY1dkQ4enpoM3FUeDlkL24rbU5YSUplZnJUNDRR?=
 =?utf-8?B?MUY1OWRVZk9pc1NqUUp3SThRd3dSY2owKzFuWm9sUnFEcDUyMHZ6UTdUTDgr?=
 =?utf-8?B?eFlVd21jSWNBRzVCeHcwZmkyTU1DK2ExTXh3YlRsR0xPMmx3TG01Y0w1TWE0?=
 =?utf-8?B?K3B2SEUyc3FmOXl3MUtzTU1mdkN0ZVpJajFsaWhiVS9hdFFic0JxcC9oNERY?=
 =?utf-8?B?MHh4dnFOdUVZVitVaFhzS2Zza3g4MVR2YUlmL1A3SnFVQ010UWtLeUcva1kr?=
 =?utf-8?B?d1JiaTQxSEp2aW1STDRid1lDK0lNNlJNeDZlYy9TNWI4SDAra3Ywd3VKL3kx?=
 =?utf-8?B?T3d4Yk56bVduelU2VW5mWDhEVUVuY205VnVlZE1vV3RUSkxSUitoUkNiSXdE?=
 =?utf-8?B?SmtpeUk2SGJnK2Z3UlhFbXVFdXVvR003Zk50TnNqQTR6Qzk5dCtOUm1haG1q?=
 =?utf-8?B?YU1VTU9sZDNjY3VaN29SSDg4LysvK2J1MUNTdXJ2Y2tZYWJSMWllYjFGdzZy?=
 =?utf-8?B?M1c0UkcveWdwczNUMTB0RU1tcXhwd2dSL0wvZTVGUTBjeHJZZk5JWVV2ZTVr?=
 =?utf-8?B?U01EeEJicm9ZYkZGUVB5cEcydlN1Q2NDMXl6QjFNcC9kejZLcU9jTGFic2px?=
 =?utf-8?B?SjlkeFFZVGJvNk1yTTFGY3FCbG1MQ1BSemVVbW5HZExUd25BcVFjeitaVU9D?=
 =?utf-8?B?cUo0c0h2em9VTGxqcG5xdDZqTlFHSmR0R3ptVlNqU3Z1d0FhaFpEZDNJTzBD?=
 =?utf-8?B?SXdZM2pTemJDWWxMWnB0TkhHaTloU0sxK0VPNWJTd1NyOXlFMk1kMnJJa2Vx?=
 =?utf-8?B?elptRDJGNUxhQnE1ZDZ4YTc2QU5YU0puU3VYY1RBZGVDUDlRU1V2R0N1UEpV?=
 =?utf-8?B?Y2N3bjk5YWNwNGZZNFRCcVpSbGVHYUJLbWVHckl0NStlVVA2bjd0WUlld1Nl?=
 =?utf-8?B?RjA0SjU1WGlxeGxZMzZBRkI1Y2libzM5Y3BuTmZxaUNsRnhUV2s0TnFNTmQ1?=
 =?utf-8?B?YlBIdnN5VURvRDBTZ3RNclgwbkdaTUhTZ3V3ME8yMjJvTmV0WStldVlIeHp0?=
 =?utf-8?Q?I1YxjDwvop9csmCNQsRUBoM=3D?=
Content-Type: text/plain; charset="utf-8"
Content-ID: <E3674EE2909EC249B60399DE98B766E3@eurprd07.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: eviden.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: AM8PR07MB7602.eurprd07.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: ec7ed4a8-e661-4cd5-b22e-08dc6abca3cf
X-MS-Exchange-CrossTenant-originalarrivaltime: 02 May 2024 15:29:21.3993 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 7d1c7785-2d8a-437d-b842-1ed5d8fbe00a
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: ySGOcTrVyw7Zv02b7SYp00JHLrdKU707IdGw6y8ADa+S0lggbdVEMt58G4XM9K8K57XVlxrEVZYk9EsYM871xEiG5qCqdPkkWvjuxQtlUFI1hkBfCpSIC8ri1gsXFKgW
X-MS-Exchange-Transport-CrossTenantHeadersStamped: AS8PR07MB7768
Received-SPF: pass client-ip=80.78.11.84;
 envelope-from=clement.mathieu--drif@eviden.com; helo=smarthost3.eviden.com
X-Spam_score_int: -20
X-Spam_score: -2.1
X-Spam_bar: --
X-Spam_report: (-2.1 / 5.0 requ) BAYES_00=-1.9, DKIM_SIGNED=0.1,
 DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1, DKIM_VALID_EF=-0.1, SPF_HELO_PASS=-0.001,
 SPF_PASS=-0.001 autolearn=ham autolearn_force=no
X-Spam_action: no action
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <https://lists.nongnu.org/archive/html/qemu-devel>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
 <mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Errors-To: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org
Sender: qemu-devel-bounces+lists+qemu-devel=lfdr.de@nongnu.org

QXMgdGhlIFNWTS1jYXBhYmxlIGRldmljZXMgd2lsbCBuZWVkIHRvIGNhY2hlIHRyYW5zbGF0aW9u
cywgd2UgcHJvdmlkZQ0KYW4gZmlyc3QgaW1wbGVtZW50YXRpb24uDQoNClRoaXMgY2FjaGUgdXNl
cyBhIHR3by1sZXZlbCBkZXNpZ24gYmFzZWQgb24gaGFzaCB0YWJsZXMuDQpUaGUgZmlyc3QgbGV2
ZWwgaXMgaW5kZXhlZCBieSBhIFBBU0lEIGFuZCB0aGUgc2Vjb25kIGJ5IGEgdmlydHVhbCBhZGRy
ZXNzZS4NCg0KU2lnbmVkLW9mZi1ieTogQ2zDqW1lbnQgTWF0aGlldS0tRHJpZiA8Y2xlbWVudC5t
YXRoaWV1LS1kcmlmQGV2aWRlbi5jb20+DQotLS0NCiB0ZXN0cy91bml0L21lc29uLmJ1aWxkIHwg
ICAxICsNCiB0ZXN0cy91bml0L3Rlc3QtYXRjLmMgIHwgNTAyICsrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrDQogdXRpbC9hdGMuYyAgICAgICAgICAgICB8IDIxMSArKysr
KysrKysrKysrKysrKw0KIHV0aWwvYXRjLmggICAgICAgICAgICAgfCAxMTcgKysrKysrKysrKw0K
IHV0aWwvbWVzb24uYnVpbGQgICAgICAgfCAgIDEgKw0KIDUgZmlsZXMgY2hhbmdlZCwgODMyIGlu
c2VydGlvbnMoKykNCiBjcmVhdGUgbW9kZSAxMDA2NDQgdGVzdHMvdW5pdC90ZXN0LWF0Yy5jDQog
Y3JlYXRlIG1vZGUgMTAwNjQ0IHV0aWwvYXRjLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgdXRpbC9h
dGMuaA0KDQpkaWZmIC0tZ2l0IGEvdGVzdHMvdW5pdC9tZXNvbi5idWlsZCBiL3Rlc3RzL3VuaXQv
bWVzb24uYnVpbGQNCmluZGV4IDIyOGEyMWQwM2MuLjVjOWE2ZmU5ZjQgMTAwNjQ0DQotLS0gYS90
ZXN0cy91bml0L21lc29uLmJ1aWxkDQorKysgYi90ZXN0cy91bml0L21lc29uLmJ1aWxkDQpAQCAt
NTIsNiArNTIsNyBAQCB0ZXN0cyA9IHsNCiAgICd0ZXN0LWludGVydmFsLXRyZWUnOiBbXSwNCiAg
ICd0ZXN0LXhzLW5vZGUnOiBbcW9tXSwNCiAgICd0ZXN0LXZpcnRpby1kbWFidWYnOiBbbWVzb24u
cHJvamVjdF9zb3VyY2Vfcm9vdCgpIC8gJ2h3L2Rpc3BsYXkvdmlydGlvLWRtYWJ1Zi5jJ10sDQor
ICAndGVzdC1hdGMnOiBbXQ0KIH0NCiANCiBpZiBoYXZlX3N5c3RlbSBvciBoYXZlX3Rvb2xzDQpk
aWZmIC0tZ2l0IGEvdGVzdHMvdW5pdC90ZXN0LWF0Yy5jIGIvdGVzdHMvdW5pdC90ZXN0LWF0Yy5j
DQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMC4uNjBmYTYwOTI0YQ0KLS0t
IC9kZXYvbnVsbA0KKysrIGIvdGVzdHMvdW5pdC90ZXN0LWF0Yy5jDQpAQCAtMCwwICsxLDUwMiBA
QA0KKy8qDQorICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0
cmlidXRlIGl0IGFuZC9vciBtb2RpZnkNCisgKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdO
VSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQ0KKyAqIHRoZSBGcmVlIFNv
ZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yDQor
ICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4NCisNCisgKiBUaGlzIHByb2dy
YW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwNCisg
KiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJy
YW50eSBvZg0KKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIg
UFVSUE9TRS4gIFNlZSB0aGUNCisgKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9y
ZSBkZXRhaWxzLg0KKw0KKyAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhl
IEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFsb25nDQorICogd2l0aCB0aGlzIHByb2dyYW07
IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4NCisgKi8NCisNCisj
aW5jbHVkZSAidXRpbC9hdGMuaCINCisNCitzdGF0aWMgaW5saW5lIGJvb2wgdGxiX2VudHJ5X2Vx
dWFsKElPTU1VVExCRW50cnkgKmUxLCBJT01NVVRMQkVudHJ5ICplMikNCit7DQorICAgIGlmICgh
ZTEgfHwgIWUyKSB7DQorICAgICAgICByZXR1cm4gIWUxICYmICFlMjsNCisgICAgfQ0KKyAgICBy
ZXR1cm4gZTEtPmlvdmEgPT0gZTItPmlvdmEgJiYNCisgICAgICAgICAgICBlMS0+YWRkcl9tYXNr
ID09IGUyLT5hZGRyX21hc2sgJiYNCisgICAgICAgICAgICBlMS0+cGFzaWQgPT0gZTItPnBhc2lk
ICYmDQorICAgICAgICAgICAgZTEtPnBlcm0gPT0gZTItPnBlcm0gJiYNCisgICAgICAgICAgICBl
MS0+dGFyZ2V0X2FzID09IGUyLT50YXJnZXRfYXMgJiYNCisgICAgICAgICAgICBlMS0+dHJhbnNs
YXRlZF9hZGRyID09IGUyLT50cmFuc2xhdGVkX2FkZHI7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGFz
c2VydF9sb29rdXBfZXF1YWxzKEFUQyAqYXRjLCBJT01NVVRMQkVudHJ5ICp0YXJnZXQsDQorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgcGFzaWQsIGh3YWRkciBpb3Zh
KQ0KK3sNCisgICAgSU9NTVVUTEJFbnRyeSAqcmVzdWx0Ow0KKyAgICByZXN1bHQgPSBhdGNfbG9v
a3VwKGF0YywgcGFzaWQsIGlvdmEpOw0KKyAgICBnX2Fzc2VydCh0bGJfZW50cnlfZXF1YWwocmVz
dWx0LCB0YXJnZXQpKTsNCit9DQorDQorc3RhdGljIHZvaWQgY2hlY2tfY3JlYXRpb24odWludDY0
X3QgcGFnZV9zaXplLCB1aW50OF90IGFkZHJlc3Nfd2lkdGgsDQorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdWludDhfdCBsZXZlbHMsIHVpbnQ4X3QgbGV2ZWxfb2Zmc2V0LA0KKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGJvb2wgc2hvdWxkX3dvcmspIHsNCisgICAgQVRDICphdGMgPSBh
dGNfbmV3KHBhZ2Vfc2l6ZSwgYWRkcmVzc193aWR0aCk7DQorICAgIGlmIChhdGMpIHsNCisgICAg
ICAgIGlmIChhdGMtPmxldmVscyAhPSBsZXZlbHMgfHwgYXRjLT5sZXZlbF9vZmZzZXQgIT0gbGV2
ZWxfb2Zmc2V0KSB7DQorICAgICAgICAgICAgZ19hc3NlcnQoZmFsc2UpOyAvKiBBVEMgY3JlYXRl
ZCBidXQgaW52YWxpZCBjb25maWd1cmF0aW9uIDogZmFpbCAqLw0KKyAgICAgICAgfQ0KKyAgICAg
ICAgYXRjX2Rlc3Ryb3koYXRjKTsNCisgICAgICAgIGdfYXNzZXJ0KHNob3VsZF93b3JrKTsNCisg
ICAgfSBlbHNlIHsNCisgICAgICAgIGdfYXNzZXJ0KCFzaG91bGRfd29yayk7DQorICAgIH0NCit9
DQorDQorc3RhdGljIHZvaWQgdGVzdF9jcmVhdGlvbl9wYXJhbWV0ZXJzKHZvaWQpDQorew0KKyAg
ICBjaGVja19jcmVhdGlvbig4LCAzOSwgMywgOSwgZmFsc2UpOw0KKyAgICBjaGVja19jcmVhdGlv
big0MDk1LCAzOSwgMywgOSwgZmFsc2UpOw0KKyAgICBjaGVja19jcmVhdGlvbig0MDk3LCAzOSwg
MywgOSwgZmFsc2UpOw0KKyAgICBjaGVja19jcmVhdGlvbig4MTkyLCA0OCwgMCwgMCwgZmFsc2Up
Ow0KKw0KKyAgICBjaGVja19jcmVhdGlvbig0MDk2LCAzOCwgMCwgMCwgZmFsc2UpOw0KKyAgICBj
aGVja19jcmVhdGlvbig0MDk2LCAzOSwgMywgOSwgdHJ1ZSk7DQorICAgIGNoZWNrX2NyZWF0aW9u
KDQwOTYsIDQwLCAwLCAwLCBmYWxzZSk7DQorICAgIGNoZWNrX2NyZWF0aW9uKDQwOTYsIDQ3LCAw
LCAwLCBmYWxzZSk7DQorICAgIGNoZWNrX2NyZWF0aW9uKDQwOTYsIDQ4LCA0LCA5LCB0cnVlKTsN
CisgICAgY2hlY2tfY3JlYXRpb24oNDA5NiwgNDksIDAsIDAsIGZhbHNlKTsNCisgICAgY2hlY2tf
Y3JlYXRpb24oNDA5NiwgNTYsIDAsIDAsIGZhbHNlKTsNCisgICAgY2hlY2tfY3JlYXRpb24oNDA5
NiwgNTcsIDUsIDksIHRydWUpOw0KKyAgICBjaGVja19jcmVhdGlvbig0MDk2LCA1OCwgMCwgMCwg
ZmFsc2UpOw0KKw0KKyAgICBjaGVja19jcmVhdGlvbigxNjM4NCwgMzUsIDAsIDAsIGZhbHNlKTsN
CisgICAgY2hlY2tfY3JlYXRpb24oMTYzODQsIDM2LCAyLCAxMSwgdHJ1ZSk7DQorICAgIGNoZWNr
X2NyZWF0aW9uKDE2Mzg0LCAzNywgMCwgMCwgZmFsc2UpOw0KKyAgICBjaGVja19jcmVhdGlvbigx
NjM4NCwgNDYsIDAsIDAsIGZhbHNlKTsNCisgICAgY2hlY2tfY3JlYXRpb24oMTYzODQsIDQ3LCAz
LCAxMSwgdHJ1ZSk7DQorICAgIGNoZWNrX2NyZWF0aW9uKDE2Mzg0LCA0OCwgMCwgMCwgZmFsc2Up
Ow0KKyAgICBjaGVja19jcmVhdGlvbigxNjM4NCwgNTcsIDAsIDAsIGZhbHNlKTsNCisgICAgY2hl
Y2tfY3JlYXRpb24oMTYzODQsIDU4LCA0LCAxMSwgdHJ1ZSk7DQorICAgIGNoZWNrX2NyZWF0aW9u
KDE2Mzg0LCA1OSwgMCwgMCwgZmFsc2UpOw0KK30NCisNCitzdGF0aWMgdm9pZCB0ZXN0X3Npbmds
ZV9lbnRyeSh2b2lkKQ0KK3sNCisgICAgSU9NTVVUTEJFbnRyeSBlbnRyeSA9IHsNCisgICAgICAg
IC5pb3ZhID0gMHgxMjM0NTY3ODkwMDBVTEwsDQorICAgICAgICAuYWRkcl9tYXNrID0gMHhmZmZV
TEwsDQorICAgICAgICAucGFzaWQgPSA1LA0KKyAgICAgICAgLnBlcm0gPSBJT01NVV9SVywNCisg
ICAgICAgIC50cmFuc2xhdGVkX2FkZHIgPSAweGRlYWRiZWVmVUxMLA0KKyAgICB9Ow0KKw0KKyAg
ICBBVEMgKmF0YyA9IGF0Y19uZXcoNDA5NiwgNDgpOw0KKyAgICBnX2Fzc2VydChhdGMpOw0KKw0K
KyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5VTEwsIGVudHJ5LnBhc2lkLA0KKyAgICAg
ICAgICAgICAgICAgICAgICAgICBlbnRyeS5pb3ZhICsgKGVudHJ5LmFkZHJfbWFzayAvIDIpKTsN
CisNCisgICAgYXRjX2NyZWF0ZV9hZGRyZXNzX3NwYWNlX2NhY2hlKGF0YywgZW50cnkucGFzaWQp
Ow0KKyAgICBnX2Fzc2VydChhdGNfdXBkYXRlKGF0YywgJmVudHJ5KSA9PSAwKTsNCisNCisgICAg
YXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCBOVUxMLCBlbnRyeS5wYXNpZCArIDEsDQorICAgICAg
ICAgICAgICAgICAgICAgICAgIGVudHJ5LmlvdmEgKyAoZW50cnkuYWRkcl9tYXNrIC8gMikpOw0K
KyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlbnRyeSwgZW50cnkucGFzaWQsDQorICAg
ICAgICAgICAgICAgICAgICAgICAgIGVudHJ5LmlvdmEgKyAoZW50cnkuYWRkcl9tYXNrIC8gMikp
Ow0KKw0KKyAgICBhdGNfZGVzdHJveShhdGMpOw0KK30NCisNCitzdGF0aWMgdm9pZCB0ZXN0X3Bh
Z2VfYm91bmRhcmllcyh2b2lkKQ0KK3sNCisgICAgc3RhdGljIGNvbnN0IHVpbnQzMl90IHBhc2lk
ID0gNTsNCisgICAgc3RhdGljIGNvbnN0IGh3YWRkciBwYWdlX3NpemUgPSA0MDk2Ow0KKw0KKyAg
ICAvKiAyIGNvbnNlY3V0aXZlIGVudHJpZXMgKi8NCisgICAgSU9NTVVUTEJFbnRyeSBlMSA9IHsN
CisgICAgICAgIC5pb3ZhID0gMHgxMjM0NTY3ODkwMDBVTEwsDQorICAgICAgICAuYWRkcl9tYXNr
ID0gcGFnZV9zaXplIC0gMSwNCisgICAgICAgIC5wYXNpZCA9IHBhc2lkLA0KKyAgICAgICAgLnBl
cm0gPSBJT01NVV9SVywNCisgICAgICAgIC50cmFuc2xhdGVkX2FkZHIgPSAweGRlYWRiZWVmVUxM
LA0KKyAgICB9Ow0KKyAgICBJT01NVVRMQkVudHJ5IGUyID0gew0KKyAgICAgICAgLmlvdmEgPSBl
MS5pb3ZhICsgcGFnZV9zaXplLA0KKyAgICAgICAgLmFkZHJfbWFzayA9IHBhZ2Vfc2l6ZSAtIDEs
DQorICAgICAgICAucGFzaWQgPSBwYXNpZCwNCisgICAgICAgIC5wZXJtID0gSU9NTVVfUlcsDQor
ICAgICAgICAudHJhbnNsYXRlZF9hZGRyID0gMHg5MDBkZjAwZFVMTCwNCisgICAgfTsNCisNCisg
ICAgQVRDICphdGMgPSBhdGNfbmV3KHBhZ2Vfc2l6ZSwgNDgpOw0KKw0KKyAgICBhdGNfY3JlYXRl
X2FkZHJlc3Nfc3BhY2VfY2FjaGUoYXRjLCBlMS5wYXNpZCk7DQorICAgIC8qIGNyZWF0aW5nIHRo
ZSBhZGRyZXNzIHNwYWNlIHR3aWNlIHNob3VsZCBub3QgYmUgYSBwcm9ibGVtICovDQorICAgIGF0
Y19jcmVhdGVfYWRkcmVzc19zcGFjZV9jYWNoZShhdGMsIGUxLnBhc2lkKTsNCisNCisgICAgYXRj
X3VwZGF0ZShhdGMsICZlMSk7DQorICAgIGF0Y191cGRhdGUoYXRjLCAmZTIpOw0KKw0KKyAgICBh
c3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5VTEwsIGUxLnBhc2lkLCBlMS5pb3ZhIC0gMSk7DQor
ICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUxLCBlMS5wYXNpZCwgZTEuaW92YSk7DQor
ICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUxLCBlMS5wYXNpZCwgZTEuaW92YSArIGUx
LmFkZHJfbWFzayk7DQorICAgIGdfYXNzZXJ0KChlMS5pb3ZhICsgZTEuYWRkcl9tYXNrICsgMSkg
PT0gZTIuaW92YSk7DQorICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUyLCBlMi5wYXNp
ZCwgZTIuaW92YSk7DQorICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUyLCBlMi5wYXNp
ZCwgZTIuaW92YSArIGUyLmFkZHJfbWFzayk7DQorICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0
YywgTlVMTCwgZTIucGFzaWQsIGUyLmlvdmEgKyBlMi5hZGRyX21hc2sgKyAxKTsNCisNCisgICAg
YXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCBOVUxMLCBlMS5wYXNpZCArIDEwLCBlMS5pb3ZhKTsN
CisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCBOVUxMLCBlMi5wYXNpZCArIDEwLCBlMi5p
b3ZhKTsNCisgICAgYXRjX2Rlc3Ryb3koYXRjKTsNCit9DQorDQorc3RhdGljIHZvaWQgdGVzdF9o
dWdlX3BhZ2Uodm9pZCkNCit7DQorICAgIHN0YXRpYyBjb25zdCB1aW50MzJfdCBwYXNpZCA9IDU7
DQorICAgIHN0YXRpYyBjb25zdCBod2FkZHIgcGFnZV9zaXplID0gNDA5NjsNCisgICAgSU9NTVVU
TEJFbnRyeSBlMSA9IHsNCisgICAgICAgIC5pb3ZhID0gMHgxMjM0NTY2MDAwMDBVTEwsDQorICAg
ICAgICAuYWRkcl9tYXNrID0gMHgxZmZmZmZVTEwsDQorICAgICAgICAucGFzaWQgPSBwYXNpZCwN
CisgICAgICAgIC5wZXJtID0gSU9NTVVfUlcsDQorICAgICAgICAudHJhbnNsYXRlZF9hZGRyID0g
MHhkZWFkYmVlZlVMTCwNCisgICAgfTsNCisgICAgaHdhZGRyIGFkZHI7DQorDQorICAgIEFUQyAq
YXRjID0gYXRjX25ldyhwYWdlX3NpemUsIDQ4KTsNCisNCisgICAgYXRjX2NyZWF0ZV9hZGRyZXNz
X3NwYWNlX2NhY2hlKGF0YywgZTEucGFzaWQpOw0KKyAgICBhdGNfdXBkYXRlKGF0YywgJmUxKTsN
CisNCisgICAgZm9yIChhZGRyID0gZTEuaW92YTsgYWRkciA8PSBlMS5pb3ZhICsgZTEuYWRkcl9t
YXNrOyBhZGRyICs9IHBhZ2Vfc2l6ZSkgew0KKyAgICAgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMo
YXRjLCAmZTEsIGUxLnBhc2lkLCBhZGRyKTsNCisgICAgfQ0KKyAgICAvKiBhZGRyIGlzIG5vdyBv
dXQgb2YgdGhlIGh1Z2UgcGFnZSAqLw0KKyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5V
TEwsIGUxLnBhc2lkLCBhZGRyKTsNCisgICAgYXRjX2Rlc3Ryb3koYXRjKTsNCit9DQorDQorc3Rh
dGljIHZvaWQgdGVzdF9wYXNpZCh2b2lkKQ0KK3sNCisgICAgaHdhZGRyIGFkZHIgPSAweGFhYWFh
YWFhYTAwMFVMTDsNCisgICAgSU9NTVVUTEJFbnRyeSBlMSA9IHsNCisgICAgICAgIC5pb3ZhID0g
YWRkciwNCisgICAgICAgIC5hZGRyX21hc2sgPSAweGZmZlVMTCwNCisgICAgICAgIC5wYXNpZCA9
IDgsDQorICAgICAgICAucGVybSA9IElPTU1VX1JXLA0KKyAgICAgICAgLnRyYW5zbGF0ZWRfYWRk
ciA9IDB4ZGVhZGJlZWZVTEwsDQorICAgIH07DQorICAgIElPTU1VVExCRW50cnkgZTIgPSB7DQor
ICAgICAgICAuaW92YSA9IGFkZHIsDQorICAgICAgICAuYWRkcl9tYXNrID0gMHhmZmZVTEwsDQor
ICAgICAgICAucGFzaWQgPSAyLA0KKyAgICAgICAgLnBlcm0gPSBJT01NVV9SVywNCisgICAgICAg
IC50cmFuc2xhdGVkX2FkZHIgPSAweGIwMDFVTEwsDQorICAgIH07DQorICAgIHVpbnQxNl90IGk7
DQorDQorICAgIEFUQyAqYXRjID0gYXRjX25ldyg0MDk2LCA0OCk7DQorDQorICAgIGF0Y19jcmVh
dGVfYWRkcmVzc19zcGFjZV9jYWNoZShhdGMsIGUxLnBhc2lkKTsNCisgICAgYXRjX2NyZWF0ZV9h
ZGRyZXNzX3NwYWNlX2NhY2hlKGF0YywgZTIucGFzaWQpOw0KKyAgICBhdGNfdXBkYXRlKGF0Yywg
JmUxKTsNCisgICAgYXRjX3VwZGF0ZShhdGMsICZlMik7DQorDQorICAgIGZvciAoaSA9IDA7IGkg
PD0gTUFYKGUxLnBhc2lkLCBlMi5wYXNpZCkgKyAxOyArK2kpIHsNCisgICAgICAgIGlmIChpID09
IGUxLnBhc2lkIHx8IGkgPT0gZTIucGFzaWQpIHsNCisgICAgICAgICAgICBjb250aW51ZTsNCisg
ICAgICAgIH0NCisgICAgICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgTlVMTCwgaSwgYWRk
cik7DQorICAgIH0NCisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCAmZTEsIGUxLnBhc2lk
LCBhZGRyKTsNCisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCAmZTEsIGUxLnBhc2lkLCBh
ZGRyKTsNCisgICAgYXRjX2Rlc3Ryb3koYXRjKTsNCit9DQorDQorc3RhdGljIHZvaWQgdGVzdF9s
YXJnZV9hZGRyZXNzKHZvaWQpDQorew0KKyAgICBJT01NVVRMQkVudHJ5IGUxID0gew0KKyAgICAg
ICAgLmlvdmEgPSAweGFhYWFhYWFhYTAwMFVMTCwNCisgICAgICAgIC5hZGRyX21hc2sgPSAweGZm
ZlVMTCwNCisgICAgICAgIC5wYXNpZCA9IDgsDQorICAgICAgICAucGVybSA9IElPTU1VX1JXLA0K
KyAgICAgICAgLnRyYW5zbGF0ZWRfYWRkciA9IDB4NWVlZWVlZWRVTEwsDQorICAgIH07DQorICAg
IElPTU1VVExCRW50cnkgZTIgPSB7DQorICAgICAgICAuaW92YSA9IDB4MWYwMGJhYWFhYWJmMDAw
VUxMLA0KKyAgICAgICAgLmFkZHJfbWFzayA9IDB4ZmZmVUxMLA0KKyAgICAgICAgLnBhc2lkID0g
ZTEucGFzaWQsDQorICAgICAgICAucGVybSA9IElPTU1VX1JXLA0KKyAgICAgICAgLnRyYW5zbGF0
ZWRfYWRkciA9IDB4ZGVhZGJlZWZVTEwsDQorICAgIH07DQorDQorICAgIEFUQyAqYXRjID0gYXRj
X25ldyg0MDk2LCA1Nyk7DQorDQorICAgIGF0Y19jcmVhdGVfYWRkcmVzc19zcGFjZV9jYWNoZShh
dGMsIGUxLnBhc2lkKTsNCisgICAgYXRjX3VwZGF0ZShhdGMsICZlMSk7DQorICAgIGF0Y191cGRh
dGUoYXRjLCAmZTIpOw0KKw0KKyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMSwgZTEu
cGFzaWQsIGUxLmlvdmEpOw0KKyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMiwgZTIu
cGFzaWQsIGUyLmlvdmEpOw0KKyAgICBhdGNfZGVzdHJveShhdGMpOw0KK30NCisNCitzdGF0aWMg
dm9pZCB0ZXN0X2JpZ2dlcl9wYWdlKHZvaWQpDQorew0KKyAgICBJT01NVVRMQkVudHJ5IGUxID0g
ew0KKyAgICAgICAgLmlvdmEgPSAweGFhYmJjY2RkZTAwMFVMTCwNCisgICAgICAgIC5hZGRyX21h
c2sgPSAweDFmZmZVTEwsDQorICAgICAgICAucGFzaWQgPSAxLA0KKyAgICAgICAgLnBlcm0gPSBJ
T01NVV9SVywNCisgICAgICAgIC50cmFuc2xhdGVkX2FkZHIgPSAweDVlZWVlZWVkVUxMLA0KKyAg
ICB9Ow0KKyAgICBod2FkZHIgaTsNCisNCisgICAgQVRDICphdGMgPSBhdGNfbmV3KDgxOTIsIDQz
KTsNCisNCisgICAgYXRjX2NyZWF0ZV9hZGRyZXNzX3NwYWNlX2NhY2hlKGF0YywgZTEucGFzaWQp
Ow0KKyAgICBhdGNfdXBkYXRlKGF0YywgJmUxKTsNCisNCisgICAgaSA9IGUxLmlvdmEgJiAofmUx
LmFkZHJfbWFzayk7DQorICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgTlVMTCwgZTEucGFz
aWQsIGkgLSAxKTsNCisgICAgd2hpbGUgKGkgPD0gZTEuaW92YSArIGUxLmFkZHJfbWFzaykgew0K
KyAgICAgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCAmZTEsIGUxLnBhc2lkLCBpKTsNCisg
ICAgICAgICsraTsNCisgICAgfQ0KKyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5VTEws
IGUxLnBhc2lkLCBpKTsNCisgICAgYXRjX2Rlc3Ryb3koYXRjKTsNCit9DQorDQorc3RhdGljIHZv
aWQgdGVzdF91bmtub3duX3Bhc2lkKHZvaWQpDQorew0KKyAgICBJT01NVVRMQkVudHJ5IGUxID0g
ew0KKyAgICAgICAgLmlvdmEgPSAweGFhYmJjY2ZmZjAwMFVMTCwNCisgICAgICAgIC5hZGRyX21h
c2sgPSAweGZmZlVMTCwNCisgICAgICAgIC5wYXNpZCA9IDEsDQorICAgICAgICAucGVybSA9IElP
TU1VX1JXLA0KKyAgICAgICAgLnRyYW5zbGF0ZWRfYWRkciA9IDB4NWVlZWVlZWRVTEwsDQorICAg
IH07DQorDQorICAgIEFUQyAqYXRjID0gYXRjX25ldyg0MDk2LCA0OCk7DQorICAgIGdfYXNzZXJ0
KGF0Y191cGRhdGUoYXRjLCAmZTEpICE9IDApOw0KKyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhh
dGMsIE5VTEwsIGUxLnBhc2lkLCBlMS5pb3ZhKTsNCit9DQorDQorc3RhdGljIHZvaWQgdGVzdF9p
bnZhbGlkYXRpb24odm9pZCkNCit7DQorICAgIHN0YXRpYyB1aW50NjRfdCBwYWdlX3NpemUgPSA0
MDk2Ow0KKyAgICBJT01NVVRMQkVudHJ5IGUxID0gew0KKyAgICAgICAgLmlvdmEgPSAweGFhYmJj
Y2RkZjAwMFVMTCwNCisgICAgICAgIC5hZGRyX21hc2sgPSAweGZmZlVMTCwNCisgICAgICAgIC5w
YXNpZCA9IDEsDQorICAgICAgICAucGVybSA9IElPTU1VX1JXLA0KKyAgICAgICAgLnRyYW5zbGF0
ZWRfYWRkciA9IDB4NWVlZWVlZWRVTEwsDQorICAgIH07DQorICAgIElPTU1VVExCRW50cnkgZTIg
PSB7DQorICAgICAgICAuaW92YSA9IDB4ZmZlMDAwMDBVTEwsDQorICAgICAgICAuYWRkcl9tYXNr
ID0gMHgxZmZmZmZVTEwsDQorICAgICAgICAucGFzaWQgPSAxLA0KKyAgICAgICAgLnBlcm0gPSBJ
T01NVV9SVywNCisgICAgICAgIC50cmFuc2xhdGVkX2FkZHIgPSAweGIwMDAwMDFVTEwsDQorICAg
IH07DQorICAgIElPTU1VVExCRW50cnkgZTM7DQorDQorICAgIEFUQyAqYXRjID0gYXRjX25ldyhw
YWdlX3NpemUgLCA0OCk7DQorICAgIGF0Y19jcmVhdGVfYWRkcmVzc19zcGFjZV9jYWNoZShhdGMs
IGUxLnBhc2lkKTsNCisNCisgICAgYXRjX3VwZGF0ZShhdGMsICZlMSk7DQorICAgIGFzc2VydF9s
b29rdXBfZXF1YWxzKGF0YywgJmUxLCBlMS5wYXNpZCwgZTEuaW92YSk7DQorICAgIGF0Y19pbnZh
bGlkYXRlKGF0YywgJmUxKTsNCisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCBOVUxMLCBl
MS5wYXNpZCwgZTEuaW92YSk7DQorDQorICAgIGF0Y191cGRhdGUoYXRjLCAmZTEpOw0KKyAgICBh
dGNfdXBkYXRlKGF0YywgJmUyKTsNCisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCAmZTEs
IGUxLnBhc2lkLCBlMS5pb3ZhKTsNCisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCAmZTIs
IGUyLnBhc2lkLCBlMi5pb3ZhKTsNCisgICAgYXRjX2ludmFsaWRhdGUoYXRjLCAmZTIpOw0KKyAg
ICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMSwgZTEucGFzaWQsIGUxLmlvdmEpOw0KKyAg
ICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5VTEwsIGUyLnBhc2lkLCBlMi5pb3ZhKTsNCisN
CisgICAgLyogaW52YWxpZGF0ZSBhIGh1Z2UgcGFnZSBieSBpbnZhbGlkYXRpbmcgYSBzbWFsbCBy
ZWdpb24gKi8NCisgICAgZm9yIChod2FkZHIgYWRkciA9IGUyLmlvdmE7IGFkZHIgPD0gKGUyLmlv
dmEgKyBlMi5hZGRyX21hc2spOw0KKyAgICAgICAgIGFkZHIgKz0gcGFnZV9zaXplKSB7DQorICAg
ICAgICBhdGNfdXBkYXRlKGF0YywgJmUyKTsNCisgICAgICAgIGFzc2VydF9sb29rdXBfZXF1YWxz
KGF0YywgJmUyLCBlMi5wYXNpZCwgZTIuaW92YSk7DQorICAgICAgICBlMyA9IChJT01NVVRMQkVu
dHJ5KXsNCisgICAgICAgICAgICAuaW92YSA9IGFkZHIsDQorICAgICAgICAgICAgLmFkZHJfbWFz
ayA9IHBhZ2Vfc2l6ZSAtIDEsDQorICAgICAgICAgICAgLnBhc2lkID0gZTIucGFzaWQsDQorICAg
ICAgICAgICAgLnBlcm0gPSBJT01NVV9SVywNCisgICAgICAgICAgICAudHJhbnNsYXRlZF9hZGRy
ID0gMCwNCisgICAgICAgIH07DQorICAgICAgICBhdGNfaW52YWxpZGF0ZShhdGMsICZlMyk7DQor
ICAgICAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5VTEwsIGUyLnBhc2lkLCBlMi5pb3Zh
KTsNCisgICAgfQ0KK30NCisNCitzdGF0aWMgdm9pZCB0ZXN0X2RlbGV0ZV9hZGRyZXNzX3NwYWNl
X2NhY2hlKHZvaWQpDQorew0KKyAgICBzdGF0aWMgdWludDY0X3QgcGFnZV9zaXplID0gNDA5NjsN
CisgICAgSU9NTVVUTEJFbnRyeSBlMSA9IHsNCisgICAgICAgIC5pb3ZhID0gMHhhYWJiY2NkZGYw
MDBVTEwsDQorICAgICAgICAuYWRkcl9tYXNrID0gMHhmZmZVTEwsDQorICAgICAgICAucGFzaWQg
PSAxLA0KKyAgICAgICAgLnBlcm0gPSBJT01NVV9SVywNCisgICAgICAgIC50cmFuc2xhdGVkX2Fk
ZHIgPSAweDVlZWVlZWVkVUxMLA0KKyAgICB9Ow0KKyAgICBJT01NVVRMQkVudHJ5IGUyID0gew0K
KyAgICAgICAgLmlvdmEgPSBlMS5pb3ZhLA0KKyAgICAgICAgLmFkZHJfbWFzayA9IDB4ZmZmVUxM
LA0KKyAgICAgICAgLnBhc2lkID0gMiwNCisgICAgICAgIC5wZXJtID0gSU9NTVVfUlcsDQorICAg
ICAgICAudHJhbnNsYXRlZF9hZGRyID0gMHg1ZWVlZWVlZFVMTCwNCisgICAgfTsNCisNCisgICAg
QVRDICphdGMgPSBhdGNfbmV3KHBhZ2Vfc2l6ZSAsIDQ4KTsNCisgICAgYXRjX2NyZWF0ZV9hZGRy
ZXNzX3NwYWNlX2NhY2hlKGF0YywgZTEucGFzaWQpOw0KKw0KKyAgICBhdGNfdXBkYXRlKGF0Yywg
JmUxKTsNCisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCAmZTEsIGUxLnBhc2lkLCBlMS5p
b3ZhKTsNCisgICAgYXRjX2ludmFsaWRhdGUoYXRjLCAmZTIpOyAvKiB1bmtvd24gcGFzaWQgOiBp
cyBhIG5vcCovDQorICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUxLCBlMS5wYXNpZCwg
ZTEuaW92YSk7DQorDQorICAgIGF0Y19jcmVhdGVfYWRkcmVzc19zcGFjZV9jYWNoZShhdGMsIGUy
LnBhc2lkKTsNCisgICAgYXRjX3VwZGF0ZShhdGMsICZlMik7DQorICAgIGFzc2VydF9sb29rdXBf
ZXF1YWxzKGF0YywgJmUxLCBlMS5wYXNpZCwgZTEuaW92YSk7DQorICAgIGFzc2VydF9sb29rdXBf
ZXF1YWxzKGF0YywgJmUyLCBlMi5wYXNpZCwgZTIuaW92YSk7DQorICAgIGF0Y19pbnZhbGlkYXRl
KGF0YywgJmUxKTsNCisgICAgLyogZTEgaGFzIGJlZW4gcmVtb3ZlZCBidXQgZTIgaXMgc3RpbGwg
dGhlcmUgKi8NCisgICAgYXNzZXJ0X2xvb2t1cF9lcXVhbHMoYXRjLCBOVUxMLCBlMS5wYXNpZCwg
ZTEuaW92YSk7DQorICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUyLCBlMi5wYXNpZCwg
ZTIuaW92YSk7DQorDQorICAgIGF0Y191cGRhdGUoYXRjLCAmZTEpOw0KKyAgICBhc3NlcnRfbG9v
a3VwX2VxdWFscyhhdGMsICZlMSwgZTEucGFzaWQsIGUxLmlvdmEpOw0KKyAgICBhc3NlcnRfbG9v
a3VwX2VxdWFscyhhdGMsICZlMiwgZTIucGFzaWQsIGUyLmlvdmEpOw0KKw0KKyAgICBhdGNfZGVs
ZXRlX2FkZHJlc3Nfc3BhY2VfY2FjaGUoYXRjLCBlMi5wYXNpZCk7DQorICAgIGFzc2VydF9sb29r
dXBfZXF1YWxzKGF0YywgJmUxLCBlMS5wYXNpZCwgZTEuaW92YSk7DQorICAgIGFzc2VydF9sb29r
dXBfZXF1YWxzKGF0YywgTlVMTCwgZTIucGFzaWQsIGUyLmlvdmEpOw0KK30NCisNCitzdGF0aWMg
dm9pZCB0ZXN0X2ludmFsaWRhdGVfZW50aXJlX2FkZHJlc3Nfc3BhY2Uodm9pZCkNCit7DQorICAg
IHN0YXRpYyB1aW50NjRfdCBwYWdlX3NpemUgPSA0MDk2Ow0KKyAgICBJT01NVVRMQkVudHJ5IGUx
ID0gew0KKyAgICAgICAgLmlvdmEgPSAweDEwMDBVTEwsDQorICAgICAgICAuYWRkcl9tYXNrID0g
MHhmZmZVTEwsDQorICAgICAgICAucGFzaWQgPSAxLA0KKyAgICAgICAgLnBlcm0gPSBJT01NVV9S
VywNCisgICAgICAgIC50cmFuc2xhdGVkX2FkZHIgPSAweDVlZWRVTEwsDQorICAgIH07DQorICAg
IElPTU1VVExCRW50cnkgZTIgPSB7DQorICAgICAgICAuaW92YSA9IDB4ZmZmZmZmZmZmMDAwVUxM
LA0KKyAgICAgICAgLmFkZHJfbWFzayA9IDB4ZmZmVUxMLA0KKyAgICAgICAgLnBhc2lkID0gMSwN
CisgICAgICAgIC5wZXJtID0gSU9NTVVfUlcsDQorICAgICAgICAudHJhbnNsYXRlZF9hZGRyID0g
MHhiZWVmVUxMLA0KKyAgICB9Ow0KKyAgICBJT01NVVRMQkVudHJ5IGUzID0gew0KKyAgICAgICAg
LmlvdmEgPSAwLA0KKyAgICAgICAgLmFkZHJfbWFzayA9IDB4ZmZmZmZmZmZmZmZmZmZmZlVMTCwN
CisgICAgICAgIC5wYXNpZCA9IDEsDQorICAgICAgICAucGVybSA9IElPTU1VX1JXLA0KKyAgICAg
ICAgLnRyYW5zbGF0ZWRfYWRkciA9IDAsDQorICAgIH07DQorDQorICAgIEFUQyAqYXRjID0gYXRj
X25ldyhwYWdlX3NpemUgLCA0OCk7DQorICAgIGF0Y19jcmVhdGVfYWRkcmVzc19zcGFjZV9jYWNo
ZShhdGMsIGUxLnBhc2lkKTsNCisNCisgICAgYXRjX3VwZGF0ZShhdGMsICZlMSk7DQorICAgIGF0
Y191cGRhdGUoYXRjLCAmZTIpOw0KKyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMSwg
ZTEucGFzaWQsIGUxLmlvdmEpOw0KKyAgICBhc3NlcnRfbG9va3VwX2VxdWFscyhhdGMsICZlMiwg
ZTIucGFzaWQsIGUyLmlvdmEpOw0KKyAgICBhdGNfaW52YWxpZGF0ZShhdGMsICZlMyk7DQorICAg
IC8qIGUxIGhhcyBiZWVuIHJlbW92ZWQgYnV0IGUyIGlzIHN0aWxsIHRoZXJlICovDQorICAgIGFz
c2VydF9sb29rdXBfZXF1YWxzKGF0YywgTlVMTCwgZTEucGFzaWQsIGUxLmlvdmEpOw0KKyAgICBh
c3NlcnRfbG9va3VwX2VxdWFscyhhdGMsIE5VTEwsIGUyLnBhc2lkLCBlMi5pb3ZhKTsNCisNCisg
ICAgYXRjX2Rlc3Ryb3koYXRjKTsNCit9DQorDQorc3RhdGljIHZvaWQgdGVzdF9yZXNldCh2b2lk
KQ0KK3sNCisgICAgc3RhdGljIHVpbnQ2NF90IHBhZ2Vfc2l6ZSA9IDQwOTY7DQorICAgIElPTU1V
VExCRW50cnkgZTEgPSB7DQorICAgICAgICAuaW92YSA9IDB4MTAwMFVMTCwNCisgICAgICAgIC5h
ZGRyX21hc2sgPSAweGZmZlVMTCwNCisgICAgICAgIC5wYXNpZCA9IDEsDQorICAgICAgICAucGVy
bSA9IElPTU1VX1JXLA0KKyAgICAgICAgLnRyYW5zbGF0ZWRfYWRkciA9IDB4NWVlZFVMTCwNCisg
ICAgfTsNCisgICAgSU9NTVVUTEJFbnRyeSBlMiA9IHsNCisgICAgICAgIC5pb3ZhID0gMHhmZmZm
ZmZmZmYwMDBVTEwsDQorICAgICAgICAuYWRkcl9tYXNrID0gMHhmZmZVTEwsDQorICAgICAgICAu
cGFzaWQgPSAyLA0KKyAgICAgICAgLnBlcm0gPSBJT01NVV9SVywNCisgICAgICAgIC50cmFuc2xh
dGVkX2FkZHIgPSAweGJlZWZVTEwsDQorICAgIH07DQorDQorICAgIEFUQyAqYXRjID0gYXRjX25l
dyhwYWdlX3NpemUgLCA0OCk7DQorICAgIGF0Y19jcmVhdGVfYWRkcmVzc19zcGFjZV9jYWNoZShh
dGMsIGUxLnBhc2lkKTsNCisgICAgYXRjX2NyZWF0ZV9hZGRyZXNzX3NwYWNlX2NhY2hlKGF0Yywg
ZTIucGFzaWQpOw0KKyAgICBhdGNfdXBkYXRlKGF0YywgJmUxKTsNCisgICAgYXRjX3VwZGF0ZShh
dGMsICZlMik7DQorDQorICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUxLCBlMS5wYXNp
ZCwgZTEuaW92YSk7DQorICAgIGFzc2VydF9sb29rdXBfZXF1YWxzKGF0YywgJmUyLCBlMi5wYXNp
ZCwgZTIuaW92YSk7DQorDQorICAgIGF0Y19yZXNldChhdGMpOw0KKw0KKyAgICBhc3NlcnRfbG9v
a3VwX2VxdWFscyhhdGMsIE5VTEwsIGUxLnBhc2lkLCBlMS5pb3ZhKTsNCisgICAgYXNzZXJ0X2xv
b2t1cF9lcXVhbHMoYXRjLCBOVUxMLCBlMi5wYXNpZCwgZTIuaW92YSk7DQorfQ0KKw0KK3N0YXRp
YyB2b2lkIHRlc3RfZ2V0X21heF9udW1iZXJfb2ZfcGFnZXModm9pZCkNCit7DQorICAgIHN0YXRp
YyB1aW50NjRfdCBwYWdlX3NpemUgPSA0MDk2Ow0KKyAgICBod2FkZHIgYmFzZSA9IDB4YzBmZWUw
MDA7IC8qIGFsaWduZWQgKi8NCisgICAgQVRDICphdGMgPSBhdGNfbmV3KHBhZ2Vfc2l6ZSAsIDQ4
KTsNCisgICAgZ19hc3NlcnQoYXRjX2dldF9tYXhfbnVtYmVyX29mX3BhZ2VzKGF0YywgYmFzZSwg
cGFnZV9zaXplIC8gMikgPT0gMSk7DQorICAgIGdfYXNzZXJ0KGF0Y19nZXRfbWF4X251bWJlcl9v
Zl9wYWdlcyhhdGMsIGJhc2UsIHBhZ2Vfc2l6ZSkgPT0gMSk7DQorICAgIGdfYXNzZXJ0KGF0Y19n
ZXRfbWF4X251bWJlcl9vZl9wYWdlcyhhdGMsIGJhc2UsIHBhZ2Vfc2l6ZSArIDEpID09IDIpOw0K
Kw0KKyAgICBnX2Fzc2VydChhdGNfZ2V0X21heF9udW1iZXJfb2ZfcGFnZXMoYXRjLCBiYXNlICsg
MTAsIDEpID09IDEpOw0KKyAgICBnX2Fzc2VydChhdGNfZ2V0X21heF9udW1iZXJfb2ZfcGFnZXMo
YXRjLCBiYXNlICsgMTAsIHBhZ2Vfc2l6ZSAtIDEwKSA9PSAxKTsNCisgICAgZ19hc3NlcnQoYXRj
X2dldF9tYXhfbnVtYmVyX29mX3BhZ2VzKGF0YywgYmFzZSArIDEwLA0KKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZV9zaXplIC0gMTAgKyAxKSA9PSAyKTsNCisg
ICAgZ19hc3NlcnQoYXRjX2dldF9tYXhfbnVtYmVyX29mX3BhZ2VzKGF0YywgYmFzZSArIDEwLA0K
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZV9zaXplIC0gMTAg
KyAyKSA9PSAyKTsNCisNCisgICAgZ19hc3NlcnQoYXRjX2dldF9tYXhfbnVtYmVyX29mX3BhZ2Vz
KGF0YywgYmFzZSArIHBhZ2Vfc2l6ZSAtIDEsIDEpID09IDEpOw0KKyAgICBnX2Fzc2VydChhdGNf
Z2V0X21heF9udW1iZXJfb2ZfcGFnZXMoYXRjLCBiYXNlICsgcGFnZV9zaXplIC0gMSwgMikgPT0g
Mik7DQorICAgIGdfYXNzZXJ0KGF0Y19nZXRfbWF4X251bWJlcl9vZl9wYWdlcyhhdGMsIGJhc2Ug
KyBwYWdlX3NpemUgLSAxLCAzKSA9PSAyKTsNCisNCisgICAgZ19hc3NlcnQoYXRjX2dldF9tYXhf
bnVtYmVyX29mX3BhZ2VzKGF0YywgYmFzZSArIDEwLCBwYWdlX3NpemUgKiAyMCkgPT0gMjEpOw0K
KyAgICBnX2Fzc2VydChhdGNfZ2V0X21heF9udW1iZXJfb2ZfcGFnZXMoYXRjLCBiYXNlICsgMTAs
DQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocGFnZV9zaXplICog
MjApICsgKHBhZ2Vfc2l6ZSAtIDEwKSkNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICA9PSAyMSk7DQorICAgIGdfYXNzZXJ0KGF0Y19nZXRfbWF4X251bWJlcl9vZl9w
YWdlcyhhdGMsIGJhc2UgKyAxMCwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIChwYWdlX3NpemUgKiAyMCkgKw0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKHBhZ2Vfc2l6ZSAtIDEwICsgMSkpID09IDIyKTsNCit9DQorDQoraW50IG1h
aW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2KQ0KK3sNCisgICAgZ190ZXN0X2luaXQoJmFyZ2MsICZh
cmd2LCBOVUxMKTsNCisgICAgZ190ZXN0X2FkZF9mdW5jKCIvYXRjL3Rlc3RfY3JlYXRpb25fcGFy
YW1ldGVycyIsIHRlc3RfY3JlYXRpb25fcGFyYW1ldGVycyk7DQorICAgIGdfdGVzdF9hZGRfZnVu
YygiL2F0Yy90ZXN0X3NpbmdsZV9lbnRyeSIsIHRlc3Rfc2luZ2xlX2VudHJ5KTsNCisgICAgZ190
ZXN0X2FkZF9mdW5jKCIvYXRjL3Rlc3RfcGFnZV9ib3VuZGFyaWVzIiwgdGVzdF9wYWdlX2JvdW5k
YXJpZXMpOw0KKyAgICBnX3Rlc3RfYWRkX2Z1bmMoIi9hdGMvdGVzdF9odWdlX3BhZ2UiLCB0ZXN0
X2h1Z2VfcGFnZSk7DQorICAgIGdfdGVzdF9hZGRfZnVuYygiL2F0Yy90ZXN0X3Bhc2lkIiwgdGVz
dF9wYXNpZCk7DQorICAgIGdfdGVzdF9hZGRfZnVuYygiL2F0Yy90ZXN0X2xhcmdlX2FkZHJlc3Mi
LCB0ZXN0X2xhcmdlX2FkZHJlc3MpOw0KKyAgICBnX3Rlc3RfYWRkX2Z1bmMoIi9hdGMvdGVzdF9i
aWdnZXJfcGFnZSIsIHRlc3RfYmlnZ2VyX3BhZ2UpOw0KKyAgICBnX3Rlc3RfYWRkX2Z1bmMoIi9h
dGMvdGVzdF91bmtub3duX3Bhc2lkIiwgdGVzdF91bmtub3duX3Bhc2lkKTsNCisgICAgZ190ZXN0
X2FkZF9mdW5jKCIvYXRjL3Rlc3RfaW52YWxpZGF0aW9uIiwgdGVzdF9pbnZhbGlkYXRpb24pOw0K
KyAgICBnX3Rlc3RfYWRkX2Z1bmMoIi9hdGMvdGVzdF9kZWxldGVfYWRkcmVzc19zcGFjZV9jYWNo
ZSIsDQorICAgICAgICAgICAgICAgICAgICB0ZXN0X2RlbGV0ZV9hZGRyZXNzX3NwYWNlX2NhY2hl
KTsNCisgICAgZ190ZXN0X2FkZF9mdW5jKCIvYXRjL3Rlc3RfaW52YWxpZGF0ZV9lbnRpcmVfYWRk
cmVzc19zcGFjZSIsDQorICAgICAgICAgICAgICAgICAgICB0ZXN0X2ludmFsaWRhdGVfZW50aXJl
X2FkZHJlc3Nfc3BhY2UpOw0KKyAgICBnX3Rlc3RfYWRkX2Z1bmMoIi9hdGMvdGVzdF9yZXNldCIs
IHRlc3RfcmVzZXQpOw0KKyAgICBnX3Rlc3RfYWRkX2Z1bmMoIi9hdGMvdGVzdF9nZXRfbWF4X251
bWJlcl9vZl9wYWdlcyIsDQorICAgICAgICAgICAgICAgICAgICB0ZXN0X2dldF9tYXhfbnVtYmVy
X29mX3BhZ2VzKTsNCisgICAgcmV0dXJuIGdfdGVzdF9ydW4oKTsNCit9DQpkaWZmIC0tZ2l0IGEv
dXRpbC9hdGMuYyBiL3V0aWwvYXRjLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAw
MDAwMDAwLi4zMzMyZDdlMmI4DQotLS0gL2Rldi9udWxsDQorKysgYi91dGlsL2F0Yy5jDQpAQCAt
MCwwICsxLDIxMSBAQA0KKy8qDQorICogUUVNVSBlbXVsYXRpb24gb2YgYW4gQVRDDQorICoNCisg
KiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQg
YW5kL29yIG1vZGlmeQ0KKyAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwg
UHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5DQorICogdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3INCisgKiAoYXQgeW91
ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLg0KKw0KKyAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0
cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLA0KKyAqIGJ1dCBXSVRI
T1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mDQor
ICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAg
U2VlIHRoZQ0KKyAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMu
DQorDQorICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVy
YWwgUHVibGljIExpY2Vuc2UgYWxvbmcNCisgKiB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCBz
ZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+Lg0KKyAqLw0KKw0KKyNpbmNsdWRlICJ1
dGlsL2F0Yy5oIg0KKw0KKw0KKyNkZWZpbmUgUEFHRV9UQUJMRV9FTlRSWV9TSVpFIDgNCisNCisv
KiBhIHBhc2lkIGlzIGhhc2hlZCB1c2luZyB0aGUgaWRlbnRpdHkgZnVuY3Rpb24gKi8NCitzdGF0
aWMgZ3VpbnQgYXRjX3Bhc2lkX2tleV9oYXNoKGdjb25zdHBvaW50ZXIgdikNCit7DQorICAgIHJl
dHVybiAoZ3VpbnQpKHVpbnRwdHJfdCl2OyAvKiBwYXNpZCAqLw0KK30NCisNCisvKiBwYXNpZCBl
cXVhbGl0eSAqLw0KK3N0YXRpYyBnYm9vbGVhbiBhdGNfcGFzaWRfa2V5X2VxdWFsKGdjb25zdHBv
aW50ZXIgdjEsIGdjb25zdHBvaW50ZXIgdjIpDQorew0KKyAgICByZXR1cm4gdjEgPT0gdjI7DQor
fQ0KKw0KKy8qIEhhc2ggZnVuY3Rpb24gZm9yIElPVExCIGVudHJpZXMgKi8NCitzdGF0aWMgZ3Vp
bnQgYXRjX2FkZHJfa2V5X2hhc2goZ2NvbnN0cG9pbnRlciB2KQ0KK3sNCisgICAgaHdhZGRyIGFk
ZHIgPSAoaHdhZGRyKXY7DQorICAgIHJldHVybiAoZ3VpbnQpKChhZGRyID4+IDMyKSBeIChhZGRy
ICYgMHhmZmZmZmZmZlUpKTsNCit9DQorDQorLyogRXF1YWxpdHkgdGVzdCBmb3IgSU9UTEIgZW50
cmllcyAqLw0KK3N0YXRpYyBnYm9vbGVhbiBhdGNfYWRkcl9rZXlfZXF1YWwoZ2NvbnN0cG9pbnRl
ciB2MSwgZ2NvbnN0cG9pbnRlciB2MikNCit7DQorICAgIHJldHVybiAoaHdhZGRyKXYxID09ICho
d2FkZHIpdjI7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGF0Y19hZGRyZXNzX3NwYWNlX2ZyZWUodm9p
ZCAqYXMpDQorew0KKyAgICBnX2hhc2hfdGFibGVfdW5yZWYoYXMpOw0KK30NCisNCisvKiByZXR1
cm4gbG9nMih2YWwpLCBvciBVSU5UOF9NQVggaWYgdmFsIGlzIG5vdCBhIHBvd2VyIG9mIDIgKi8N
CitzdGF0aWMgdWludDhfdCBpbG9nMih1aW50NjRfdCB2YWwpDQorew0KKyAgICB1aW50OF90IHJl
c3VsdCA9IDA7DQorICAgIHdoaWxlICh2YWwgIT0gMSkgew0KKyAgICAgICAgaWYgKHZhbCAmIDEp
IHsNCisgICAgICAgICAgICByZXR1cm4gVUlOVDhfTUFYOw0KKyAgICAgICAgfQ0KKw0KKyAgICAg
ICAgdmFsID4+PSAxOw0KKyAgICAgICAgcmVzdWx0ICs9IDE7DQorICAgIH0NCisgICAgcmV0dXJu
IHJlc3VsdDsNCit9DQorDQorQVRDICphdGNfbmV3KHVpbnQ2NF90IHBhZ2Vfc2l6ZSwgdWludDhf
dCBhZGRyZXNzX3dpZHRoKQ0KK3sNCisgICAgQVRDICphdGM7DQorICAgIHVpbnQ4X3QgbG9nX3Bh
Z2Vfc2l6ZSA9IGlsb2cyKHBhZ2Vfc2l6ZSk7DQorICAgIC8qIG51bWJlciBvZiBiaXRzIGVhY2gg
dXNlZCB0byBzdG9yZSBhbGwgdGhlIGludGVybWVkaWF0ZSBpbmRleGVzICovDQorICAgIHVpbnQ2
NF90IGFkZHJfbG9va3VwX2luZGV4ZXNfc2l6ZTsNCisNCisgICAgaWYgKGxvZ19wYWdlX3NpemUg
PT0gVUlOVDhfTUFYKSB7DQorICAgICAgICByZXR1cm4gTlVMTDsNCisgICAgfQ0KKyAgICAvKg0K
KyAgICAgKiBXZSBvbmx5IHN1cHBvcnQgcGFnZSB0YWJsZSBlbnRyaWVzIG9mIDggKFBBR0VfVEFC
TEVfRU5UUllfU0laRSkgYnl0ZXMNCisgICAgICogbG9nMihwYWdlX3NpemUgLyA4KSA9IGxvZzIo
cGFnZV9zaXplKSAtIDMNCisgICAgICogaXMgdGhlIGxldmVsIG9mZnNldA0KKyAgICAgKi8NCisg
ICAgaWYgKGxvZ19wYWdlX3NpemUgPD0gMykgew0KKyAgICAgICByZXR1cm4gTlVMTDsNCisgICAg
fQ0KKw0KKyAgICBhdGMgPSBnX25ldzAoQVRDLCAxKTsNCisgICAgYXRjLT5hZGRyZXNzX3NwYWNl
cyA9IGdfaGFzaF90YWJsZV9uZXdfZnVsbChhdGNfcGFzaWRfa2V5X2hhc2gsDQorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRjX3Bhc2lkX2tleV9lcXVh
bCwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxM
LCBhdGNfYWRkcmVzc19zcGFjZV9mcmVlKTsNCisgICAgYXRjLT5sZXZlbF9vZmZzZXQgPSBsb2df
cGFnZV9zaXplIC0gMzsNCisgICAgLyogYXQgdGhpcyBwb2ludCwgd2Uga25vdyB0aGF0IHBhZ2Vf
c2l6ZSBpcyBhIHBvd2VyIG9mIDIgKi8NCisgICAgYXRjLT5taW5fYWRkcl9tYXNrID0gcGFnZV9z
aXplIC0gMTsNCisgICAgYWRkcl9sb29rdXBfaW5kZXhlc19zaXplID0gYWRkcmVzc193aWR0aCAt
IGxvZ19wYWdlX3NpemU7DQorICAgIGlmICgoYWRkcl9sb29rdXBfaW5kZXhlc19zaXplICUgYXRj
LT5sZXZlbF9vZmZzZXQpICE9IDApIHsNCisgICAgICAgIGdvdG8gZXJyb3I7DQorICAgIH0NCisg
ICAgYXRjLT5sZXZlbHMgPSBhZGRyX2xvb2t1cF9pbmRleGVzX3NpemUgLyBhdGMtPmxldmVsX29m
ZnNldDsNCisgICAgYXRjLT5wYWdlX3NpemUgPSBwYWdlX3NpemU7DQorICAgIHJldHVybiBhdGM7
DQorDQorZXJyb3I6DQorICAgIGdfZnJlZShhdGMpOw0KKyAgICByZXR1cm4gTlVMTDsNCit9DQor
DQorc3RhdGljIGlubGluZSBHSGFzaFRhYmxlICphdGNfZ2V0X2FkZHJlc3Nfc3BhY2VfY2FjaGUo
QVRDICphdGMsIHVpbnQzMl90IHBhc2lkKQ0KK3sNCisgICAgcmV0dXJuIGdfaGFzaF90YWJsZV9s
b29rdXAoYXRjLT5hZGRyZXNzX3NwYWNlcywNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgKGdjb25zdHBvaW50ZXIpKHVpbnRwdHJfdClwYXNpZCk7DQorfQ0KKw0KK3ZvaWQgYXRjX2Ny
ZWF0ZV9hZGRyZXNzX3NwYWNlX2NhY2hlKEFUQyAqYXRjLCB1aW50MzJfdCBwYXNpZCkNCit7DQor
ICAgIEdIYXNoVGFibGUgKmFzX2NhY2hlOw0KKw0KKyAgICBhc19jYWNoZSA9IGF0Y19nZXRfYWRk
cmVzc19zcGFjZV9jYWNoZShhdGMsIHBhc2lkKTsNCisgICAgaWYgKCFhc19jYWNoZSkgew0KKyAg
ICAgICAgYXNfY2FjaGUgPSBnX2hhc2hfdGFibGVfbmV3X2Z1bGwoYXRjX2FkZHJfa2V5X2hhc2gs
DQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdGNfYWRkcl9rZXlf
ZXF1YWwsDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMLCBn
X2ZyZWUpOw0KKyAgICAgICAgZ19oYXNoX3RhYmxlX3JlcGxhY2UoYXRjLT5hZGRyZXNzX3NwYWNl
cywNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChncG9pbnRlcikodWludHB0cl90KXBh
c2lkLCBhc19jYWNoZSk7DQorICAgIH0NCit9DQorDQordm9pZCBhdGNfZGVsZXRlX2FkZHJlc3Nf
c3BhY2VfY2FjaGUoQVRDICphdGMsIHVpbnQzMl90IHBhc2lkKQ0KK3sNCisgICAgZ19oYXNoX3Rh
YmxlX3JlbW92ZShhdGMtPmFkZHJlc3Nfc3BhY2VzLCAoZ3BvaW50ZXIpKHVpbnRwdHJfdClwYXNp
ZCk7DQorfQ0KKw0KK2ludCBhdGNfdXBkYXRlKEFUQyAqYXRjLCBJT01NVVRMQkVudHJ5ICplbnRy
eSkNCit7DQorICAgIElPTU1VVExCRW50cnkgKnZhbHVlOw0KKyAgICBHSGFzaFRhYmxlICphc19j
YWNoZSA9IGF0Y19nZXRfYWRkcmVzc19zcGFjZV9jYWNoZShhdGMsIGVudHJ5LT5wYXNpZCk7DQor
ICAgIGlmICghYXNfY2FjaGUpIHsNCisgICAgICAgIHJldHVybiAtRU5PREVWOw0KKyAgICB9DQor
ICAgIHZhbHVlID0gZ19tZW1kdXAyKGVudHJ5LCBzaXplb2YoKnZhbHVlKSk7DQorICAgIGdfaGFz
aF90YWJsZV9yZXBsYWNlKGFzX2NhY2hlLCAoZ3BvaW50ZXIpKGVudHJ5LT5pb3ZhKSwgdmFsdWUp
Ow0KKyAgICByZXR1cm4gMDsNCit9DQorDQorSU9NTVVUTEJFbnRyeSAqYXRjX2xvb2t1cChBVEMg
KmF0YywgdWludDMyX3QgcGFzaWQsIGh3YWRkciBhZGRyKQ0KK3sNCisgICAgSU9NTVVUTEJFbnRy
eSAqZW50cnk7DQorICAgIGh3YWRkciBtYXNrID0gYXRjLT5taW5fYWRkcl9tYXNrOw0KKyAgICBo
d2FkZHIga2V5ID0gYWRkciAmICh+bWFzayk7DQorICAgIEdIYXNoVGFibGUgKmFzX2NhY2hlID0g
YXRjX2dldF9hZGRyZXNzX3NwYWNlX2NhY2hlKGF0YywgcGFzaWQpOw0KKw0KKyAgICBpZiAoIWFz
X2NhY2hlKSB7DQorICAgICAgICByZXR1cm4gTlVMTDsNCisgICAgfQ0KKw0KKyAgICAvKg0KKyAg
ICAgKiBJdGVyYXRlIG92ZXIgdGhlIHBvc3NpYmxlIHBhZ2Ugc2l6ZXMgYW5kIHRyeSB0byBmaW5k
IGEgaGl0DQorICAgICovDQorICAgIGZvciAodWludDhfdCBsZXZlbCA9IDA7IGxldmVsIDwgYXRj
LT5sZXZlbHM7ICsrbGV2ZWwpIHsNCisgICAgICAgIGVudHJ5ID0gZ19oYXNoX3RhYmxlX2xvb2t1
cChhc19jYWNoZSwgKGdjb25zdHBvaW50ZXIpa2V5KTsNCisgICAgICAgIGlmIChlbnRyeSkgew0K
KyAgICAgICAgICAgIHJldHVybiBlbnRyeTsNCisgICAgICAgIH0NCisgICAgICAgIG1hc2sgPSAo
bWFzayA8PCBhdGMtPmxldmVsX29mZnNldCkgfCAoKDEgPDwgYXRjLT5sZXZlbF9vZmZzZXQpIC0g
MSk7DQorICAgICAgICBrZXkgPSBhZGRyICYgKH5tYXNrKTsNCisgICAgfQ0KKw0KKyAgICByZXR1
cm4gTlVMTDsNCit9DQorDQorc3RhdGljIGdib29sZWFuIGF0Y19pbnZhbGlkYXRlX2VudHJ5X3By
ZWRpY2F0ZShncG9pbnRlciBrZXksIGdwb2ludGVyIHZhbHVlLA0KKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3BvaW50ZXIgdXNlcl9kYXRhKQ0KK3sNCisg
ICAgSU9NTVVUTEJFbnRyeSAqZW50cnkgPSAoSU9NTVVUTEJFbnRyeSAqKXZhbHVlOw0KKyAgICBJ
T01NVVRMQkVudHJ5ICp0YXJnZXQgPSAoSU9NTVVUTEJFbnRyeSAqKXVzZXJfZGF0YTsNCisgICAg
aHdhZGRyIHRhcmdldF9tYXNrID0gfnRhcmdldC0+YWRkcl9tYXNrOw0KKyAgICBod2FkZHIgZW50
cnlfbWFzayA9IH5lbnRyeS0+YWRkcl9tYXNrOw0KKyAgICByZXR1cm4gKCh0YXJnZXQtPmlvdmEg
JiB0YXJnZXRfbWFzaykgPT0gKGVudHJ5LT5pb3ZhICYgdGFyZ2V0X21hc2spKSB8fA0KKyAgICAg
ICAgICAgKCh0YXJnZXQtPmlvdmEgJiBlbnRyeV9tYXNrKSA9PSAoZW50cnktPmlvdmEgJiBlbnRy
eV9tYXNrKSk7DQorfQ0KKw0KK3ZvaWQgYXRjX2ludmFsaWRhdGUoQVRDICphdGMsIElPTU1VVExC
RW50cnkgKmVudHJ5KQ0KK3sNCisgICAgR0hhc2hUYWJsZSAqYXNfY2FjaGUgPSBhdGNfZ2V0X2Fk
ZHJlc3Nfc3BhY2VfY2FjaGUoYXRjLCBlbnRyeS0+cGFzaWQpOw0KKyAgICBpZiAoIWFzX2NhY2hl
KSB7DQorICAgICAgICByZXR1cm47DQorICAgIH0NCisgICAgZ19oYXNoX3RhYmxlX2ZvcmVhY2hf
cmVtb3ZlKGFzX2NhY2hlLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRjX2lu
dmFsaWRhdGVfZW50cnlfcHJlZGljYXRlLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZW50cnkpOw0KK30NCisNCit2b2lkIGF0Y19kZXN0cm95KEFUQyAqYXRjKQ0KK3sNCisgICAg
Z19oYXNoX3RhYmxlX3VucmVmKGF0Yy0+YWRkcmVzc19zcGFjZXMpOw0KK30NCisNCitzaXplX3Qg
YXRjX2dldF9tYXhfbnVtYmVyX29mX3BhZ2VzKEFUQyAqYXRjLCBod2FkZHIgYWRkciwgc2l6ZV90
IGxlbmd0aCkNCit7DQorICAgIGh3YWRkciBwYWdlX21hc2sgPSB+KGF0Yy0+bWluX2FkZHJfbWFz
ayk7DQorICAgIHNpemVfdCByZXN1bHQgPSAobGVuZ3RoIC8gYXRjLT5wYWdlX3NpemUpOw0KKyAg
ICBpZiAoKCgoYWRkciAmIHBhZ2VfbWFzaykgKyBsZW5ndGggLSAxKSAmIHBhZ2VfbWFzaykgIT0N
CisgICAgICAgICgoYWRkciArIGxlbmd0aCAtIDEpICYgcGFnZV9tYXNrKSkgew0KKyAgICAgICAg
cmVzdWx0ICs9IDE7DQorICAgIH0NCisgICAgcmV0dXJuIHJlc3VsdCArIChsZW5ndGggJSBhdGMt
PnBhZ2Vfc2l6ZSAhPSAwID8gMSA6IDApOw0KK30NCisNCit2b2lkIGF0Y19yZXNldChBVEMgKmF0
YykNCit7DQorICAgIGdfaGFzaF90YWJsZV9yZW1vdmVfYWxsKGF0Yy0+YWRkcmVzc19zcGFjZXMp
Ow0KK30NCmRpZmYgLS1naXQgYS91dGlsL2F0Yy5oIGIvdXRpbC9hdGMuaA0KbmV3IGZpbGUgbW9k
ZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAuLjhiZTk1ZjVjY2ENCi0tLSAvZGV2L251bGwNCisr
KyBiL3V0aWwvYXRjLmgNCkBAIC0wLDAgKzEsMTE3IEBADQorLyoNCisgKiBRRU1VIGVtdWxhdGlv
biBvZiBhbiBBVEMNCisgKg0KKyAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3Ug
Y2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5DQorICogaXQgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkNCisgKiB0
aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNl
bnNlLCBvcg0KKyAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uDQorDQorICog
VGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1
c2VmdWwsDQorICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGlt
cGxpZWQgd2FycmFudHkgb2YNCisgKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQ
QVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlDQorICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vu
c2UgZm9yIG1vcmUgZGV0YWlscy4NCisNCisgKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBj
b3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhbG9uZw0KKyAqIHdpdGggdGhp
cyBwcm9ncmFtOyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uDQor
ICovDQorDQorI2lmbmRlZiBVVElMX0FUQ19IDQorI2RlZmluZSBVVElMX0FUQ19IDQorDQorI2lu
Y2x1ZGUgInFlbXUvb3NkZXAuaCINCisjaW5jbHVkZSAiZXhlYy9tZW1vcnkuaCINCisNCit0eXBl
ZGVmIHN0cnVjdCBBVEMgew0KKyAgICBHSGFzaFRhYmxlICphZGRyZXNzX3NwYWNlczsgLyogS2V5
IDogcGFzaWQsIHZhbHVlIDogR0hhc2hUYWJsZSAqLw0KKyAgICBod2FkZHIgbWluX2FkZHJfbWFz
azsNCisgICAgdWludDY0X3QgcGFnZV9zaXplOw0KKyAgICB1aW50OF90IGxldmVsczsNCisgICAg
dWludDhfdCBsZXZlbF9vZmZzZXQ7DQorfSBBVEM7DQorDQorLyoNCisgKiBhdGNfbmV3OiBDcmVh
dGUgYW4gQVRDLg0KKyAqDQorICogUmV0dXJuIGFuIEFUQyBvciBOVUxMIGlmIHRoZSBjcmVhdGlv
biBmYWlsZWQNCisgKg0KKyAqIEBwYWdlX3NpemU6ICNQQ0lEZXZpY2UgZG9pbmcgdGhlIG1lbW9y
eSBhY2Nlc3MNCisgKiBAYWRkcmVzc193aWR0aDogd2lkdGggb2YgdGhlIHZpcnR1YWwgYWRkcmVz
c2VzIHVzZWQgYnkgdGhlIElPTU1VIChpbiBiaXRzKQ0KKyAqLw0KK0FUQyAqYXRjX25ldyh1aW50
NjRfdCBwYWdlX3NpemUsIHVpbnQ4X3QgYWRkcmVzc193aWR0aCk7DQorDQorLyoNCisgKiBhdGNf
dXBkYXRlOiBJbnNlcnQgb3IgdXBkYXRlIGFuIGVudHJ5IGluIHRoZSBjYWNoZQ0KKyAqDQorICog
UmV0dXJuIDAgaWYgdGhlIG9wZXJhdGlvbiBzdWNjZWVkcywgYSBuZWdhdGl2ZSBlcnJvciBjb2Rl
IG90aGVyd2lzZQ0KKyAqDQorICogVGhlIGluc2VydGlvbiB3aWxsIGZhaWwgaWYgdGhlIGFkZHJl
c3Mgc3BhY2UgYXNzb2NpYXRlZCB3aXRoIHRoaXMgcGFzaWQNCisgKiBoYXMgbm90IGJlZW4gY3Jl
YXRlZCB3aXRoIGF0Y19jcmVhdGVfYWRkcmVzc19zcGFjZV9jYWNoZQ0KKyAqDQorICogQGF0Yzog
dGhlIEFUQyB0byB1cGRhdGUNCisgKiBAZW50cnk6IHRoZSB0bGIgZW50cnkgdG8gaW5zZXJ0IGlu
dG8gdGhlIGNhY2hlDQorICovDQoraW50IGF0Y191cGRhdGUoQVRDICphdGMsIElPTU1VVExCRW50
cnkgKmVudHJ5KTsNCisNCisvKg0KKyAqIGF0Y19jcmVhdGVfYWRkcmVzc19zcGFjZV9jYWNoZTog
ZGVsYXJlIGEgbmV3IGFkZHJlc3Mgc3BhY2UNCisgKiBpZGVudGlmaWVkIGJ5IGEgUEFTSUQNCisg
Kg0KKyAqIEBhdGM6IHRoZSBBVEMgdG8gdXBkYXRlDQorICogQHBhc2lkOiB0aGUgcGFzaWQgb2Yg
dGhlIGFkZHJlc3Mgc3BhY2UgdG8gYmUgY3JlYXRlZA0KKyAqLw0KK3ZvaWQgYXRjX2NyZWF0ZV9h
ZGRyZXNzX3NwYWNlX2NhY2hlKEFUQyAqYXRjLCB1aW50MzJfdCBwYXNpZCk7DQorDQorLyoNCisg
KiBhdGNfZGVsZXRlX2FkZHJlc3Nfc3BhY2VfY2FjaGU6IGRlbGV0ZSBhbiBhZGRyZXNzIHNwYWNl
DQorICogaWRlbnRpZmllZCBieSBhIFBBU0lEDQorICoNCisgKiBAYXRjOiB0aGUgQVRDIHRvIHVw
ZGF0ZQ0KKyAqIEBwYXNpZDogdGhlIHBhc2lkIG9mIHRoZSBhZGRyZXNzIHNwYWNlIHRvIGJlIGRl
bGV0ZWQNCisgKi8NCit2b2lkIGF0Y19kZWxldGVfYWRkcmVzc19zcGFjZV9jYWNoZShBVEMgKmF0
YywgdWludDMyX3QgcGFzaWQpOw0KKw0KKy8qDQorICogYXRjX2xvb2t1cDogcXVlcnkgdGhlIGNh
Y2hlIGluIGEgZ2l2ZW4gYWRkcmVzcyBzcGFjZQ0KKyAqDQorICogQGF0YzogdGhlIEFUQyB0byBx
dWVyeQ0KKyAqIEBwYXNpZDogdGhlIHBhc2lkIG9mIHRoZSBhZGRyZXNzIHNwYWNlIHRvIHF1ZXJ5
DQorICogQGFkZHI6IHRoZSB2aXJ0dWFsIGFkZHJlc3MgdG8gdHJhbnNsYXRlDQorICovDQorSU9N
TVVUTEJFbnRyeSAqYXRjX2xvb2t1cChBVEMgKmF0YywgdWludDMyX3QgcGFzaWQsIGh3YWRkciBh
ZGRyKTsNCisNCisvKg0KKyAqIGF0Y19pbnZhbGlkYXRlOiBpbnZhbGlkYXRlIGFuIGVudHJ5IGlu
IHRoZSBjYWNoZQ0KKyAqDQorICogQGF0YzogdGhlIEFUQyB0byB1cGRhdGUNCisgKiBAZW50cnk6
IHRoZSBlbnRyeSB0byBpbnZhbGlkYXRlDQorICovDQordm9pZCBhdGNfaW52YWxpZGF0ZShBVEMg
KmF0YywgSU9NTVVUTEJFbnRyeSAqZW50cnkpOw0KKw0KKy8qDQorICogYXRjX2Rlc3Ryb3k6IGRl
bGV0ZSBhbiBBVEMNCisgKg0KKyAqIEBhdGM6IHRoZSBjYWNoZSB0byBiZSBkZWxldGVkDQorICov
DQordm9pZCBhdGNfZGVzdHJveShBVEMgKmF0Yyk7DQorDQorLyoNCisgKiBhdGNfZ2V0X21heF9u
dW1iZXJfb2ZfcGFnZXM6IGdldCB0aGUgbnVtYmVyIG9mIHBhZ2VzIGEgbWVtb3J5IG9wZXJhdGlv
bg0KKyAqIHdpbGwgYWNjZXNzIGlmIGFsbCB0aGUgcGFnZXMgY29uY2VybmVkIGhhdmUgdGhlIG1p
bmltdW0gc2l6ZS4NCisgKg0KKyAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIHVzZWQgdG8gZGV0ZXJt
aW5lIHRoZSBzaXplIG9mIHRoZSByZXN1bHQgYXJyYXkgdG8gYmUNCisgKiBhbGxvY2F0ZWQgd2hl
biBpc3N1aW5nIGFuIEFUUyByZXF1ZXN0Lg0KKyAqDQorICogQGF0YzogdGhlIGNhY2hlDQorICog
QGFkZHI6IHN0YXJ0IGFkZHJlc3MNCisgKiBAbGVuZ3RoOiBudW1iZXIgb2YgYnl0ZXMgYWNjZXNz
ZWQgZnJvbSBhZGRyDQorICovDQorc2l6ZV90IGF0Y19nZXRfbWF4X251bWJlcl9vZl9wYWdlcyhB
VEMgKmF0YywgaHdhZGRyIGFkZHIsIHNpemVfdCBsZW5ndGgpOw0KKw0KKy8qDQorICogYXRjX3Jl
c2V0OiBpbnZhbGlkYXRlcyBhbGwgdGhlIGVudHJpZXMgc3RvcmVkIGluIHRoZSBBVEMNCisgKg0K
KyAqIEBhdGM6IHRoZSBjYWNoZQ0KKyAqLw0KK3ZvaWQgYXRjX3Jlc2V0KEFUQyAqYXRjKTsNCisN
CisjZW5kaWYNCmRpZmYgLS1naXQgYS91dGlsL21lc29uLmJ1aWxkIGIvdXRpbC9tZXNvbi5idWls
ZA0KaW5kZXggMGVmOTg4NmJlMC4uYTJlMGU5ZTVkNyAxMDA2NDQNCi0tLSBhL3V0aWwvbWVzb24u
YnVpbGQNCisrKyBiL3V0aWwvbWVzb24uYnVpbGQNCkBAIC05NCw2ICs5NCw3IEBAIGlmIGhhdmVf
YmxvY2sNCiAgIHV0aWxfc3MuYWRkKGZpbGVzKCdoYml0bWFwLmMnKSkNCiAgIHV0aWxfc3MuYWRk
KGZpbGVzKCdoZXhkdW1wLmMnKSkNCiAgIHV0aWxfc3MuYWRkKGZpbGVzKCdpb3ZhLXRyZWUuYycp
KQ0KKyAgdXRpbF9zcy5hZGQoZmlsZXMoJ2F0Yy5jJykpDQogICB1dGlsX3NzLmFkZChmaWxlcygn
aW92LmMnLCAndXJpLmMnKSkNCiAgIHV0aWxfc3MuYWRkKGZpbGVzKCdudmRpbW0tdXRpbHMuYycp
KQ0KICAgdXRpbF9zcy5hZGQoZmlsZXMoJ2Jsb2NrLWhlbHBlcnMuYycpKQ0KLS0gDQoyLjQ0LjAN
Cg==

